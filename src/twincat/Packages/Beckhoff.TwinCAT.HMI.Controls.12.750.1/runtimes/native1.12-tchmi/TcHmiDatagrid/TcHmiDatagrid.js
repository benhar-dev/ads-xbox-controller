var TcHmi;!function(TcHmi){let Controls;!function(Controls){let Beckhoff;!function(Beckhoff){class TcHmiDatagrid extends TcHmi.Controls.System.TcHmiControl{constructor(element,pcElement,attrs){super(element,pcElement,attrs),this.__destroyDataSymbolWatch=null,this.__pagingInfo={usePaging:!1,subscriptionId:null,buffer:30,theoraticalOffset:0,actualOffset:0,filterMap:[],timing:{isScrolling:!1,timeoutID:null,lastRequestTime:0,lastUpdateTime:0,minTimeout:100,responseLatencies:[],updateTimings:[],firstResponsePending:!1}},this.__dataSymbolTransform=null,this.__internalSorting=[],this.__filterInstance=null,this.__internalSrcColumn=[],this.__timePickerConfirmedEventDestroyer=null,this.__timePickerCanceledEventDestroyer=null,this.__REGEX_ISO_8601_DATETIME=/^\d{4}-(?:0\d|1[0-2])-(?:[0-2]\d|3[01])[Tt\s](?:[01]\d|2[0-3]):[0-5]\d:(?:[0-5]\d|60)(?:.\d+)?(?:[Zz]|[+-](?:[01]\d|2[0-3]):[0-5]\d)$/,this.__REGEX_ISO_8601_TIMESPAN=/^P(?=.{2,})(?:\d+Y|\d+[.,]\d+Y$)?(?:\d+M|\d+[.,]\d+M$)?(?:\d+W|\d+[.,]\d+W$)?(?:\d+D|\d+[.,]\d+D$)?(?:T(?:\d+H|\d+[.,]\d+H$)?(?:\d+M|\d+[.,]\d+M$)?(?:\d+S|\d+[.,]\d+S$)?)?$/,this.__lockState=null,this.__columnWidths=[{width:0,widthUnit:"px",pixelWidth:0,minWidth:6,minWidthUnit:"px",resizable:!0}],this.__draggingInfo={isDragging:!1,columnIndex:null,startingPoint:null,offset:null},this.__lastRemovedSorting=null,this.__filterSortMap=null,this.__dataLength=0,this.__sortTouches=[],this.__srcDataHasChanged=!1,this.__selectedCell=null,this.__scrollInfo={scrollTop:0,scrollLeft:0,firstIndex:0,oldFirstIndex:0,rowCount:0,oldRowCount:0,buffer:10},this.__resizedEventDestroyEvent=null,this.__movedEventDestroyEvent=null,this.__comboboxDropdowns={},this.__selectedCombobox=null,this.__resizeElementMinWidth=8,this.__contentWidth=null,this.__contentHeight=null,this.__storageValidation={sorting:{function:"getSorting",expectedResult:void 0},columnWidths:{function:"getSrcColumn",expectedResult:void 0}},this.__buttonLeaveDestroyer=null,this.__buttonEnterDestroyer=null,this.__onMousedown=event=>{if(!0!==TcHmi.Access.checkAccess(this,"operate"))return;if(!this.getIsEnabled())return;if(0!==event.button)return;let combobox=event.target;for(;combobox&&combobox instanceof Element&&!combobox.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template")&&!combobox.classList.contains("tchmi-datagrid-combobox-template");)combobox=combobox.parentElement;if(!(combobox instanceof HTMLDivElement))return;let cell=combobox.parentElement;cell instanceof HTMLTableCellElement&&this.__openCombobox(cell)},this.__onItemClick=event=>{if(!this.__selectedCombobox)return;if(!(event.target instanceof HTMLElement)||!event.target.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-dropdown-element")&&!event.target.classList.contains("tchmi-datagrid-combobox-template-dropdown-element"))return;if(!0!==TcHmi.Access.checkAccess(this,"operate"))return;if(!this.getIsEnabled())return;let rowElement=this.__selectedCombobox.cell.parentElement;if(!(rowElement instanceof HTMLTableRowElement))return;let index=parseInt(event.target.dataset.index||"",10),column=this.__selectedCombobox.column;if(!isNaN(index)&&column){let dataDef=column.dataDefinitions?column.dataDefinitions[index]:void 0,comboboxContent=this.__selectedCombobox.cell.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-select")[0];if(dataDef&&comboboxContent){comboboxContent.textContent=dataDef.text||"";let result=this.__modifySrcData(dataDef.value,this.__selectedCombobox.row,this.__internalSrcColumn.indexOf(column),rowElement);if(result)if(result.needSorting)this.__filterAndSort(),this.__updateTable(0);else for(let i=0,ii=this.__internalSrcColumn.length;i<ii;i++){let internalColumn=this.__internalSrcColumn[i];if(internalColumn!==column&&internalColumn.name===column.name){let cell=rowElement.children[i+1];cell instanceof HTMLTableCellElement&&this.__fillCell(cell,internalColumn,result.convertedValue)}}}}this.__closeCombobox()},this.__resizeDropdownBoxCb=()=>{if(!this.__selectedCombobox)return;const documentBCR=document.documentElement.getBoundingClientRect(),comboboxBCR=this.__selectedCombobox.combobox.getBoundingClientRect(),dropdownBCR=this.__selectedCombobox.dropdown.getBoundingClientRect();let style={top:comboboxBCR.top+comboboxBCR.height+"px",left:comboboxBCR.left+"px",right:null,"min-width":comboboxBCR.width+"px","max-height":documentBCR.height-comboboxBCR.bottom+"px"};documentBCR.height-comboboxBCR.bottom<dropdownBCR.height&&comboboxBCR.top>=dropdownBCR.height?(style.top=comboboxBCR.top-dropdownBCR.height+"px",style["max-height"]=comboboxBCR.top+"px",this.__selectedCombobox.dropdown.classList.add("above-control")):this.__selectedCombobox.dropdown.classList.remove("above-control"),documentBCR.width-comboboxBCR.left<dropdownBCR.width&&comboboxBCR.right>=dropdownBCR.width&&(style.left=null,style.right=documentBCR.width-comboboxBCR.right+"px"),TcHmi.StyleProvider.setSimpleElementStyle(this.__selectedCombobox.dropdown,style)},this.__onColumnMouseDown=event=>{if(0!==event.button)return;if(!this.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this,"operate"))return;if(!(event.target instanceof HTMLElement)||!event.target.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-resize-element")&&!event.target.classList.contains("tchmi-datagrid-template-resize-element"))return;let targetCell=event.target;for(;targetCell&&!(targetCell instanceof HTMLTableCellElement);)targetCell=targetCell.parentElement;if(!targetCell)return;let boundingRect=targetCell.getBoundingClientRect();this.__draggingInfo.isDragging=!0,this.__draggingInfo.columnIndex=targetCell.cellIndex,this.__draggingInfo.startingPoint=boundingRect.left,this.__draggingInfo.offset=boundingRect.width-(event.clientX-boundingRect.left)},this.__onColumnMouseMove=event=>{if(!this.__draggingInfo.isDragging||null===this.__draggingInfo.startingPoint||null===this.__draggingInfo.offset||null===this.__draggingInfo.columnIndex)return;if(!this.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this,"operate"))return;let newWidth=event.clientX-this.__draggingInfo.startingPoint+this.__draggingInfo.offset;if("%"===this.__columnWidths[this.__draggingInfo.columnIndex].widthUnit){let elementWidth=this.__element[0].clientWidth;0!==this.__draggingInfo.columnIndex&&this.__showRowNumbers&&(elementWidth-=this.__columnWidths[0].pixelWidth),newWidth=newWidth/elementWidth*100}this.__resizeColumn(this.__draggingInfo.columnIndex,newWidth),this.__setStoredValue("columnWidths",this.__columnWidths.map(w=>w.width))},this.__onColumnMouseUp=()=>{this.__draggingInfo.isDragging=!1,this.__draggingInfo.columnIndex=null,this.__draggingInfo.startingPoint=null,this.__draggingInfo.offset=null,this.__lockState&&this.__internalSrcColumn[this.__lockState.column]&&("CheckBox"===this.__internalSrcColumn[this.__lockState.column].control||"ToggleSwitch"===this.__internalSrcColumn[this.__lockState.column].control||"RadioButton"===this.__internalSrcColumn[this.__lockState.column].control)&&this.__unlock()},this.__onColumnMouseDblClick=event=>{if(!this.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this,"operate"))return;if(!(event.target instanceof HTMLElement)||!event.target.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-resize-element")&&!event.target.classList.contains("tchmi-datagrid-template-resize-element"))return;let headerCell=$(event.target).closest("th"),index=headerCell[0].cellIndex;if(!this.__columnWidths[index].resizable)return;let dataCells=this.__elementDataTableBody.find(`td:nth-child(${index+1})`);headerCell.css({"min-width":"0","max-width":"none"}),dataCells.css({"min-width":"0","max-width":"none",display:"table-cell"});let cellPaddingLeft="",cellPaddingRight="",isCombobox=index>0&&"ComboBox"===this.__internalSrcColumn[index-1].control;isCombobox&&(dataCells.find(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-select").css({position:"static"}),cellPaddingLeft=dataCells.css("padding-left"),cellPaddingRight=dataCells.css("padding-right"),dataCells.css({"padding-left":"0","padding-right":"0"}));let isTextbox=index>0&&"TextBox"===this.__internalSrcColumn[index-1].control;if(isTextbox){let inputs=dataCells.find("input");inputs.css({width:"0",position:"static"}),inputs.each((index,element)=>{element.style.width=element.scrollWidth+"px"}),cellPaddingLeft=dataCells.css("padding-left"),cellPaddingRight=dataCells.css("padding-right"),dataCells.css({"padding-left":"0","padding-right":"0"})}let headerCellWidth=headerCell[0].offsetWidth,dataCellWidth=dataCells[0].offsetWidth;isCombobox&&(dataCellWidth+=dataCells[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-button")[0].clientWidth,dataCells.find(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-select").css({position:""}),dataCells.css({"padding-left":cellPaddingLeft,"padding-right":cellPaddingRight})),isTextbox&&(dataCells.find("input").css({width:"",position:""}),dataCells.css({"padding-left":cellPaddingLeft,"padding-right":cellPaddingRight})),headerCell.css({"min-width":"","max-width":""}),dataCells.css({"min-width":"","max-width":"",display:""});let newWidth=headerCellWidth>dataCellWidth?headerCellWidth:dataCellWidth;if("%"===this.__columnWidths[index].widthUnit){let elementWidth=this.__element[0].clientWidth;0!==this.__draggingInfo.columnIndex&&this.__showRowNumbers&&(elementWidth-=this.__columnWidths[0].pixelWidth),newWidth=newWidth/elementWidth*100}this.__resizeColumn(index,newWidth,!0),this.__setStoredValue("columnWidths",this.__columnWidths.map(w=>w.width))},this.__onSortClick=event=>{if(!this.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this,"operate"))return;let sortElement=event.target;for(;sortElement instanceof HTMLElement&&!sortElement.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-sort-element")&&!sortElement.classList.contains("tchmi-datagrid-template-sort-element")&&!sortElement.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers")&&!sortElement.classList.contains("tchmi-datagrid-template-row-numbers");){if(sortElement.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-resize-element"))return;sortElement=sortElement.parentElement}sortElement instanceof HTMLElement&&this.__modifySorting(sortElement,event.shiftKey)},this.__onSortTouchStart=event=>{if(this.getIsEnabled()&&TcHmi.Access.checkAccess(this,"operate"))for(let i=0,ii=event.changedTouches.length;i<ii;i++){let touch=event.changedTouches[i],sortElement=touch.target;for(;sortElement instanceof HTMLElement&&!sortElement.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-sort-element")&&!sortElement.classList.contains("tchmi-datagrid-template-sort-element")&&!sortElement.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers")&&!sortElement.classList.contains("tchmi-datagrid-template-row-numbers");)sortElement=sortElement.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-resize-element")?null:sortElement.parentElement;if(!(sortElement instanceof HTMLElement))continue;let touchInfo={touchId:touch.identifier,timeoutId:null,sortElement:sortElement,clientX:touch.clientX,clientY:touch.clientY};this.__sortTouches.push(touchInfo),touchInfo.timeoutId=window.setTimeout(()=>{touchInfo.timeoutId=null,this.__modifySorting(touchInfo.sortElement,!0)},300)}},this.__onSortTouchMove=event=>{for(let i=0,ii=event.changedTouches.length;i<ii;i++){let touch=event.changedTouches[i],touchIndex=-1;for(let j=0,jj=this.__sortTouches.length;j<jj;j++)if(this.__sortTouches[j].touchId===touch.identifier){touchIndex=j;break}if(-1===touchIndex)continue;let touchInfo=this.__sortTouches[touchIndex];Math.pow(touch.clientX-touchInfo.clientX,2)+Math.pow(touch.clientY-touchInfo.clientY,2)>100&&(null!==touchInfo.timeoutId&&window.clearTimeout(touchInfo.timeoutId),this.__sortTouches.splice(touchIndex,1))}},this.__onSortTouchEnd=event=>{event.cancelable&&event.preventDefault();for(let i=0,ii=event.changedTouches.length;i<ii;i++){let touch=event.changedTouches[i],touchIndex=-1;for(let j=0,jj=this.__sortTouches.length;j<jj;j++)if(this.__sortTouches[j].touchId===touch.identifier){touchIndex=j;break}if(-1===touchIndex)continue;let touchInfo=this.__sortTouches[touchIndex];if(null!==touchInfo.timeoutId)if(window.clearTimeout(touchInfo.timeoutId),0===this.__internalSorting.length)this.__modifySorting(touchInfo.sortElement,!1);else{let headerCell=touchInfo.sortElement;for(;headerCell&&!(headerCell instanceof HTMLTableCellElement);)headerCell=headerCell.parentElement;if(headerCell)if(headerCell.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers")||headerCell.classList.contains("tchmi-datagrid-template-row-numbers"))this.__modifySorting(touchInfo.sortElement,!1);else{let sortName=void 0;if(TcHmiDatagrid.isSimpleColumn(this.__internalSrcColumn[0])||(sortName=headerCell.dataset.name),this.__lastRemovedSorting&&this.__lastRemovedSorting.name===sortName)this.__modifySorting(touchInfo.sortElement,!0);else{let composing=!1;for(let i=0,ii=this.__internalSorting.length;i<ii;i++)if(this.__internalSorting[i].name===sortName){composing=!0;break}this.__modifySorting(touchInfo.sortElement,composing)}}}this.__sortTouches.splice(touchIndex,1)}},this.__onSortTouchCancel=event=>{event.cancelable&&event.preventDefault();for(let i=0,ii=event.changedTouches.length;i<ii;i++){let touch=event.changedTouches[i],touchIndex=-1;for(let j=0,jj=this.__sortTouches.length;j<jj;j++)if(this.__sortTouches[j].touchId===touch.identifier){touchIndex=j;break}if(-1===touchIndex)continue;let touchInfo=this.__sortTouches[touchIndex];null!==touchInfo.timeoutId&&window.clearTimeout(touchInfo.timeoutId),this.__sortTouches.splice(touchIndex,1)}},this.__onScroll=event=>{let left=event.currentTarget.scrollLeft,top=event.currentTarget.scrollTop;if(this.__scrollInfo.scrollLeft!==left&&(this.__scrollInfo.scrollLeft=left,this.__elementHeaderScroll.scrollLeft(left)),this.__scrollInfo.scrollTop!==top){this.__scrollInfo.scrollTop=top;let firstIndex=this.__rowHeight?Math.floor(top/this.__rowHeight):0;Math.abs(this.__scrollInfo.firstIndex-firstIndex)>this.__scrollInfo.buffer/2&&(this.__scrollInfo.firstIndex=firstIndex,this.__pagingInfo.usePaging&&this.__updatePaging(),this.__updateTable(2),this.__updateSentinels())}this.__pagingInfo.usePaging&&(this.__pagingInfo.timing.isScrolling=!0,null!==this.__pagingInfo.timing.timeoutID&&window.clearTimeout(this.__pagingInfo.timing.timeoutID),this.__pagingInfo.timing.timeoutID=window.setTimeout(()=>{this.__pagingInfo.timing.isScrolling=!1,this.__pagingInfo.timing.timeoutID=null,this.__updatePaging()},200))},this.__onFocusElement=event=>{if(!this.__srcData)return;if(!this.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this,"operate"))return;let targetCell=event.target;for(;targetCell instanceof Node&&!(targetCell instanceof HTMLTableCellElement);)targetCell=targetCell.parentElement;if(!(targetCell instanceof HTMLTableCellElement))return;let rowElement=targetCell.parentElement;if(!(rowElement instanceof HTMLTableRowElement))return;let row=parseInt(targetCell.dataset.row||"",10),column=parseInt(targetCell.dataset.column||"-1",10);if(isNaN(row))return;let unpagedRow=row;if(row=this.__srcDataIndexToOriginalIndex(row),-1!==row){if(this.__elementDataTableBody.find("tr.focused, td.focused").removeClass("focused"),targetCell.classList.add("focused"),rowElement.classList.add("focused"),null===this.__selectedCell||this.__selectedCell.rowIndex!==row||this.__selectedCell.columnIndex!==column){let changedProperties=[];if(this.__selectedCell&&this.__selectedCell.rowIndex===row||changedProperties.push("SelectedRowIndex"),this.__selectedCell&&this.__selectedCell.columnIndex===column||changedProperties.push("SelectedColumnIndex"),this.__selectedCell&&null!==this.__selectedCell.rowIndex){let oldIndex=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);-1!==oldIndex&&tchmi_equal(this.__srcData[oldIndex],this.__srcData[unpagedRow])||changedProperties.push("selectedRowValue")}else changedProperties.push("selectedRowValue");if(column>=0){let columnDefinitionNow=this.__internalSrcColumn[column];if(!TcHmiDatagrid.isSimpleColumn(columnDefinitionNow)&&this.__selectedCell&&this.__selectedCell.rowIndex&&this.__selectedCell.columnIndex>=0){let columnDefinitionOld=this.__internalSrcColumn[this.__selectedCell.columnIndex],oldIndex=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);if(-1===oldIndex)changedProperties.push("selectedCellValue");else{let left=this.__readObjectProperty(this.__srcData[oldIndex],columnDefinitionOld.name),right=this.__readObjectProperty(this.__srcData[unpagedRow],columnDefinitionNow.name);tchmi_equal(left,right)||changedProperties.push("selectedCellValue")}}else changedProperties.push("selectedCellValue")}else changedProperties.push("selectedCellValue");this.__selectedCell={rowIndex:row,columnIndex:column},changedProperties.length>0&&(TcHmi.EventProvider.raise(this.__id+".onSelectedItemChanged"),changedProperties.forEach(changedProperty=>TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:changedProperty})))}event.target instanceof HTMLInputElement&&("text"===event.target.type||"password"===event.target.type||"decimal"===event.target.inputMode)&&!event.target.disabled&&this.__lock(row,column,rowElement)}},this.__onFocusElementOut=event=>{if(!this.__srcData)return;if(!this.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this,"operate"))return;if(!(event.target instanceof HTMLInputElement)||"text"!==event.target.type&&"password"!==event.target.type&&"decimal"!==event.target.inputMode)return;if(!this.__lockState)return;if(!this.__lockState.editStarted)return void this.__unlock();let cellElement=event.target;for(;cellElement&&!(cellElement instanceof HTMLTableCellElement);)cellElement=cellElement.parentElement;let rowElement=cellElement;for(;rowElement&&!(rowElement instanceof HTMLTableRowElement);)rowElement=rowElement.parentElement;if(!rowElement)return;if(this.__unlock(),!cellElement||cellElement.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers")||cellElement.classList.contains("tchmi-datagrid-template-row-numbers"))return;let row=parseInt(cellElement.dataset.row||"",10),column=parseInt(cellElement.dataset.column||"",10);if(isNaN(row)||isNaN(column))return;if("TextBox"!==this.__internalSrcColumn[column].control&&"PasswordInput"!==this.__internalSrcColumn[column].control&&"NumericInput"!==this.__internalSrcColumn[column].control&&"SpinboxInput"!==this.__internalSrcColumn[column].control&&"DateTimeInput"!==this.__internalSrcColumn[column].control&&"TimespanInput"!==this.__internalSrcColumn[column].control||row>=this.__dataLength)return;let columnDefinition=this.__internalSrcColumn[column],valueOld=this.__srcData[row];switch(this.__internalSrcColumn[column].control){case"NumericInput":case"SpinboxInput":let minValue=null,maxValue=null,decimalDigits=null;if(!TcHmiDatagrid.isSimpleColumn(columnDefinition)){let typedColumn=columnDefinition;valueOld=this.__readObjectProperty(valueOld,typedColumn.name),typedColumn.dataDefinitions&&!Array.isArray(typedColumn.dataDefinitions)&&(void 0!==typedColumn.dataDefinitions.minValue&&(minValue=typedColumn.dataDefinitions.minValue),void 0!==typedColumn.dataDefinitions.maxValue&&(maxValue=typedColumn.dataDefinitions.maxValue),void 0!==typedColumn.dataDefinitions.decimalDigits&&(decimalDigits=typedColumn.dataDefinitions.decimalDigits))}let numericValue=Number(event.target.value);if(isNaN(numericValue)||null!==minValue&&numericValue<minValue||null!==maxValue&&numericValue>maxValue)return event.target.value=null!==decimalDigits?Number(valueOld).toFixed(decimalDigits):valueOld,void event.target.setCustomValidity("");break;case"DateTimeInput":TcHmiDatagrid.isSimpleColumn(columnDefinition)||(valueOld=this.__readObjectProperty(valueOld,columnDefinition.name)),this.__REGEX_ISO_8601_DATETIME.test(event.target.value)||(event.target.value=valueOld),event.target.setCustomValidity("");break;case"TimespanInput":TcHmiDatagrid.isSimpleColumn(columnDefinition)||(valueOld=this.__readObjectProperty(valueOld,columnDefinition.name)),this.__REGEX_ISO_8601_TIMESPAN.test(event.target.value)||(event.target.value=valueOld),event.target.setCustomValidity("")}let result,valueNew=event.target.value;if(result=this.__modifySrcData(valueNew,row,column,rowElement),result)if(result.needSorting)this.__filterAndSort(),this.__updateTable(0);else{let formattedValue=this.__executeFormatFunction(this.__internalSrcColumn[column].format,result.convertedValue);if("decimal"===event.target.inputMode){let columnDefinition=this.__internalSrcColumn[column];columnDefinition.dataDefinitions&&!Array.isArray(columnDefinition.dataDefinitions)&&columnDefinition.dataDefinitions.decimalDigits&&(formattedValue=Number(formattedValue).toFixed(columnDefinition.dataDefinitions.decimalDigits))}event.target.value=null!=formattedValue?formattedValue:"";for(let i=0,ii=this.__internalSrcColumn.length;i<ii;i++){let internalColumn=this.__internalSrcColumn[i];if(i!==column&&internalColumn.name===this.__internalSrcColumn[column].name){let cell=rowElement.children[i+1];cell instanceof HTMLTableCellElement&&this.__fillCell(cell,internalColumn,result.convertedValue)}}}},this.__onEmptyAreaClick=event=>{if(event.target===event.currentTarget&&this.__srcData&&this.getIsEnabled()&&TcHmi.Access.checkAccess(this,"operate")&&null!==this.__selectedCell){let changedProperties=["SelectedColumnIndex"];null!==this.__selectedCell.rowIndex&&changedProperties.push("SelectedRowIndex","selectedRowValue","selectedCellValue"),this.__elementDataTableBody.find("tr.focused, td.focused").removeClass("focused"),this.__selectedCell=null,TcHmi.EventProvider.raise(this.__id+".onSelectedItemChanged"),changedProperties.forEach(changedProperty=>TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:changedProperty}))}},this.__onKeydown=event=>{var _a;if(this.__srcData&&this.getIsEnabled()&&TcHmi.Access.checkAccess(this,"operate")&&event.target instanceof HTMLInputElement&&("text"===event.target.type||"password"===event.target.type||"decimal"===event.target.inputMode)&&this.__lockState)if(this.__lockState.editStarted=!0,"Enter"===event.key)event.target.blur();else if("Escape"===event.key&&this.__selectedCell&&null!==this.__selectedCell.rowIndex){let index=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);if(-1===index)return;let value=this.__srcData[index],columnDefinition=this.__internalSrcColumn[this.__selectedCell.columnIndex],decimalDigits=null;if(!TcHmiDatagrid.isSimpleColumn(columnDefinition)){let typedColumn=columnDefinition;value=this.__readObjectProperty(value,typedColumn.name),typedColumn&&!Array.isArray(typedColumn.dataDefinitions)&&void 0!==(null===(_a=typedColumn.dataDefinitions)||void 0===_a?void 0:_a.decimalDigits)&&(decimalDigits=typedColumn.dataDefinitions.decimalDigits)}let formattedValue=this.__executeFormatFunction(columnDefinition.format,value);"decimal"===event.target.inputMode&&decimalDigits&&(formattedValue=Number(formattedValue).toFixed(decimalDigits)),event.target.value=null!=formattedValue?formattedValue:"",this.__lockState.editStarted=!1,event.target.blur()}},this.__onInput=event=>{if(!this.__srcData)return;if(!this.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this,"operate"))return;if(!(event.target instanceof HTMLInputElement)||"text"!==event.target.type&&"password"!==event.target.type&&"decimal"!==event.target.inputMode)return;let cellElement=event.target;for(;cellElement&&!(cellElement instanceof HTMLTableCellElement);)cellElement=cellElement.parentElement;if(!cellElement)return;let row=parseInt(cellElement.dataset.row||"",10),column=parseInt(cellElement.dataset.column||"",10);if(!isNaN(row)&&!isNaN(column)){if(!this.__lockState){let rowElement=cellElement.parentElement;if(!(rowElement instanceof HTMLTableRowElement))return;row=this.__srcDataIndexToOriginalIndex(row),-1!==row&&this.__lock(row,column,rowElement)}switch(this.__internalSrcColumn[column].control){case"NumericInput":case"SpinboxInput":let columnDefinition=this.__internalSrcColumn[column],minValue=null,maxValue=null;if(!TcHmiDatagrid.isSimpleColumn(columnDefinition)){let typedColumn=columnDefinition;typedColumn.dataDefinitions&&!Array.isArray(typedColumn.dataDefinitions)&&(void 0!==typedColumn.dataDefinitions.minValue&&(minValue=typedColumn.dataDefinitions.minValue),void 0!==typedColumn.dataDefinitions.maxValue&&(maxValue=typedColumn.dataDefinitions.maxValue))}let numericValue=Number(event.target.value);isNaN(numericValue)||null!==minValue&&numericValue<minValue||null!==maxValue&&numericValue>maxValue?event.target.setCustomValidity("invalid"):event.target.setCustomValidity("");break;case"DateTimeInput":this.__REGEX_ISO_8601_DATETIME.test(event.target.value)?event.target.setCustomValidity(""):event.target.setCustomValidity("invalid");break;case"TimespanInput":this.__REGEX_ISO_8601_TIMESPAN.test(event.target.value)?event.target.setCustomValidity(""):event.target.setCustomValidity("invalid")}this.__lockState&&(this.__lockState.editStarted=!0)}},this.__onCheckboxMouseDown=event=>{if(!this.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this,"operate"))return;if(!(event.target instanceof HTMLLabelElement&&event.target.previousElementSibling instanceof HTMLInputElement&&("checkbox"===event.target.previousElementSibling.type||"radio"===event.target.previousElementSibling.type)))return;let cellElement=event.target;for(;cellElement&&!(cellElement instanceof HTMLTableCellElement);)cellElement=cellElement.parentElement;if(!cellElement)return;let rowElement=cellElement.parentElement;if(!(rowElement instanceof HTMLTableRowElement))return;let row=parseInt(cellElement.dataset.row||"",10),column=parseInt(cellElement.dataset.column||"",10);isNaN(row)||isNaN(column)||(row=this.__srcDataIndexToOriginalIndex(row),-1!==row&&this.__lock(row,column,rowElement))},this.__onValueChange=event=>{var _a,_b;if(!this.__srcData)return;if(!this.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this,"operate"))return;if(!(event.target instanceof HTMLInputElement)||"checkbox"!==event.target.type&&"radio"!==event.target.type)return;let rowElement=event.target;for(;rowElement&&!(rowElement instanceof HTMLTableRowElement);)rowElement=rowElement.parentElement;if(!rowElement)return;this.__lockState&&"ComboBox"===this.__internalSrcColumn[this.__lockState.column].control&&this.__unlock();let cellElement=event.target;for(;cellElement&&!(cellElement instanceof HTMLTableCellElement);)cellElement=cellElement.parentElement;if(!cellElement)return;let row=parseInt(cellElement.dataset.row||"",10),column=parseInt(cellElement.dataset.column||"",10);if(!isNaN(row)&&!isNaN(column))if("CheckBox"===this.__internalSrcColumn[column].control||"ToggleSwitch"===this.__internalSrcColumn[column].control){let result=this.__modifySrcData(event.target.checked,row,column,rowElement);if(result)if(result.needSorting)this.__filterAndSort(),this.__updateTable(0);else{event.target.value=null!==(_a=this.__executeFormatFunction(this.__internalSrcColumn[column].format,result.convertedValue))&&void 0!==_a?_a:"";for(let i=0,ii=this.__internalSrcColumn.length;i<ii;i++){let internalColumn=this.__internalSrcColumn[i];if(i!==column&&internalColumn.name===this.__internalSrcColumn[column].name){let cell=rowElement.children[i+1];cell instanceof HTMLTableCellElement&&this.__fillCell(cell,internalColumn,result.convertedValue)}}}}else if("RadioButton"===this.__internalSrcColumn[column].control){let result=this.__modifyRadioButton(row,column,rowElement);if(result)if(result.needSorting)this.__filterAndSort(),this.__updateTable(0);else{let rowsToUpdate=this.__elementDataTableBody[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row td input[type=radio]:checked");for(let i=0,ii=this.__internalSrcColumn.length;i<ii;i++){let internalColumn=this.__internalSrcColumn[i];if(internalColumn.name===this.__internalSrcColumn[column].name)for(let radioButton of rowsToUpdate){let rowElementRadio=radioButton.parentElement;for(;rowElementRadio&&!(rowElementRadio instanceof HTMLTableRowElement);)rowElementRadio=rowElementRadio.parentElement;let cell=null!==(_b=null==rowElementRadio?void 0:rowElementRadio.children[i+1])&&void 0!==_b?_b:void 0;cell instanceof HTMLTableCellElement&&this.__fillCell(cell,internalColumn,rowElement===rowElementRadio)}}}}},this.__onButtonMousedown=event=>{var _a,_b,_c;if(!this.__srcData)return;if(!this.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this,"operate"))return;if(!(null===(_a=event.target)||void 0===_a?void 0:_a.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-button")))return;let cellElement=event.target;for(;cellElement&&!(cellElement instanceof HTMLTableCellElement);)cellElement=cellElement.parentElement;if(!cellElement)return;let rowElement=cellElement;for(;rowElement&&!(rowElement instanceof HTMLTableRowElement);)rowElement=rowElement.parentElement;if(!rowElement)return;let row=parseInt(cellElement.dataset.row||"",10),column=parseInt(cellElement.dataset.column||"",10);if(isNaN(row)||isNaN(column))return;let columnDefinition=this.__internalSrcColumn[column];if(!columnDefinition.editable)return;"SpinboxInput"!==columnDefinition.control&&(null===(_b=this.__buttonLeaveDestroyer)||void 0===_b||_b.call(this),event.target.addEventListener("mouseleave",this.__onButtonMouseleave),this.__buttonLeaveDestroyer=()=>{event.target.removeEventListener("mouseleave",this.__onButtonMouseleave)},null===(_c=this.__buttonEnterDestroyer)||void 0===_c||_c.call(this),event.target.addEventListener("mouseenter",this.__onButtonMouseenter),this.__buttonEnterDestroyer=()=>{event.target.removeEventListener("mouseenter",this.__onButtonMouseenter)});let buttonDown=event.target.classList.toggle("down"),rowToLock=this.__srcDataIndexToOriginalIndex(row);if(-1!==rowToLock&&setTimeout(()=>{this.__lock(rowToLock,column,rowElement,event.target)},0),"SpinboxInput"!==columnDefinition.control&&"TimespanInput"!==columnDefinition.control&&"DateTimeInput"!==columnDefinition.control){let result;if(result=this.__modifySrcData(buttonDown,row,column,rowElement),result)if(result.needSorting)this.__filterAndSort(),this.__updateTable(0);else{let formattedValue=this.__executeFormatFunction(this.__internalSrcColumn[column].format,result.convertedValue);event.target.classList.toggle("down",TcHmi.ValueConverter.toBoolean(formattedValue,!1));for(let i=0,ii=this.__internalSrcColumn.length;i<ii;i++){let internalColumn=this.__internalSrcColumn[i];if(i!==column&&internalColumn.name===this.__internalSrcColumn[column].name){let cell=rowElement.children[i+1];cell instanceof HTMLTableCellElement&&this.__fillCell(cell,internalColumn,result.convertedValue)}}}"ToggleButton"===columnDefinition.control&&setTimeout(()=>{this.__unlock()},0)}},this.__onButtonMouseup=event=>{var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k;if(null===(_a=this.__buttonLeaveDestroyer)||void 0===_a||_a.call(this),this.__buttonLeaveDestroyer=null,null===(_b=this.__buttonEnterDestroyer)||void 0===_b||_b.call(this),this.__buttonEnterDestroyer=null,!this.__srcData)return;if(!this.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this,"operate"))return;if(null===this.__lockState||this.__lockState.editStarted)return;if(null===(_c=this.__lockState.targetElement)||void 0===_c||_c.classList.remove("down"),!(null===(_d=event.target)||void 0===_d?void 0:_d.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-button"))||!tchmi_equal(event.target,this.__lockState.targetElement))return void((null===(_e=this.__lockState.targetElement)||void 0===_e?void 0:_e.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-button"))&&this.__unlock());let result,cellElement=this.__lockState.rowElement.children.item(this.__lockState.column+1),valueNew=!1,srcDataRow=this.__originalIndexToSrcDataIndex(this.__lockState.row),inputElement=cellElement.getElementsByTagName("input")[0],columnDefinition=this.__internalSrcColumn[this.__lockState.column];if("SpinboxInput"===columnDefinition.control){if(!columnDefinition.editable)return;let valueOld=this.__srcData[srcDataRow],step=1,minValue=null,maxValue=null,decimalDigits=null;if(!TcHmiDatagrid.isSimpleColumn(columnDefinition)){let typedColumn=columnDefinition;valueOld=this.__readObjectProperty(valueOld,typedColumn.name),typedColumn.dataDefinitions&&!Array.isArray(typedColumn.dataDefinitions)&&(void 0!==typedColumn.dataDefinitions.step&&(step=typedColumn.dataDefinitions.step),void 0!==typedColumn.dataDefinitions.minValue&&(minValue=typedColumn.dataDefinitions.minValue),void 0!==typedColumn.dataDefinitions.maxValue&&(maxValue=typedColumn.dataDefinitions.maxValue),void 0!==typedColumn.dataDefinitions.decimalDigits&&(decimalDigits=typedColumn.dataDefinitions.decimalDigits))}let valueNumber=Number(valueOld);isNaN(valueNumber)&&(valueNumber=null!==(_f=null!=minValue?minValue:maxValue)&&void 0!==_f?_f:0),"+"===event.target.textContent?valueNumber+=step:"-"===event.target.textContent&&(valueNumber-=step),null!==minValue&&valueNumber<minValue&&(valueNumber=minValue),null!==maxValue&&valueNumber>maxValue&&(valueNumber=maxValue),null!==decimalDigits&&Number(valueNumber.toFixed(decimalDigits))!==valueNumber&&(valueNumber=Number(valueNumber.toFixed(decimalDigits))),valueNew=valueNumber}else if("DateTimeInput"===columnDefinition.control){this.__dateTimePickerInstance||void 0!==TcHmi.Controls.get(this.getId()+".TcHmiDateTimePicker")||(this.__dateTimePickerInstance=TcHmi.ControlFactory.create("TcHmi.Controls.Beckhoff.TcHmiDateTimePicker",this.getId()+".DateTimerPicker",this),this.__dateTimePickerInstance&&this.__element[0].append(this.__dateTimePickerInstance.getElement()[0]));let valueOld=this.__srcData[srcDataRow];if(TcHmiDatagrid.isSimpleColumn(columnDefinition)||(valueOld=this.__readObjectProperty(valueOld,columnDefinition.name)),this.__dateTimePickerInstance)return this.__REGEX_ISO_8601_DATETIME.test(valueOld)?this.__dateTimePickerInstance.setValue(valueOld):this.__dateTimePickerInstance.setValue(null),this.__lockState.editStarted=!0,null===(_g=this.__timePickerConfirmedEventDestroyer)||void 0===_g||_g.call(this),this.__timePickerConfirmedEventDestroyer=TcHmi.EventProvider.register(this.__dateTimePickerInstance.getId()+".onConfirmed",()=>{var _a;if(this.__dateTimePickerInstance&&this.__lockState){let result,valueNew=this.__dateTimePickerInstance.getValue();if(result=this.__modifySrcData(valueNew,srcDataRow,this.__lockState.column,this.__lockState.rowElement),result){let formattedValue=this.__executeFormatFunction(this.__internalSrcColumn[this.__lockState.column].format,result.convertedValue);if(inputElement){let columnDefinition=this.__internalSrcColumn[this.__lockState.column];columnDefinition.dataDefinitions&&!Array.isArray(columnDefinition.dataDefinitions)&&columnDefinition.dataDefinitions.decimalDigits&&(formattedValue=Number(formattedValue).toFixed(columnDefinition.dataDefinitions.decimalDigits)),inputElement.value=null!=formattedValue?formattedValue:""}else event.target.classList.toggle("down",TcHmi.ValueConverter.toBoolean(formattedValue,!1));if(result.needSorting)this.__filterAndSort(),this.__updateTable(0);else for(let i=0,ii=this.__internalSrcColumn.length;i<ii;i++){let internalColumn=this.__internalSrcColumn[i];if(i!==this.__lockState.column&&internalColumn.name===this.__internalSrcColumn[this.__lockState.column].name){let cell=this.__lockState.rowElement.children[i+1];cell instanceof HTMLTableCellElement&&this.__fillCell(cell,internalColumn,result.convertedValue)}}}}this.__unlock(),null===(_a=this.__timePickerConfirmedEventDestroyer)||void 0===_a||_a.call(this),this.__timePickerConfirmedEventDestroyer=null}),null===(_h=this.__timePickerCanceledEventDestroyer)||void 0===_h||_h.call(this),this.__timePickerCanceledEventDestroyer=TcHmi.EventProvider.register(this.__dateTimePickerInstance.getId()+".onCancel",()=>{var _a;this.__unlock(),null===(_a=this.__timePickerCanceledEventDestroyer)||void 0===_a||_a.call(this),this.__timePickerCanceledEventDestroyer=null}),void this.__dateTimePickerInstance.openDateTimePicker()}else if("TimespanInput"===columnDefinition.control){this.__timespanPickerInstance||void 0!==TcHmi.Controls.get(this.getId()+".TimespanPicker")||(this.__timespanPickerInstance=TcHmi.ControlFactory.create("TcHmi.Controls.Beckhoff.TcHmiTimespanPicker",this.getId()+".TimespanPicker",this),this.__timespanPickerInstance&&this.__element[0].append(this.__timespanPickerInstance.getElement()[0]));let valueOld=this.__srcData[srcDataRow];if(TcHmiDatagrid.isSimpleColumn(columnDefinition)||(valueOld=this.__readObjectProperty(valueOld,columnDefinition.name)),this.__timespanPickerInstance)return this.__REGEX_ISO_8601_TIMESPAN.test(valueOld)?this.__timespanPickerInstance.setValue(valueOld):this.__timespanPickerInstance.setValue(null),this.__lockState.editStarted=!0,null===(_j=this.__timePickerConfirmedEventDestroyer)||void 0===_j||_j.call(this),this.__timePickerConfirmedEventDestroyer=TcHmi.EventProvider.register(this.__timespanPickerInstance.getId()+".onConfirmed",()=>{var _a;if(this.__timespanPickerInstance&&this.__lockState){let result,valueNew=this.__timespanPickerInstance.getValue();if(result=this.__modifySrcData(valueNew,srcDataRow,this.__lockState.column,this.__lockState.rowElement),result){let formattedValue=this.__executeFormatFunction(this.__internalSrcColumn[this.__lockState.column].format,result.convertedValue);if(inputElement){let columnDefinition=this.__internalSrcColumn[this.__lockState.column];columnDefinition.dataDefinitions&&!Array.isArray(columnDefinition.dataDefinitions)&&columnDefinition.dataDefinitions.decimalDigits&&(formattedValue=Number(formattedValue).toFixed(columnDefinition.dataDefinitions.decimalDigits)),inputElement.value=null!=formattedValue?formattedValue:""}else event.target.classList.toggle("down",TcHmi.ValueConverter.toBoolean(formattedValue,!1));if(result.needSorting)this.__filterAndSort(),this.__updateTable(0);else for(let i=0,ii=this.__internalSrcColumn.length;i<ii;i++){let internalColumn=this.__internalSrcColumn[i];if(i!==this.__lockState.column&&internalColumn.name===this.__internalSrcColumn[this.__lockState.column].name){let cell=this.__lockState.rowElement.children[i+1];cell instanceof HTMLTableCellElement&&this.__fillCell(cell,internalColumn,result.convertedValue)}}}}this.__unlock(),null===(_a=this.__timePickerConfirmedEventDestroyer)||void 0===_a||_a.call(this),this.__timePickerConfirmedEventDestroyer=null}),null===(_k=this.__timePickerCanceledEventDestroyer)||void 0===_k||_k.call(this),this.__timePickerCanceledEventDestroyer=TcHmi.EventProvider.register(this.__timespanPickerInstance.getId()+".onCancel",()=>{this.__unlock(),this.__timePickerCanceledEventDestroyer=null}),void this.__timespanPickerInstance.openTimespanPicker()}if(result=this.__modifySrcData(valueNew,srcDataRow,this.__lockState.column,this.__lockState.rowElement),result){let formattedValue=this.__executeFormatFunction(this.__internalSrcColumn[this.__lockState.column].format,result.convertedValue);if(inputElement){let columnDefinition=this.__internalSrcColumn[this.__lockState.column];columnDefinition.dataDefinitions&&!Array.isArray(columnDefinition.dataDefinitions)&&columnDefinition.dataDefinitions.decimalDigits&&(formattedValue=Number(formattedValue).toFixed(columnDefinition.dataDefinitions.decimalDigits)),inputElement.value=null!=formattedValue?formattedValue:""}else event.target.classList.toggle("down",TcHmi.ValueConverter.toBoolean(formattedValue,!1));if(result.needSorting)this.__filterAndSort(),this.__updateTable(0);else for(let i=0,ii=this.__internalSrcColumn.length;i<ii;i++){let internalColumn=this.__internalSrcColumn[i];if(i!==this.__lockState.column&&internalColumn.name===this.__internalSrcColumn[this.__lockState.column].name){let cell=this.__lockState.rowElement.children[i+1];cell instanceof HTMLTableCellElement&&this.__fillCell(cell,internalColumn,result.convertedValue)}}}this.__unlock()},this.__onButtonMouseleave=event=>{var _a,_b,_c;if(!this.__srcData)return;if(!this.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this,"operate"))return;if(null===this.__lockState)return;if(event.target.classList.remove("down"),(null===(_a=event.target)||void 0===_a?void 0:_a.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-spinbox-button"))&&!(null===(_b=event.target)||void 0===_b?void 0:_b.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-date-time-button"))&&!(null===(_c=event.target)||void 0===_c?void 0:_c.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-timespan-button")))return;let result;if(result=this.__modifySrcData(!1,this.__originalIndexToSrcDataIndex(this.__lockState.row),this.__lockState.column,this.__lockState.rowElement),result)if(result.needSorting)this.__filterAndSort(),this.__updateTable(0);else{let formattedValue=this.__executeFormatFunction(this.__internalSrcColumn[this.__lockState.column].format,result.convertedValue);event.target.classList.toggle("down",TcHmi.ValueConverter.toBoolean(formattedValue,!1));for(let i=0,ii=this.__internalSrcColumn.length;i<ii;i++){let internalColumn=this.__internalSrcColumn[i];if(i!==this.__lockState.column&&internalColumn.name===this.__internalSrcColumn[this.__lockState.column].name){let cell=this.__lockState.rowElement.children[i+1];cell instanceof HTMLTableCellElement&&this.__fillCell(cell,internalColumn,result.convertedValue)}}}},this.__onButtonMouseenter=event=>{var _a,_b,_c,_d;if(event.target.classList.add("down"),!tchmi_equal(event.target,null===(_a=this.__lockState)||void 0===_a?void 0:_a.targetElement))return;if(!this.__srcData)return;if(!this.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this,"operate"))return;if((null===(_b=event.target)||void 0===_b?void 0:_b.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-spinbox-button"))&&!(null===(_c=event.target)||void 0===_c?void 0:_c.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-date-time-button"))&&!(null===(_d=event.target)||void 0===_d?void 0:_d.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-timespan-button")))return;if(null===this.__lockState)return;let result;if(result=this.__modifySrcData(!0,this.__originalIndexToSrcDataIndex(this.__lockState.row),this.__lockState.column,this.__lockState.rowElement),result)if(result.needSorting)this.__filterAndSort(),this.__updateTable(0);else{let formattedValue=this.__executeFormatFunction(this.__internalSrcColumn[this.__lockState.column].format,result.convertedValue);event.target.classList.toggle("down",TcHmi.ValueConverter.toBoolean(formattedValue,!1));for(let i=0,ii=this.__internalSrcColumn.length;i<ii;i++){let internalColumn=this.__internalSrcColumn[i];if(i!==this.__lockState.column&&internalColumn.name===this.__internalSrcColumn[this.__lockState.column].name){let cell=this.__lockState.rowElement.children[i+1];cell instanceof HTMLTableCellElement&&this.__fillCell(cell,internalColumn,result.convertedValue)}}}},this.__onButtonTouchstart=event=>{var _a,_b,_c,_d;if(!this.__srcData)return;if(!this.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this,"operate"))return;if(!(null===(_a=event.target)||void 0===_a?void 0:_a.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-button")))return;event.preventDefault(),null===(_b=document.activeElement)||void 0===_b||_b.blur(),this.__onFocusElement(event);let cellElement=event.target;for(;cellElement&&!(cellElement instanceof HTMLTableCellElement);)cellElement=cellElement.parentElement;if(!cellElement)return;let rowElement=cellElement;for(;rowElement&&!(rowElement instanceof HTMLTableRowElement);)rowElement=rowElement.parentElement;if(!rowElement)return;let row=parseInt(cellElement.dataset.row||"",10),column=parseInt(cellElement.dataset.column||"",10);if(isNaN(row)||isNaN(column))return;if(!this.__internalSrcColumn[column].editable)return;let buttonDown=event.target.classList.toggle("down"),rowToLock=this.__srcDataIndexToOriginalIndex(row);if(-1!==rowToLock&&setTimeout(()=>{this.__lock(rowToLock,column,rowElement,event.target)},0),!(null===(_c=event.target)||void 0===_c?void 0:_c.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-spinbox-button"))){let result;if(result=this.__modifySrcData(buttonDown,row,column,rowElement),result)if(result.needSorting)this.__filterAndSort(),this.__updateTable(0);else{let formattedValue=this.__executeFormatFunction(this.__internalSrcColumn[column].format,result.convertedValue);event.target.classList.toggle("down",TcHmi.ValueConverter.toBoolean(formattedValue,!1));for(let i=0,ii=this.__internalSrcColumn.length;i<ii;i++){let internalColumn=this.__internalSrcColumn[i];if(i!==column&&internalColumn.name===this.__internalSrcColumn[column].name){let cell=rowElement.children[i+1];cell instanceof HTMLTableCellElement&&this.__fillCell(cell,internalColumn,result.convertedValue)}}}(null===(_d=event.target)||void 0===_d?void 0:_d.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-toggle-button"))&&setTimeout(()=>{this.__unlock()},0)}},this.__onButtonTouchend=event=>{var _a,_b,_c,_d,_e,_f,_g,_h;if(!this.__srcData)return;if(!this.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this,"operate"))return;if(null===this.__lockState||this.__lockState.editStarted)return;if(null===(_a=this.__lockState.targetElement)||void 0===_a||_a.classList.remove("down"),!(null===(_b=event.target)||void 0===_b?void 0:_b.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-button"))||!tchmi_equal(event.target,this.__lockState.targetElement))return void((null===(_c=this.__lockState.targetElement)||void 0===_c?void 0:_c.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-button"))&&this.__unlock());let cellElement=this.__lockState.rowElement.children.item(this.__lockState.column+1);event.preventDefault();let result,valueNew=!1,srcDataRow=this.__originalIndexToSrcDataIndex(this.__lockState.row),spinboxInput=cellElement.getElementsByTagName("input")[0],inputElement=cellElement.getElementsByTagName("input")[0],columnDefinition=this.__internalSrcColumn[this.__lockState.column];if("SpinboxInput"===columnDefinition.control){let columnDefinition=this.__internalSrcColumn[this.__lockState.column];if(!columnDefinition.editable)return;let valueOld=this.__srcData[srcDataRow],step=1,minValue=null,maxValue=null,decimalDigits=null;if(!TcHmiDatagrid.isSimpleColumn(columnDefinition)){let typedColumn=columnDefinition;valueOld=this.__readObjectProperty(valueOld,typedColumn.name),typedColumn.dataDefinitions&&!Array.isArray(typedColumn.dataDefinitions)&&(void 0!==typedColumn.dataDefinitions.step&&(step=typedColumn.dataDefinitions.step),void 0!==typedColumn.dataDefinitions.minValue&&(minValue=typedColumn.dataDefinitions.minValue),void 0!==typedColumn.dataDefinitions.maxValue&&(maxValue=typedColumn.dataDefinitions.maxValue),void 0!==typedColumn.dataDefinitions.decimalDigits&&(decimalDigits=typedColumn.dataDefinitions.decimalDigits))}let valueNumber=Number(valueOld);isNaN(valueNumber)&&(valueNumber=null!==(_d=null!=minValue?minValue:maxValue)&&void 0!==_d?_d:0),"+"===event.target.textContent?valueNumber+=step:"-"===event.target.textContent&&(valueNumber-=step),null!==minValue&&valueNumber<minValue&&(valueNumber=minValue),null!==maxValue&&valueNumber>maxValue&&(valueNumber=maxValue),null!==decimalDigits&&Number(valueNumber.toFixed(decimalDigits))!==valueNumber&&(valueNumber=Number(valueNumber.toFixed(decimalDigits))),valueNew=valueNumber}else if("DateTimeInput"===columnDefinition.control){this.__dateTimePickerInstance||void 0!==TcHmi.Controls.get(this.getId()+".TcHmiDateTimePicker")||(this.__dateTimePickerInstance=TcHmi.ControlFactory.create("TcHmi.Controls.Beckhoff.TcHmiDateTimePicker",this.getId()+".DateTimerPicker",this),this.__dateTimePickerInstance&&this.__element[0].append(this.__dateTimePickerInstance.getElement()[0]));let valueOld=this.__srcData[srcDataRow];if(TcHmiDatagrid.isSimpleColumn(columnDefinition)||(valueOld=this.__readObjectProperty(valueOld,columnDefinition.name)),this.__dateTimePickerInstance)return this.__REGEX_ISO_8601_DATETIME.test(valueOld)?this.__dateTimePickerInstance.setValue(valueOld):this.__dateTimePickerInstance.setValue(null),this.__lockState.editStarted=!0,null===(_e=this.__timePickerConfirmedEventDestroyer)||void 0===_e||_e.call(this),this.__timePickerConfirmedEventDestroyer=TcHmi.EventProvider.register(this.__dateTimePickerInstance.getId()+".onConfirmed",()=>{var _a;if(this.__dateTimePickerInstance&&this.__lockState){let result,valueNew=this.__dateTimePickerInstance.getValue();if(result=this.__modifySrcData(valueNew,srcDataRow,this.__lockState.column,this.__lockState.rowElement),result){let formattedValue=this.__executeFormatFunction(this.__internalSrcColumn[this.__lockState.column].format,result.convertedValue);if(inputElement){let columnDefinition=this.__internalSrcColumn[this.__lockState.column];columnDefinition.dataDefinitions&&!Array.isArray(columnDefinition.dataDefinitions)&&columnDefinition.dataDefinitions.decimalDigits&&(formattedValue=Number(formattedValue).toFixed(columnDefinition.dataDefinitions.decimalDigits)),inputElement.value=null!=formattedValue?formattedValue:""}else event.target.classList.toggle("down",TcHmi.ValueConverter.toBoolean(formattedValue,!1));if(result.needSorting)this.__filterAndSort(),this.__updateTable(0);else for(let i=0,ii=this.__internalSrcColumn.length;i<ii;i++){let internalColumn=this.__internalSrcColumn[i];if(i!==this.__lockState.column&&internalColumn.name===this.__internalSrcColumn[this.__lockState.column].name){let cell=this.__lockState.rowElement.children[i+1];cell instanceof HTMLTableCellElement&&this.__fillCell(cell,internalColumn,result.convertedValue)}}}}this.__unlock(),null===(_a=this.__timePickerConfirmedEventDestroyer)||void 0===_a||_a.call(this),this.__timePickerConfirmedEventDestroyer=null}),null===(_f=this.__timePickerCanceledEventDestroyer)||void 0===_f||_f.call(this),this.__timePickerCanceledEventDestroyer=TcHmi.EventProvider.register(this.__dateTimePickerInstance.getId()+".onCancel",()=>{var _a;this.__unlock(),null===(_a=this.__timePickerCanceledEventDestroyer)||void 0===_a||_a.call(this),this.__timePickerCanceledEventDestroyer=null}),void this.__dateTimePickerInstance.openDateTimePicker()}else if("TimespanInput"===columnDefinition.control){this.__timespanPickerInstance||void 0!==TcHmi.Controls.get(this.getId()+".TimespanPicker")||(this.__timespanPickerInstance=TcHmi.ControlFactory.create("TcHmi.Controls.Beckhoff.TcHmiTimespanPicker",this.getId()+".TimespanPicker",this),this.__timespanPickerInstance&&this.__element[0].append(this.__timespanPickerInstance.getElement()[0]));let valueOld=this.__srcData[srcDataRow];if(TcHmiDatagrid.isSimpleColumn(columnDefinition)||(valueOld=this.__readObjectProperty(valueOld,columnDefinition.name)),this.__timespanPickerInstance)return this.__REGEX_ISO_8601_TIMESPAN.test(valueOld)?this.__timespanPickerInstance.setValue(valueOld):this.__timespanPickerInstance.setValue(null),this.__lockState.editStarted=!0,null===(_g=this.__timePickerConfirmedEventDestroyer)||void 0===_g||_g.call(this),this.__timePickerConfirmedEventDestroyer=TcHmi.EventProvider.register(this.__timespanPickerInstance.getId()+".onConfirmed",()=>{var _a;if(this.__timespanPickerInstance&&this.__lockState){let result,valueNew=this.__timespanPickerInstance.getValue();if(result=this.__modifySrcData(valueNew,srcDataRow,this.__lockState.column,this.__lockState.rowElement),result){let formattedValue=this.__executeFormatFunction(this.__internalSrcColumn[this.__lockState.column].format,result.convertedValue);if(inputElement){let columnDefinition=this.__internalSrcColumn[this.__lockState.column];columnDefinition.dataDefinitions&&!Array.isArray(columnDefinition.dataDefinitions)&&columnDefinition.dataDefinitions.decimalDigits&&(formattedValue=Number(formattedValue).toFixed(columnDefinition.dataDefinitions.decimalDigits)),inputElement.value=null!=formattedValue?formattedValue:""}else event.target.classList.toggle("down",TcHmi.ValueConverter.toBoolean(formattedValue,!1));if(result.needSorting)this.__filterAndSort(),this.__updateTable(0);else for(let i=0,ii=this.__internalSrcColumn.length;i<ii;i++){let internalColumn=this.__internalSrcColumn[i];if(i!==this.__lockState.column&&internalColumn.name===this.__internalSrcColumn[this.__lockState.column].name){let cell=this.__lockState.rowElement.children[i+1];cell instanceof HTMLTableCellElement&&this.__fillCell(cell,internalColumn,result.convertedValue)}}}}this.__unlock(),null===(_a=this.__timePickerConfirmedEventDestroyer)||void 0===_a||_a.call(this),this.__timePickerConfirmedEventDestroyer=null}),null===(_h=this.__timePickerCanceledEventDestroyer)||void 0===_h||_h.call(this),this.__timePickerCanceledEventDestroyer=TcHmi.EventProvider.register(this.__timespanPickerInstance.getId()+".onCancel",()=>{var _a;this.__unlock(),null===(_a=this.__timePickerCanceledEventDestroyer)||void 0===_a||_a.call(this),this.__timePickerCanceledEventDestroyer=null}),void this.__timespanPickerInstance.openTimespanPicker()}if(result=this.__modifySrcData(valueNew,srcDataRow,this.__lockState.column,this.__lockState.rowElement),result){let formattedValue=this.__executeFormatFunction(this.__internalSrcColumn[this.__lockState.column].format,result.convertedValue);if(spinboxInput){let columnDefinition=this.__internalSrcColumn[this.__lockState.column];columnDefinition.dataDefinitions&&!Array.isArray(columnDefinition.dataDefinitions)&&columnDefinition.dataDefinitions.decimalDigits&&(formattedValue=Number(formattedValue).toFixed(columnDefinition.dataDefinitions.decimalDigits)),spinboxInput.value=null!=formattedValue?formattedValue:""}else event.target.classList.toggle("down",TcHmi.ValueConverter.toBoolean(formattedValue,!1));if(result.needSorting)this.__filterAndSort(),this.__updateTable(0);else for(let i=0,ii=this.__internalSrcColumn.length;i<ii;i++){let internalColumn=this.__internalSrcColumn[i];if(i!==this.__lockState.column&&internalColumn.name===this.__internalSrcColumn[this.__lockState.column].name){let cell=this.__lockState.rowElement.children[i+1];cell instanceof HTMLTableCellElement&&this.__fillCell(cell,internalColumn,result.convertedValue)}}}this.__unlock()},this.__onResolverForSrcColumnWatchCallback=data=>{!1===this.__isAttached&&this.__suspendObjectResolver("srcColumn"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__srcColumn)||(this.__srcColumn=data.value,Array.isArray(data.value)?this.__internalSrcColumn=data.value:this.__internalSrcColumn=[data.value],TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SrcColumn"}),this.__processSrcColumn()):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=SrcColumn] Resolving symbols from object failed with error: "+TcHmi.Log.buildMessage(data.details))},this.__onResolverForSrcDataWatchCallback=data=>{!1===this.__isAttached&&this.__suspendObjectResolver("srcData"),data.error===TcHmi.Errors.NONE?(this.__srcDataHasChanged&&(this.__srcDataHasChanged=!1,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"srcDataHasChanged"})),tchmi_equal(data.value,this.__srcData)||(null!==data.value?this.__srcData=data.value:this.__srcData=[],this.__filterSortMap=null,this.__dataSymbol||TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SrcData"}),this.__processSrcData())):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=SrcData] Resolving symbols from object failed with error: "+TcHmi.Log.buildMessage(data.details))},this.__onDataSymbolPage=data=>{var _a,_b,_c,_d,_e,_f,_g;if(this.__pagingInfo.timing.firstResponsePending&&(this.__pagingInfo.timing.firstResponsePending=!1,this.__pagingInfo.timing.responseLatencies.push(Date.now()-this.__pagingInfo.timing.lastRequestTime),this.__pagingInfo.timing.responseLatencies.length>3&&this.__pagingInfo.timing.responseLatencies.shift()),data.error!==TcHmi.Errors.NONE)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${null===(_a=this.__dataSymbol)||void 0===_a?void 0:_a.getExpression().toString()}%/s%] `+TcHmi.Log.buildMessage(data.details)));if(!data.response)return void TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${null===(_b=this.__dataSymbol)||void 0===_b?void 0:_b.getExpression().toString()}%/s%] `+TcHmi.Log.buildMessage({code:TcHmi.Errors.E_SERVER_RESPONSE_MISSING,message:TcHmi.Errors[TcHmi.Errors.E_SERVER_RESPONSE_MISSING],reason:"Missing response from server.",domain:this.__type}));if(data.response.error)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${null===(_c=this.__dataSymbol)||void 0===_c?void 0:_c.getExpression().toString()}%/s%] `+TcHmi.Log.buildMessage(data.response.error)));if(!data.response.commands||0===data.response.commands.length)return void TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${null===(_d=this.__dataSymbol)||void 0===_d?void 0:_d.getExpression().toString()}%/s%] `+TcHmi.Log.buildMessage({code:TcHmi.Errors.E_SERVER_COMMANDS_MISSING,message:TcHmi.Errors[TcHmi.Errors.E_SERVER_COMMANDS_MISSING],reason:"Missing commands in response from server with id: '"+data.response.id+"'.",domain:this.__type}));if(data.response.commands[0].error)return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${null===(_e=this.__dataSymbol)||void 0===_e?void 0:_e.getExpression().toString()}%/s%] `+TcHmi.Log.buildMessage(data.response.commands[0].error)));let command=data.response.commands[0],srcData=new Array(command.maxEntries);for(let i=0,ii=command.readValue.length;i<ii;i++){let value=command.readValue[i];this.__dataSymbolTransform&&(value=this.__dataSymbolTransform(value)),srcData[i+(null!==(_f=command.offset)&&void 0!==_f?_f:0)]=value}this.__pagingInfo.actualOffset=null!==(_g=command.offset)&&void 0!==_g?_g:0,this.__pagingInfo.filterMap=command.filterMap,this.__setSrcData(srcData)},this.__onDataSymbolWatch=data=>{var _a,_b;data.error===TcHmi.Errors.NONE?this.__setSrcData(null!==(_b=data.value)&&void 0!==_b?_b:null):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=${null===(_a=this.__dataSymbol)||void 0===_a?void 0:_a.getExpression().toString()}] `+TcHmi.Log.buildMessage(data.details))},this.__onResolverForSortingWatchCallback=data=>{!1===this.__isAttached&&this.__suspendObjectResolver("sorting"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__sorting)||(this.__sorting=data.value,this.__internalSorting=tchmi_clone_object(data.value)||[],TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"Sorting"}),this.__processSorting()):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=Sorting] Resolving symbols from object failed with error: "+TcHmi.Log.buildMessage(data.details))},this.__onResolverForFilterWatchCallback=data=>{!1===this.__isAttached&&this.__suspendObjectResolver("filter"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__filter)||(this.__filter=data.value,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"Filter"}),this.__processFilter()):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=Filter] Resolving symbols from object failed with error: "+TcHmi.Log.buildMessage(data.details))},this.__onResolverForHeaderCellPaddingWatchCallback=data=>{!1===this.__isAttached&&this.__suspendObjectResolver("headerCellPadding"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__headerCellPadding)||(this.__headerCellPadding=data.value,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderCellPadding"}),this.__processHeaderCellPadding()):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=HeaderCellPadding] Resolving symbols from object failed with error: "+TcHmi.Log.buildMessage(data.details))},this.__onResolverForTableBorderColorWatchCallback=data=>{!1===this.__isAttached&&this.__suspendObjectResolver("tableBorderColor"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__tableBorderColor)||(this.__tableBorderColor=data.value,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"TableBorderColor"}),this.__processTableBorderColor()):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=TableBorderColor] Resolving symbols from object failed with error: "+TcHmi.Log.buildMessage(data.details))},this.__onResolverForTableBorderStyleWatchCallback=data=>{!1===this.__isAttached&&this.__suspendObjectResolver("tableBorderStyle"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__tableBorderStyle)||(this.__tableBorderStyle=data.value,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"TableBorderStyle"}),this.__processTableBorderStyle()):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=TableBorderStyle] Resolving symbols from object failed with error: "+TcHmi.Log.buildMessage(data.details))},this.__onResolverForRowNumbersCellPaddingWatchCallback=data=>{!1===this.__isAttached&&this.__suspendObjectResolver("rowNumbersCellPadding"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__rowNumbersCellPadding)||(this.__rowNumbersCellPadding=data.value,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersCellPadding"}),this.__processRowNumbersCellPadding()):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=RowNumbersCellPadding] Resolving symbols from object failed with error: "+TcHmi.Log.buildMessage(data.details))},this.__onResolverForCellContentPaddingWatchCallback=data=>{!1===this.__isAttached&&this.__suspendObjectResolver("cellContentPadding"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__cellContentPadding)||(this.__cellContentPadding=data.value,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"CellContentPadding"}),this.__processCellContentPadding()):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=CellContentPadding] Resolving symbols from object failed with error: "+TcHmi.Log.buildMessage(data.details))},this.__onResolverForHeaderBackgroundColorWatchCallback=data=>{!1===this.__isAttached&&this.__suspendObjectResolver("headerBackgroundColor"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__headerBackgroundColor)||(this.__headerBackgroundColor=data.value,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderBackgroundColor"}),this.__processHeaderBackgroundColor()):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=HeaderBackgroundColor] Resolving symbols from object failed with error: "+TcHmi.Log.buildMessage(data.details))},this.__onResolverForHeaderTextColorWatchCallback=data=>{!1===this.__isAttached&&this.__suspendObjectResolver("headerTextColor"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__headerTextColor)||(this.__headerTextColor=data.value,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderTextColor"}),this.__processHeaderTextColor()):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=HeaderTextColor] Resolving symbols from object failed with error: "+TcHmi.Log.buildMessage(data.details))},this.__onResolverForRowNumbersTextColorWatchCallback=data=>{!1===this.__isAttached&&this.__suspendObjectResolver("rowNumbersTextColor"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__rowNumbersTextColor)||(this.__rowNumbersTextColor=data.value,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersTextColor"}),this.__processRowNumbersTextColor()):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=RowNumbersTextColor] Resolving symbols from object failed with error: "+TcHmi.Log.buildMessage(data.details))},this.__onResolverForRowNumbersBackgroundColorWatchCallback=data=>{!1===this.__isAttached&&this.__suspendObjectResolver("rowNumbersBackgroundColor"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__rowNumbersBackgroundColor)||(this.__rowNumbersBackgroundColor=data.value,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersBackgroundColor"}),this.__processRowNumbersBackgroundColor()):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+", Attribute=RowNumbersBackgroundColor] Resolving symbols from object failed with error: "+TcHmi.Log.buildMessage(data.details))}}__previnit(){if(this.__elementTemplateRoot=this.__element.find(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template"),0===this.__elementTemplateRoot.length&&(this.__elementTemplateRoot=this.__element.find(".tchmi-datagrid-template")),this.__elementOuter=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-outer"),0===this.__elementOuter.length&&(this.__elementOuter=this.__elementTemplateRoot.find(".tchmi-datagrid-template-outer")),this.__elementHeaderScroll=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-border"),0===this.__elementHeaderScroll.length&&(this.__elementHeaderScroll=this.__elementTemplateRoot.find(".tchmi-datagrid-template-header-border")),this.__elementHeaderTable=this.__elementHeaderScroll.find("table"),this.__elementDataScroll=this.__elementTemplateRoot.find(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-data-scroll"),0===this.__elementDataScroll.length&&(this.__elementDataScroll=this.__elementTemplateRoot.find(".tchmi-datagrid-template-data-scroll")),this.__elementDataTableBody=this.__elementDataScroll.find("table tbody"),0===this.__elementTemplateRoot.length||0===this.__elementOuter.length||0===this.__elementHeaderScroll.length||0===this.__elementHeaderTable.length||0===this.__elementDataScroll.length||0===this.__elementDataTableBody.length)throw new Error("Invalid Template.html");super.__previnit()}__init(){super.__init(),this.__initStorage();const passiveEventOptions={passive:!0,capture:!1};this.__elementHeaderTable[0].addEventListener("mousedown",this.__onColumnMouseDown),this.__elementHeaderTable[0].addEventListener("dblclick",this.__onColumnMouseDblClick),this.__elementHeaderTable[0].addEventListener("click",this.__onSortClick),this.__elementHeaderTable[0].addEventListener("touchstart",this.__onSortTouchStart,passiveEventOptions),this.__elementHeaderTable[0].addEventListener("touchmove",this.__onSortTouchMove,passiveEventOptions),this.__elementHeaderTable[0].addEventListener("touchend",this.__onSortTouchEnd),this.__elementHeaderTable[0].addEventListener("touchcancel",this.__onSortTouchCancel),this.__elementDataScroll[0].addEventListener("scroll",this.__onScroll,passiveEventOptions),this.__elementDataScroll[0].addEventListener("click",this.__onEmptyAreaClick),this.__elementDataTableBody[0].addEventListener("mousedown",this.__onCheckboxMouseDown),this.__elementDataTableBody[0].addEventListener("change",this.__onValueChange),this.__elementDataTableBody[0].addEventListener("focusin",this.__onFocusElement),this.__elementDataTableBody[0].addEventListener("focusout",this.__onFocusElementOut),this.__elementDataTableBody[0].addEventListener("keydown",this.__onKeydown),this.__elementDataTableBody[0].addEventListener("input",this.__onInput),this.__elementDataTableBody[0].addEventListener("mousedown",this.__onMousedown),this.__elementDataTableBody[0].addEventListener("mousedown",this.__onButtonMousedown),this.__elementDataTableBody[0].addEventListener("touchstart",this.__onButtonTouchstart)}__attach(){super.__attach(),document.addEventListener("mouseup",this.__onColumnMouseUp),document.addEventListener("mousemove",this.__onColumnMouseMove),document.addEventListener("click",this.__onItemClick),document.addEventListener("mouseup",this.__onButtonMouseup),document.addEventListener("touchend",this.__onButtonTouchend),this.__resizedEventDestroyEvent=TcHmi.EventProvider.register(this.__id+".onResized",this.__onResized());let columnWidths=this.__getStoredValue("columnWidths");if(columnWidths)for(let i=0,ii=Math.min(columnWidths.length,this.__columnWidths.length);i<ii;i++)this.__columnWidths[i].width=columnWidths[i];this.__recalcAllColumnWidths();let sorting=this.__getStoredValue("sorting");sorting&&(this.__internalSorting=sorting,this.__processSorting()),sorting&&this.__pagingInfo.usePaging||this.__processDataSymbol(),this.__updateTable(1)}__detach(){var _a,_b,_c,_d,_e;super.__detach(),document.removeEventListener("mouseup",this.__onColumnMouseUp),document.removeEventListener("mousemove",this.__onColumnMouseMove),document.removeEventListener("click",this.__onItemClick),document.removeEventListener("mouseup",this.__onButtonMouseup),document.removeEventListener("touchend",this.__onButtonTouchend),this.__selectedCombobox=null,null===(_a=this.__resizedEventDestroyEvent)||void 0===_a||_a.call(this),this.__resizedEventDestroyEvent=null,null===(_b=this.__timePickerConfirmedEventDestroyer)||void 0===_b||_b.call(this),this.__timePickerConfirmedEventDestroyer=null,null===(_c=this.__timePickerCanceledEventDestroyer)||void 0===_c||_c.call(this),this.__timePickerCanceledEventDestroyer=null,null===(_d=this.__buttonLeaveDestroyer)||void 0===_d||_d.call(this),this.__buttonLeaveDestroyer=null,null===(_e=this.__buttonEnterDestroyer)||void 0===_e||_e.call(this),this.__buttonEnterDestroyer=null,this.__processDataSymbol(!0)}destroy(){var _a,_b;if(this.__keepAlive)return;null===(_a=this.__dateTimePickerInstance)||void 0===_a||_a.destroy(),this.__dateTimePickerInstance=void 0,null===(_b=this.__timespanPickerInstance)||void 0===_b||_b.destroy(),this.__timespanPickerInstance=void 0;const passiveEventOptions={passive:!0,capture:!1};this.__elementHeaderTable[0].removeEventListener("mousedown",this.__onColumnMouseDown),this.__elementHeaderTable[0].removeEventListener("dblclick",this.__onColumnMouseDblClick),this.__elementHeaderTable[0].removeEventListener("click",this.__onSortClick),this.__elementHeaderTable[0].removeEventListener("touchstart",this.__onSortTouchStart,passiveEventOptions),this.__elementHeaderTable[0].removeEventListener("touchmove",this.__onSortTouchMove,passiveEventOptions),this.__elementHeaderTable[0].removeEventListener("touchend",this.__onSortTouchEnd),this.__elementHeaderTable[0].removeEventListener("touchcancel",this.__onSortTouchCancel),this.__elementDataScroll[0].removeEventListener("scroll",this.__onScroll,passiveEventOptions),this.__elementDataScroll[0].removeEventListener("click",this.__onEmptyAreaClick),this.__elementDataTableBody[0].removeEventListener("mousedown",this.__onCheckboxMouseDown),this.__elementDataTableBody[0].removeEventListener("change",this.__onValueChange),this.__elementDataTableBody[0].removeEventListener("focusin",this.__onFocusElement),this.__elementDataTableBody[0].removeEventListener("focusout",this.__onFocusElementOut),this.__elementDataTableBody[0].removeEventListener("keydown",this.__onKeydown),this.__elementDataTableBody[0].removeEventListener("input",this.__onInput),this.__elementDataTableBody[0].removeEventListener("mousedown",this.__onMousedown),super.destroy()}__recalcRowCount(){if(!this.getRenderedHeight())return;let rowCount=0;this.__rowHeight&&(rowCount=Math.ceil(this.__elementDataScroll[0].clientHeight/this.__rowHeight)),this.__scrollInfo.rowCount!==rowCount&&(this.__scrollInfo.rowCount=rowCount,this.__pagingInfo.usePaging&&this.__updatePaging(!0),this.__updateTable(2),this.__updateSentinels())}__onResized(){return(evt,ctrl)=>{this.__recalcRowCount(),this.__recalcAllColumnWidths(),this.__selectedCombobox&&this.__resizeDropdownBoxCb()}}__recalcAllColumnWidths(force=!1){if(!this.__isAttached)return;let elementWidth=this.__element[0].clientWidth;function percentToPixel(value){return elementWidth*(.01*value)}let remainder=0;if(elementWidth>0)for(let columnIndex=0,ii=this.__columnWidths.length;columnIndex<ii;columnIndex++){let width=this.__columnWidths[columnIndex],minWidth=width.minWidth;elementWidth<=0?minWidth=0:"%"===width.widthUnit&&"px"===width.minWidthUnit?minWidth=minWidth/elementWidth*100:"px"===width.widthUnit&&"%"===width.minWidthUnit&&(minWidth=percentToPixel(minWidth));let newWidth=width.width<minWidth?minWidth:width.width,pixelWidth="%"===width.widthUnit?percentToPixel(newWidth):newWidth,flooredPixelWidth=Math.floor(pixelWidth);if(remainder+=pixelWidth-flooredPixelWidth,remainder>=1&&(flooredPixelWidth++,remainder--),0===columnIndex&&this.__showRowNumbers&&(elementWidth-=flooredPixelWidth),width.pixelWidth!==flooredPixelWidth||force){width.pixelWidth=flooredPixelWidth;const newCss={"min-width":width.pixelWidth+"px","max-width":width.pixelWidth+"px"};TcHmi.StyleProvider.setSimpleElementStyle(this.__elementHeaderScroll[0].querySelectorAll(`th:nth-child(${columnIndex+1})`),newCss),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementDataScroll[0].querySelectorAll(`td:nth-child(${columnIndex+1})`),newCss)}}this.__setCheckboxRadioButtonSize(),"Content"===this.getWidthMode()&&this.__processWidth()}__setCheckboxRadioButtonSize(){let checkboxes=this.__elementDataTableBody[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row td input[type=checkbox] + label");for(let i=0,ii=checkboxes.length;i<ii;i++){let columnIndex=checkboxes[i].parentElement.cellIndex;if(columnIndex>=this.__columnWidths.length)continue;let size=Math.min(this.__rowHeight||0,this.__columnWidths[columnIndex].pixelWidth)-(this.__tableBorderWidth||0),column=this.__internalSrcColumn[columnIndex-1];TcHmiDatagrid.isSimpleColumn(column)||"ToggleSwitch"!==column.control?(checkboxes[i].style.width=size+"px",checkboxes[i].style.height=size+"px"):(size>(this.__columnWidths[columnIndex].pixelWidth-(this.__tableBorderWidth||0))/2&&(size=(this.__columnWidths[columnIndex].pixelWidth-(this.__tableBorderWidth||0))/2),checkboxes[i].style.width=2*size+"px",checkboxes[i].style.height=size+"px",checkboxes[i].style.borderRadius=size/2+"px")}let radiobuttons=this.__elementDataTableBody[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row td input[type=radio] + label");for(let i=0,ii=radiobuttons.length;i<ii;i++){let columnIndex=radiobuttons[i].parentElement.cellIndex;if(columnIndex>=this.__columnWidths.length)continue;let size=Math.min(this.__rowHeight||0,this.__columnWidths[columnIndex].pixelWidth)-(this.__tableBorderWidth||0);radiobuttons[i].style.width=size+"px",radiobuttons[i].style.height=size+"px",radiobuttons[i].style.borderRadius=size/2+"px"}}__buildHeader(){let headerRow=this.__elementHeaderTable.find("tr");headerRow.find("th[data-column]").remove();let fragment=document.createDocumentFragment();for(let i=0,ii=this.__internalSrcColumn.length;i<ii;i++){let name="",internalColumn=this.__internalSrcColumn[i];TcHmiDatagrid.isSimpleColumn(internalColumn)||(name=internalColumn.name);let headerCell=document.createElement("th");headerCell.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header","tchmi-datagrid-template-header","tchmi-box"),headerCell.dataset.column=i.toString(10),headerCell.dataset.name=name,this.__internalSrcColumn[i].resize&&headerCell.classList.add("resizable");let pixelWidth=this.__columnWidths[i+1].pixelWidth;TcHmi.StyleProvider.setSimpleElementStyle(headerCell,{"min-width":pixelWidth+"px","max-width":pixelWidth+"px"}),TcHmi.StyleProvider.processContentPadding(headerCell,this.__headerCellPadding),TcHmi.StyleProvider.processBorderWidth(headerCell,{right:this.__tableBorderWidth}),TcHmi.StyleProvider.processBorderStyle(headerCell,this.__tableBorderStyle),TcHmi.StyleProvider.processBorderColor(headerCell,this.__tableBorderColor),TcHmi.StyleProvider.processBackgroundColor(headerCell,this.__headerBackgroundColor),TcHmi.StyleProvider.processTextColor(headerCell,this.__headerTextColor),TcHmi.StyleProvider.processFontFamily(headerCell,this.__headerFontFamily),TcHmi.StyleProvider.processFontSize(headerCell,this.__headerFontSize,this.__headerFontSizeUnit),TcHmi.StyleProvider.processFontStyle(headerCell,this.__headerFontStyle),TcHmi.StyleProvider.processFontWeight(headerCell,this.__headerFontWeight);let wrapper=document.createElement("div");wrapper.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-wrapper","tchmi-datagrid-template-header-wrapper");let sortElement=document.createElement("div");switch(sortElement.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-sort-element","tchmi-datagrid-template-sort-element"),internalColumn.headerHorizontalAlignment){case"Left":sortElement.style.justifyContent="flex-start";break;case"Right":sortElement.style.justifyContent="flex-end";break;case"Center":default:sortElement.style.justifyContent="center"}switch(internalColumn.headerVerticalAlignment){case"Top":sortElement.style.alignItems="flex-start";break;case"Bottom":sortElement.style.alignItems="flex-end";break;case"Center":default:sortElement.style.alignItems="center"}internalColumn.sortable&&sortElement.classList.add("sortable");let sortElementChild=document.createElement("div");sortElementChild.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-sort-element-child","tchmi-datagrid-template-sort-element-child"),sortElementChild.textContent=tchmi_decode_control_characters(this.__internalSrcColumn[i].label);for(let j=0,jj=this.__internalSorting.length;j<jj;j++)if(this.__internalSorting[j].name===name){switch(this.__internalSorting[j].order){case"Ascending":sortElementChild.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-sort-asc","tchmi-datagrid-template-header-sort-asc");break;case"Descending":sortElementChild.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-sort-desc","Ttchmi-datagrid-template-header-sort-desc")}break}let resizeElement=document.createElement("div");resizeElement.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-resize-element","tchmi-datagrid-template-resize-element"),this.__tableBorderWidth&&this.__tableBorderWidth>this.__resizeElementMinWidth&&TcHmi.StyleProvider.setSimpleElementStyle(resizeElement,{width:this.__tableBorderWidth+"px",right:-this.__tableBorderWidth+"px"}),sortElement.appendChild(sortElementChild),wrapper.appendChild(sortElement),wrapper.appendChild(resizeElement),headerCell.appendChild(wrapper),fragment.appendChild(headerCell)}headerRow[0].appendChild(fragment)}__updateTable(updateType){if(!this.__srcData||!this.__rowNumbersHorizontalAlignment||!this.__rowNumbersVerticalAlignment||void 0===this.__rowHeight||void 0===this.__showRowNumbers)return;let sort=!this.__pagingInfo.usePaging&&this.__filterSortMap,start=this.__scrollInfo.firstIndex-this.__scrollInfo.buffer;start=start>0?start:0;let end=this.__scrollInfo.firstIndex+this.__scrollInfo.rowCount+this.__scrollInfo.buffer;end=end<=this.__dataLength?end:this.__dataLength;let tableBody=this.__elementDataTableBody[0];switch(updateType){case 0:let containsHiddenRow=!1;if(this.__lockState){let lockedDataIndex=this.__originalIndexToSrcDataIndex(this.__lockState.row),lockedRowNumber=sort?this.__filterSortMap.indexOf(lockedDataIndex):lockedDataIndex;if(-1===lockedRowNumber)this.__lockState.rowElement.classList.add("hidden"),containsHiddenRow=!0;else if(lockedRowNumber<start)this.__lockState.rowElement.classList.add("hidden"),containsHiddenRow=!0,this.__createRow(lockedDataIndex,lockedRowNumber,this.__lockState.rowElement,this.__lockState.column);else if(lockedRowNumber>=end)this.__lockState.rowElement.classList.add("hidden"),containsHiddenRow=!0,this.__createRow(lockedDataIndex,lockedRowNumber,this.__lockState.rowElement,this.__lockState.column);else{let positionDifference=lockedRowNumber-start-this.__lockState.rowElement.rowIndex;if(0!==positionDifference){let referenceElement=this.__lockState.rowElement,elementsToSkip=[];if(positionDifference>0){for(let i=0;i<positionDifference&&referenceElement.nextElementSibling;i++)referenceElement=referenceElement.nextElementSibling,elementsToSkip.push(referenceElement);this.__lockState.rowElement.before(...elementsToSkip)}else{for(let i=0;i<-positionDifference&&referenceElement.previousElementSibling;i++)referenceElement=referenceElement.previousElementSibling,elementsToSkip.push(referenceElement);this.__lockState.rowElement.after(...elementsToSkip)}}this.__lockState.rowElement.classList.remove("hidden")}}let rowsToAdd=null,rowCounter=0;for(let i=start;i<end;i++&rowCounter++){let index=sort?this.__filterSortMap[i]:i,existingRow=tableBody.children[rowCounter];existingRow&&existingRow.classList.contains("hidden")&&(existingRow=tableBody.children[++rowCounter]),existingRow?this.__createRow(index,i,existingRow,this.__lockState&&this.__originalIndexToSrcDataIndex(this.__lockState.row)===index?this.__lockState.column:void 0):(rowsToAdd||(rowsToAdd=document.createDocumentFragment()),rowsToAdd.appendChild(this.__createRow(index,i)))}for(rowsToAdd&&tableBody.appendChild(rowsToAdd);tableBody.childElementCount>(containsHiddenRow?rowCounter+1:rowCounter);){let row=tableBody.lastElementChild;if(this.__lockState&&row===this.__lockState.rowElement){if(!row.classList.contains("hidden")){row.classList.add("hidden");continue}row=row.previousElementSibling}if(!row)break;tableBody.removeChild(row)}break;case 1:this.__lockState&&this.__unlock();let fragment=document.createDocumentFragment();for(let i=start;i<end;i++){let index=sort?this.__filterSortMap[i]:i;fragment.appendChild(this.__createRow(index,i))}for(;tableBody.lastChild;)tableBody.removeChild(tableBody.lastChild);tableBody.appendChild(fragment);break;case 2:let oldStart=this.__scrollInfo.oldFirstIndex-this.__scrollInfo.buffer;oldStart=oldStart>0?oldStart:0;let oldEnd=this.__scrollInfo.oldFirstIndex+this.__scrollInfo.oldRowCount+this.__scrollInfo.buffer;oldEnd=oldEnd<=this.__dataLength?oldEnd:this.__dataLength;let discardedRows=[],rowOffset=0;for(let i=oldStart;i<start;i++){let row=tableBody.children[rowOffset];if(!row)break;if(this.__lockState&&row===this.__lockState.rowElement){if(rowOffset=1,!row.classList.contains("hidden")){row.classList.add("hidden");continue}if(row=row.nextElementSibling,!row)break}discardedRows.push(tableBody.removeChild(row))}rowOffset=0;for(let i=oldEnd-1;i>=end;i--){let row=tableBody.children[tableBody.childElementCount-(rowOffset+1)];if(!row)break;if(this.__lockState&&row===this.__lockState.rowElement){if(rowOffset=1,!row.classList.contains("hidden")){row.classList.add("hidden");continue}if(row=row.previousElementSibling,!row)break}discardedRows.push(tableBody.removeChild(row))}let bottomFragment=document.createDocumentFragment(),bottomFragmentStart=Math.max(oldEnd,start);for(let i=bottomFragmentStart;i<end;i++){let index=sort?this.__filterSortMap[i]:i;bottomFragment.appendChild(this.__createRow(index,i,discardedRows.pop()))}let topFragment=document.createDocumentFragment(),topFragmentStart=Math.min(oldStart-1,end-1);for(let i=topFragmentStart;i>=start;i--){let index=sort?this.__filterSortMap[i]:i;topFragment.insertBefore(this.__createRow(index,i,discardedRows.pop()),topFragment.firstChild)}if(this.__lockState){let lockedRowNumber=sort?this.__filterSortMap.indexOf(this.__originalIndexToSrcDataIndex(this.__lockState.row)):this.__originalIndexToSrcDataIndex(this.__lockState.row);if(lockedRowNumber<start)this.__elementDataTableBody.children().first().after(topFragment),this.__elementDataTableBody.append(bottomFragment);else if(lockedRowNumber>=end)this.__elementDataTableBody.prepend(topFragment),this.__elementDataTableBody.children().last().before(bottomFragment);else{let lockedRowIndexInTopFragment=lockedRowNumber-(topFragmentStart-(topFragment.childNodes.length-1));lockedRowIndexInTopFragment>=0&&lockedRowIndexInTopFragment<topFragment.childNodes.length?(this.__elementDataTableBody.children().first().removeClass("hidden").after(Array.prototype.slice.call(topFragment.childNodes,lockedRowIndexInTopFragment+1)),this.__elementDataTableBody.prepend(Array.prototype.slice.call(topFragment.childNodes,0,lockedRowIndexInTopFragment))):this.__elementDataTableBody.prepend(topFragment);let lockedRowIndexInBottomFragment=lockedRowNumber-bottomFragmentStart;lockedRowIndexInBottomFragment>=0&&lockedRowIndexInBottomFragment<bottomFragment.childNodes.length?(this.__elementDataTableBody.children().last().removeClass("hidden").before(Array.prototype.slice.call(bottomFragment.childNodes,0,lockedRowIndexInBottomFragment)),this.__elementDataTableBody.append(Array.prototype.slice.call(bottomFragment.childNodes,1))):this.__elementDataTableBody.append(bottomFragment)}}else this.__elementDataTableBody.prepend(topFragment),this.__elementDataTableBody.append(bottomFragment)}this.__scrollInfo.oldFirstIndex=this.__scrollInfo.firstIndex,this.__scrollInfo.oldRowCount=this.__scrollInfo.rowCount}__openCombobox(cell){if(!this.__srcData)return;let columnIndex=parseInt(cell.dataset.column||"",10),column=this.__internalSrcColumn[columnIndex],row=parseInt(cell.dataset.row||"",10);if(!column||!column.editable||isNaN(columnIndex)||isNaN(row))return;let rowElement=cell.parentElement;if(!(rowElement instanceof HTMLTableRowElement))return;let combobox=cell.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template")[0],dropdown=this.__comboboxDropdowns[JSON.stringify(column.dataDefinitions)];if(!combobox||!dropdown)return;let unpagedRow=row;if(row=this.__srcDataIndexToOriginalIndex(row),-1===row)return;this.__lock(row,columnIndex,rowElement);let value=this.__srcData[unpagedRow];TcHmiDatagrid.isSimpleColumn(column)||(value=this.__readObjectProperty(value,column.name));for(let i=0,ii=dropdown.children.length;i<ii;i++){let item=dropdown.children[i];tchmi_equal(item.dataset.value,value,!1)?item.classList.add("selected"):item.classList.remove("selected")}combobox.classList.add("active");let topMostLayerOptions={removeCb:data=>{document.removeEventListener("scroll",this.__resizeDropdownBoxCb,{capture:!0}),null!==this.__movedEventDestroyEvent&&(this.__movedEventDestroyEvent(),this.__movedEventDestroyEvent=null),combobox.classList.remove("active"),this.__selectedCombobox=null,this.__unlock()}};dropdown.classList.remove("drop-down-style-mobile"),topMostLayerOptions.dimBackground=!1,topMostLayerOptions.resizeCb=this.__resizeDropdownBoxCb,document.addEventListener("scroll",this.__resizeDropdownBoxCb,{capture:!0,passive:!0}),this.__movedEventDestroyEvent=TcHmi.EventProvider.register(this.__id+".onMoved",this.__resizeDropdownBoxCb),this.__selectedCombobox={cell:cell,column:column,row:unpagedRow,combobox:combobox,dropdown:dropdown},TcHmi.TopMostLayer.add(this,$(dropdown),topMostLayerOptions)}__closeCombobox(){this.__selectedCombobox&&TcHmi.TopMostLayer.remove(this,$(this.__comboboxDropdowns[JSON.stringify(this.__selectedCombobox.column.dataDefinitions)]))}__createRow(dataIndex,row,rowToRecycle,lockedCell){var _a;if(!this.__srcData)throw new Error("Unable to create row without srcData");let oldDataIndex=-1;if(rowToRecycle&&(oldDataIndex=parseInt(rowToRecycle.dataset.row||"",10),oldDataIndex===dataIndex&&this.__oldSrcData&&tchmi_equal(this.__oldSrcData[oldDataIndex],this.__srcData[dataIndex])))return rowToRecycle;let elementRow=rowToRecycle||document.createElement("tr");elementRow.setAttribute("data-row",dataIndex.toString(10)),this.__setRowClasses(elementRow,dataIndex);for(let i=-1,ii=this.__internalSrcColumn.length;i<ii;i++){if(i===lockedCell)continue;let value,elementCell;if(-1!==i){let internalColumn=this.__internalSrcColumn[i];if(TcHmiDatagrid.isSimpleColumn(internalColumn)){if(value=this.__srcData[dataIndex],oldDataIndex===dataIndex&&this.__oldSrcData&&tchmi_equal(this.__oldSrcData[oldDataIndex],value))continue}else if(value=this.__readObjectProperty(this.__srcData[dataIndex],internalColumn.name),oldDataIndex===dataIndex&&this.__oldSrcData&&tchmi_equal(this.__readObjectProperty(this.__oldSrcData[oldDataIndex],internalColumn.name),value))continue}if(rowToRecycle?elementCell=elementRow.getElementsByTagName("td")[i+1]:(elementCell=document.createElement("td"),elementRow.appendChild(elementCell)),elementCell.setAttribute("data-row",dataIndex.toString()),!rowToRecycle){let pixelWidth=this.__columnWidths[i+1].pixelWidth,newCss={"min-width":pixelWidth+"px","max-width":pixelWidth+"px",height:this.__rowHeight+"px"};if(-1===i){switch(elementCell.setAttribute("class","TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers tchmi-datagrid-template-row-numbers tchmi-box"),newCss.display=this.__showRowNumbers?"":"none",this.__rowNumbersHorizontalAlignment){case"Left":newCss["justify-content"]="flex-start";break;case"Right":newCss["justify-content"]="flex-end";break;case"Center":default:newCss["justify-content"]="center"}switch(this.__rowNumbersVerticalAlignment){case"Top":newCss["align-items"]="flex-start";break;case"Bottom":newCss["align-items"]="flex-end";break;case"Center":default:newCss["align-items"]="center"}TcHmi.StyleProvider.processContentPadding(elementCell,this.__rowNumbersCellPadding),TcHmi.StyleProvider.processTextColor(elementCell,this.__rowNumbersTextColor),TcHmi.StyleProvider.processBackgroundColor(elementCell,this.__rowNumbersBackgroundColor),TcHmi.StyleProvider.processFontFamily(elementCell,this.__rowNumbersFontFamily),TcHmi.StyleProvider.processFontSize(elementCell,this.__rowNumbersFontSize,this.__rowNumbersFontSizeUnit),TcHmi.StyleProvider.processFontStyle(elementCell,this.__rowNumbersFontStyle),TcHmi.StyleProvider.processFontWeight(elementCell,this.__rowNumbersFontWeight)}else{elementCell.setAttribute("class","TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell tchmi-datagrid-template-cell tchmi-box"),elementCell.setAttribute("data-column",i.toString());let internalColumn=this.__internalSrcColumn[i];switch(TcHmiDatagrid.isSimpleColumn(internalColumn)||elementCell.setAttribute("data-column-name",internalColumn.name),internalColumn.horizontalAlignment){case"Left":newCss["justify-content"]="flex-start";break;case"Center":newCss["justify-content"]="center";break;case"Right":newCss["justify-content"]="flex-end";break;default:newCss["justify-content"]=""}switch(internalColumn.verticalAlignment){case"Top":newCss["align-items"]="flex-start";break;case"Center":newCss["align-items"]="center";break;case"Bottom":newCss["align-items"]="flex-end";break;default:newCss["align-items"]=""}TcHmi.StyleProvider.processTextColor(elementCell,internalColumn.textColor),TcHmi.StyleProvider.processBackgroundColor(elementCell,internalColumn.cellBackground),TcHmi.StyleProvider.processFontFamily(elementCell,this.__gridFontFamily),TcHmi.StyleProvider.processFontSize(elementCell,this.__gridFontSize,this.__gridFontSizeUnit),TcHmi.StyleProvider.processFontStyle(elementCell,this.__gridFontStyle),TcHmi.StyleProvider.processFontWeight(elementCell,this.__gridFontWeight)}elementCell.setAttribute("tabindex","0"),elementCell.setAttribute("data-tchmi-focusable",""),TcHmi.StyleProvider.setSimpleElementStyle(elementCell,newCss),TcHmi.StyleProvider.processBorderWidth(elementCell,{right:this.__tableBorderWidth,rightUnit:"px",bottom:this.__tableBorderWidth,bottomUnit:"px",top:0,left:0}),TcHmi.StyleProvider.processBorderStyle(elementCell,this.__tableBorderStyle),TcHmi.StyleProvider.processBorderColor(elementCell,this.__tableBorderColor)}if(this.__selectedCell&&this.__selectedCell.columnIndex===i?elementCell.classList.add("focused"):elementCell.classList.remove("focused"),-1!==i){let internalColumn=this.__internalSrcColumn[i];this.__fillCell(elementCell,internalColumn,value),rowToRecycle||elementCell.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control")||elementCell.classList.contains("tchmi-datagrid-template-cell-unpadded-control")||TcHmi.StyleProvider.processContentPadding(elementCell,this.__cellContentPadding)}else{let rowIndex=row+(null!==(_a=this.__rowNumbersStartNumber)&&void 0!==_a?_a:1);elementCell.firstChild?elementCell.firstChild.nodeValue=rowIndex.toString():elementCell.textContent=rowIndex.toString()}}return elementRow}__fillCell(elementCell,internalColumn,value){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m;switch(internalColumn.control){case"CheckBox":let checkbox=elementCell.getElementsByTagName("input")[0],label=elementCell.getElementsByTagName("label")[0];if(!checkbox||!label){checkbox=document.createElement("input"),checkbox.setAttribute("type","checkbox");const newIdCB="checkbox-"+tchmi_create_guid();checkbox.setAttribute("id",newIdCB),label=document.createElement("label"),label.setAttribute("for",newIdCB);let size=Math.min(this.__rowHeight||0,this.__columnWidths[elementCell.cellIndex].pixelWidth)-(this.__tableBorderWidth||0);TcHmi.StyleProvider.setSimpleElementStyle(label,{height:size+"px",width:size+"px"}),elementCell.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control","tchmi-datagrid-template-cell-unpadded-control"),elementCell.textContent="",elementCell.appendChild(checkbox),elementCell.appendChild(label)}checkbox.disabled=!internalColumn.editable,checkbox.checked=TcHmi.ValueConverter.toBoolean(value,!1);break;case"TextBox":let input=elementCell.getElementsByTagName("input")[0];input||(input=document.createElement("input"),input.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-textbox"),input.setAttribute("type","text"),TcHmi.StyleProvider.processContentPadding(input,this.__cellContentPadding),elementCell.textContent="",elementCell.appendChild(input),elementCell.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control","tchmi-datagrid-template-cell-unpadded-control")),TcHmi.StyleProvider.processBackgroundColor(input,internalColumn.cellBackground),TcHmi.StyleProvider.processTextColor(input,internalColumn.textColor),input.style.textAlign=(null!==(_a=internalColumn.horizontalAlignment)&&void 0!==_a?_a:"").toLowerCase(),input.disabled=!internalColumn.editable;let textboxText=this.__executeFormatFunction(internalColumn.format,value);input.value=(null!=textboxText?textboxText:"").toString().replace(/(?:\r\n|\\r|\\n)/g," ");break;case"TextBlock":let textblockText=null!==(_b=this.__executeFormatFunction(internalColumn.format,value))&&void 0!==_b?_b:"";elementCell.firstChild?elementCell.firstChild.nodeValue=tchmi_decode_control_characters(textblockText):elementCell.textContent=tchmi_decode_control_characters(textblockText);break;case"Image":let image=elementCell.getElementsByTagName("img")[0];image||(image=document.createElement("img"),elementCell.appendChild(image));let imageDef=null;internalColumn.dataDefinitions&&Array.isArray(internalColumn.dataDefinitions)&&(imageDef=internalColumn.dataDefinitions.filter(dataDef=>tchmi_equal(dataDef.value,value))[0]),image.setAttribute("src",imageDef&&imageDef.source||""),image.setAttribute("alt",imageDef&&imageDef.text||""),image.style.width=imageDef&&void 0!==imageDef.width&&null!==imageDef.width?imageDef.width+"px":"",image.style.height=imageDef&&void 0!==imageDef.height&&null!==imageDef.height?imageDef.height+"px":"";break;case"ComboBox":let divCombobox=elementCell.getElementsByTagName("div")[0],divSelect=elementCell.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-select")[0];if(!divCombobox||!divSelect){divCombobox=document.createElement("div"),divCombobox.setAttribute("class","TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template tchmi-datagrid-combobox-template tchmi-box"),divCombobox.setAttribute("tabindex","-1"),divSelect=document.createElement("div"),divSelect.setAttribute("class","TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-select tchmi-datagrid-combobox-template-select tchmi-box"),TcHmi.StyleProvider.processContentPadding(divSelect,this.__cellContentPadding);let svg=$('<svg class="TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-button tchmi-box" version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="30px" height="100%" viewBox="0 0 30 30" enable-background="new 0 0 30 30" xml:space="preserve"><polyline class="TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-button-arrow" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" points= "22.865,12.5 15,20.366 7.135,12.5" /></svg>')[0];divCombobox.appendChild(divSelect),divCombobox.appendChild(svg),elementCell.textContent="",elementCell.appendChild(divCombobox),elementCell.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control","tchmi-datagrid-template-cell-unpadded-control")}switch(internalColumn.horizontalAlignment){case"Left":divSelect.style.justifyContent="flex-start";break;case"Center":divSelect.style.justifyContent="center";break;case"Right":divSelect.style.justifyContent="flex-end";break;default:divSelect.style.justifyContent=""}switch(internalColumn.verticalAlignment){case"Top":divSelect.style.alignItems="flex-start";break;case"Center":divSelect.style.alignItems="center";break;case"Bottom":divSelect.style.alignItems="flex-end";break;default:divSelect.style.alignItems=""}let comboboxDef=null;internalColumn.dataDefinitions&&Array.isArray(internalColumn.dataDefinitions)&&(comboboxDef=internalColumn.dataDefinitions.filter(dataDef=>tchmi_equal(dataDef.value,value))[0]),divSelect.textContent=comboboxDef&&comboboxDef.text||"";break;case"PasswordInput":let passwordInput=elementCell.getElementsByTagName("input")[0];passwordInput||(passwordInput=document.createElement("input"),passwordInput.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-password-input"),passwordInput.setAttribute("type","password"),TcHmi.StyleProvider.processContentPadding(passwordInput,this.__cellContentPadding),elementCell.textContent="",elementCell.appendChild(passwordInput),elementCell.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control","tchmi-datagrid-template-cell-unpadded-control")),TcHmi.StyleProvider.processBackgroundColor(passwordInput,internalColumn.cellBackground),TcHmi.StyleProvider.processTextColor(passwordInput,internalColumn.textColor),passwordInput.style.textAlign=(null!==(_c=internalColumn.horizontalAlignment)&&void 0!==_c?_c:"").toLowerCase(),passwordInput.disabled=!internalColumn.editable;let passwordText=this.__executeFormatFunction(internalColumn.format,value);passwordInput.value=(null!=passwordText?passwordText:"").toString().replace(/(?:\r\n|\\r|\\n)/g," ");break;case"NumericInput":let numericInput=elementCell.getElementsByTagName("input")[0];numericInput||(numericInput=document.createElement("input"),numericInput.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-numeric-input"),numericInput.setAttribute("inputmode","decimal"),TcHmi.StyleProvider.processContentPadding(numericInput,this.__cellContentPadding),elementCell.textContent="",elementCell.appendChild(numericInput),elementCell.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control","tchmi-datagrid-template-cell-unpadded-control")),TcHmi.StyleProvider.processBackgroundColor(numericInput,internalColumn.cellBackground),TcHmi.StyleProvider.processTextColor(numericInput,internalColumn.textColor),numericInput.style.textAlign=(null!==(_d=internalColumn.horizontalAlignment)&&void 0!==_d?_d:"").toLowerCase(),numericInput.disabled=!internalColumn.editable;let numericValue=Number(value),valueString=null;isNaN(numericValue)&&(numericValue=internalColumn.dataDefinitions&&!Array.isArray(internalColumn.dataDefinitions)&&null!==(_f=null!==(_e=internalColumn.dataDefinitions.minValue)&&void 0!==_e?_e:internalColumn.dataDefinitions.maxValue)&&void 0!==_f?_f:0),internalColumn.dataDefinitions&&!Array.isArray(internalColumn.dataDefinitions)&&(void 0!==internalColumn.dataDefinitions.minValue&&numericValue<internalColumn.dataDefinitions.minValue&&(numericValue=internalColumn.dataDefinitions.minValue),void 0!==internalColumn.dataDefinitions.maxValue&&numericValue>internalColumn.dataDefinitions.maxValue&&(numericValue=internalColumn.dataDefinitions.maxValue),void 0!==internalColumn.dataDefinitions.decimalDigits&&(valueString=numericValue.toFixed(internalColumn.dataDefinitions.decimalDigits))),valueString||(valueString=numericValue.toString()),numericInput.value=valueString;break;case"SpinboxInput":let spinboxDiv=elementCell.getElementsByTagName("div")[0],spinboxInput=elementCell.getElementsByTagName("input")[0],spinboxButtonMinus=elementCell.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-spinbox-button")[0],spinboxButtonPlus=elementCell.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-spinbox-button")[1];spinboxDiv&&spinboxInput&&spinboxButtonMinus&&spinboxButtonPlus||(spinboxDiv=document.createElement("div"),spinboxDiv.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-spinbox-input"),spinboxDiv.style.gridTemplateColumns="var(--row-height) auto var(--row-height)",spinboxInput=document.createElement("input"),spinboxInput.setAttribute("inputmode","decimal"),spinboxInput.style.gridColumn="2",TcHmi.StyleProvider.processContentPadding(spinboxInput,this.__cellContentPadding),spinboxButtonMinus=document.createElement("div"),spinboxButtonMinus.textContent="-",spinboxButtonMinus.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-button","TcHmi_Controls_Beckhoff_TcHmiDatagrid-spinbox-button"),spinboxButtonMinus.style.gridColumn="1",spinboxButtonPlus=document.createElement("div"),spinboxButtonPlus.textContent="+",spinboxButtonPlus.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-button","TcHmi_Controls_Beckhoff_TcHmiDatagrid-spinbox-button"),spinboxButtonPlus.style.gridColumn="3",spinboxDiv.appendChild(spinboxButtonMinus),spinboxDiv.appendChild(spinboxInput),spinboxDiv.appendChild(spinboxButtonPlus),elementCell.textContent="",elementCell.appendChild(spinboxDiv),elementCell.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control","tchmi-datagrid-template-cell-unpadded-control")),TcHmi.StyleProvider.processBackgroundColor(spinboxInput,internalColumn.cellBackground),TcHmi.StyleProvider.processTextColor(spinboxInput,internalColumn.textColor),spinboxInput.style.textAlign=(null!==(_g=internalColumn.horizontalAlignment)&&void 0!==_g?_g:"").toLowerCase(),spinboxInput.disabled=!internalColumn.editable,spinboxButtonMinus.classList.toggle("TcHmi_Controls_Beckhoff_TcHmiDatagrid-button-disabled",!internalColumn.editable),spinboxButtonPlus.classList.toggle("TcHmi_Controls_Beckhoff_TcHmiDatagrid-button-disabled",!internalColumn.editable);let spinboxValue=Number(value),spinboxValueString=null;isNaN(spinboxValue)&&(spinboxValue=internalColumn.dataDefinitions&&!Array.isArray(internalColumn.dataDefinitions)&&null!==(_j=null!==(_h=internalColumn.dataDefinitions.minValue)&&void 0!==_h?_h:internalColumn.dataDefinitions.maxValue)&&void 0!==_j?_j:0),internalColumn.dataDefinitions&&!Array.isArray(internalColumn.dataDefinitions)&&(void 0!==internalColumn.dataDefinitions.minValue&&spinboxValue<internalColumn.dataDefinitions.minValue&&(spinboxValue=internalColumn.dataDefinitions.minValue),void 0!==internalColumn.dataDefinitions.maxValue&&spinboxValue>internalColumn.dataDefinitions.maxValue&&(spinboxValue=internalColumn.dataDefinitions.maxValue),void 0!==internalColumn.dataDefinitions.decimalDigits&&(spinboxValueString=spinboxValue.toFixed(internalColumn.dataDefinitions.decimalDigits))),spinboxValueString||(spinboxValueString=spinboxValue.toString()),spinboxInput.value=spinboxValueString;break;case"DateTimeInput":let dateTimeDiv=elementCell.getElementsByTagName("div")[0],dateTimeInput=elementCell.getElementsByTagName("input")[0],dateTimeButton=elementCell.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-date-time-button")[0];dateTimeDiv&&dateTimeInput&&dateTimeButton||(dateTimeDiv=document.createElement("div"),dateTimeDiv.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-date-time-input"),dateTimeDiv.style.gridTemplateColumns="auto var(--row-height)",dateTimeInput=document.createElement("input"),dateTimeInput.setAttribute("type","text"),TcHmi.StyleProvider.processContentPadding(dateTimeInput,this.__cellContentPadding),dateTimeButton=document.createElement("div"),dateTimeButton.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-button","TcHmi_Controls_Beckhoff_TcHmiDatagrid-date-time-button"),dateTimeButton.style.gridColumn="2",dateTimeDiv.appendChild(dateTimeInput),dateTimeDiv.appendChild(dateTimeButton),elementCell.textContent="",elementCell.appendChild(dateTimeDiv),elementCell.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control","tchmi-datagrid-template-cell-unpadded-control")),TcHmi.StyleProvider.processBackgroundColor(dateTimeInput,internalColumn.cellBackground),TcHmi.StyleProvider.processTextColor(dateTimeInput,internalColumn.textColor),dateTimeInput.style.textAlign=(null!==(_k=internalColumn.horizontalAlignment)&&void 0!==_k?_k:"").toLowerCase(),dateTimeInput.disabled=!internalColumn.editable,dateTimeButton.classList.toggle("TcHmi_Controls_Beckhoff_TcHmiDatagrid-button-disabled",!internalColumn.editable),this.__REGEX_ISO_8601_DATETIME.test(value)?dateTimeInput.value=value:dateTimeInput.value="";break;case"TimespanInput":let timespanDiv=elementCell.getElementsByTagName("div")[0],timespanInput=elementCell.getElementsByTagName("input")[0],timespanButton=elementCell.getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-timespan-button")[0];timespanDiv||(timespanDiv=document.createElement("div"),timespanDiv.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-timespan-input"),timespanDiv.style.gridTemplateColumns="auto var(--row-height)",timespanInput=document.createElement("input"),timespanInput.setAttribute("type","text"),TcHmi.StyleProvider.processContentPadding(timespanInput,this.__cellContentPadding),timespanButton=document.createElement("div"),timespanButton.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-button","TcHmi_Controls_Beckhoff_TcHmiDatagrid-timespan-button"),timespanButton.style.gridColumn="2",timespanDiv.appendChild(timespanInput),timespanDiv.appendChild(timespanButton),elementCell.appendChild(timespanDiv),elementCell.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control","tchmi-datagrid-template-cell-unpadded-control")),TcHmi.StyleProvider.processBackgroundColor(timespanInput,internalColumn.cellBackground),TcHmi.StyleProvider.processTextColor(timespanInput,internalColumn.textColor),timespanInput.style.textAlign=(null!==(_l=internalColumn.horizontalAlignment)&&void 0!==_l?_l:"").toLowerCase(),timespanInput.disabled=!internalColumn.editable,timespanButton.classList.toggle("TcHmi_Controls_Beckhoff_TcHmiDatagrid-button-disabled",!internalColumn.editable),this.__REGEX_ISO_8601_TIMESPAN.test(value)?timespanInput.value=value:timespanInput.value="";break;case"Button":case"ToggleButton":let button=elementCell.getElementsByTagName("div")[0];switch(button||(button=document.createElement("div"),"Button"===internalColumn.control&&button.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-button","TcHmi_Controls_Beckhoff_TcHmiDatagrid-simple-button"),"ToggleButton"===internalColumn.control&&button.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-button","TcHmi_Controls_Beckhoff_TcHmiDatagrid-toggle-button"),elementCell.textContent="",elementCell.appendChild(button),TcHmi.StyleProvider.processContentPadding(button,this.__cellContentPadding),elementCell.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control","tchmi-datagrid-template-cell-unpadded-control")),TcHmi.StyleProvider.processBackgroundColor(button,internalColumn.cellBackground),TcHmi.StyleProvider.processTextColor(button,internalColumn.textColor),internalColumn.horizontalAlignment){case"Left":button.style.justifyContent="flex-start";break;case"Center":button.style.justifyContent="center";break;case"Right":button.style.justifyContent="flex-end";break;default:button.style.justifyContent=""}switch(internalColumn.verticalAlignment){case"Top":button.style.alignItems="flex-start";break;case"Center":button.style.alignItems="center";break;case"Bottom":button.style.alignItems="flex-end";break;default:button.style.alignItems=""}button.classList.toggle("TcHmi_Controls_Beckhoff_TcHmiDatagrid-button-disabled",!internalColumn.editable);let buttonText="";internalColumn.dataDefinitions&&!Array.isArray(internalColumn.dataDefinitions)&&(buttonText=null!==(_m=internalColumn.dataDefinitions.text)&&void 0!==_m?_m:""),button.textContent=buttonText,button.classList.toggle("down",TcHmi.ValueConverter.toBoolean(value,!1));break;case"ToggleSwitch":let toggleSwitch=elementCell.getElementsByTagName("input")[0];if(!toggleSwitch){toggleSwitch=document.createElement("input"),toggleSwitch.setAttribute("type","checkbox"),toggleSwitch.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-toggle-switch");const newIdCB="toggleswitch-"+tchmi_create_guid();toggleSwitch.setAttribute("id",newIdCB);let label=document.createElement("label");label.setAttribute("for",newIdCB);let stateIndicator=document.createElement("div");label.appendChild(stateIndicator);let size=Math.min(this.__rowHeight||0,this.__columnWidths[elementCell.cellIndex].pixelWidth)-(this.__tableBorderWidth||0);size>(this.__columnWidths[elementCell.cellIndex].pixelWidth-(this.__tableBorderWidth||0))/2&&(size=(this.__columnWidths[elementCell.cellIndex].pixelWidth-(this.__tableBorderWidth||0))/2),TcHmi.StyleProvider.setSimpleElementStyle(label,{height:size+"px",width:2*size+"px"}),label.style.borderRadius=size/2+"px",elementCell.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control","tchmi-datagrid-template-cell-unpadded-control"),elementCell.textContent="",elementCell.appendChild(toggleSwitch),elementCell.appendChild(label)}toggleSwitch.disabled=!internalColumn.editable,toggleSwitch.checked=TcHmi.ValueConverter.toBoolean(value,!1);break;case"RadioButton":let radioButton=elementCell.getElementsByTagName("input")[0];if(!radioButton){radioButton=document.createElement("input"),radioButton.setAttribute("type","radio");const newIdCB="radio-"+tchmi_create_guid();radioButton.setAttribute("id",newIdCB);let label=document.createElement("label");label.setAttribute("for",newIdCB);let size=Math.min(this.__rowHeight||0,this.__columnWidths[elementCell.cellIndex].pixelWidth)-(this.__tableBorderWidth||0);TcHmi.StyleProvider.setSimpleElementStyle(label,{height:size+"px",width:size+"px"}),label.style.borderRadius=size/2+"px",elementCell.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control","tchmi-datagrid-template-cell-unpadded-control"),elementCell.textContent="",elementCell.appendChild(radioButton),elementCell.appendChild(label)}radioButton.disabled=!internalColumn.editable,radioButton.checked=TcHmi.ValueConverter.toBoolean(value,!1);break;default:void 0!==value?elementCell.innerHTML=value:elementCell.textContent=""}}__resizeColumn(columnIndex,newWidth,override=!1){(this.__columnWidths[columnIndex].resizable||override)&&(newWidth!==this.__columnWidths[columnIndex].width||override)&&(this.__columnWidths[columnIndex].width=newWidth,this.__recalcAllColumnWidths(override))}__modifySorting(sortElement,composing){let headerCell=sortElement;for(;headerCell&&!(headerCell instanceof HTMLTableCellElement);)headerCell=headerCell.parentElement;if(headerCell){if(headerCell.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers")||headerCell.classList.contains("tchmi-datagrid-template-row-numbers")){if(composing)return;this.__internalSorting=tchmi_clone_object(this.__sorting)||[],this.__lastRemovedSorting=null}else{if(!sortElement.classList.contains("sortable"))return;let sortName=void 0;TcHmiDatagrid.isSimpleColumn(this.__internalSrcColumn[0])||(sortName=headerCell.dataset.name);let existingItem=null;for(let i=0,ii=this.__internalSorting.length;i<ii;i++)if(this.__internalSorting[i].name===sortName){existingItem=this.__internalSorting[i];break}if(existingItem)switch(existingItem.order){case"Ascending":existingItem.order="Descending",composing||(this.__internalSorting=[existingItem]),this.__lastRemovedSorting=null;break;case"Descending":if(composing){let index=this.__internalSorting.indexOf(existingItem);this.__internalSorting.splice(index,1),this.__lastRemovedSorting={name:existingItem.name,position:index}}else this.__internalSorting=[],this.__lastRemovedSorting=null}else composing?this.__lastRemovedSorting&&this.__lastRemovedSorting.name===sortName?this.__internalSorting.splice(this.__lastRemovedSorting.position,0,{name:sortName,order:"Ascending"}):this.__internalSorting.push({name:sortName,order:"Ascending"}):this.__internalSorting=[{name:sortName,order:"Ascending"}],this.__lastRemovedSorting=null}TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"Sorting"}),this.__processSorting(),headerCell.classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers")?this.__removeStoredValue("sorting"):this.__setStoredValue("sorting",this.__internalSorting)}}__filterAndSort(){if(!this.__srcData||this.__pagingInfo.usePaging||0===this.__internalSorting.length&&!this.__filterInstance){this.__filterSortMap=null;let length=this.__srcData?this.__srcData.length:0;return void(length!==this.__dataLength&&(this.__dataLength=length,this.__updateSentinels(),"Content"===this.getHeightMode()&&this.__processHeight()))}let isSimpleDataType="object"!=typeof this.__srcData[0];this.__filterSortMap=this.__srcData.map((currentElement,index)=>index),this.__filterInstance&&(this.__filterSortMap=this.__filterSortMap.filter(index=>this.__filterInstance.test(this.__srcData[index],index))),this.__internalSorting.length>0&&(this.__filterSortMap=this.__filterSortMap.sort((indexA,indexB)=>{let result=0;for(let i=0,ii=this.__internalSorting.length;i<ii&&0===result;i++){let a=this.__srcData[indexA],b=this.__srcData[indexB];!isSimpleDataType&&this.__internalSorting[i].name&&(a=this.__readObjectProperty(this.__srcData[indexA],this.__internalSorting[i].name),b=this.__readObjectProperty(this.__srcData[indexB],this.__internalSorting[i].name)),a=null!=a?a.valueOf():a,b=null!=b?b.valueOf():b;let stringComparer=null,compareBool=(a,b)=>a===b?0:a?1:-1,compareNumber=(a,b)=>a-b,compareString=(a,b)=>(stringComparer||(stringComparer=new Intl.Collator(TcHmi.Locale.get(),{usage:"sort",sensitivity:"accent",numeric:!0})),stringComparer.compare(a,b)),order="Descending"===this.__internalSorting[i].order?-1:1;switch(typeof a){case"boolean":switch(typeof b){case"boolean":result=compareBool(a,b);break;case"number":result=compareNumber(a?1:0,b);break;case"string":result=compareString(a.toString(),b);break;default:result=-1*order}break;case"number":switch(typeof b){case"boolean":result=compareNumber(a,b?1:0);break;case"number":result=compareNumber(a,b);break;case"string":result=compareString(a.toString(10),b);break;default:result=-1*order}break;case"string":switch(typeof b){case"boolean":result=compareString(a,b.toString());break;case"number":result=compareString(a,b.toString(10));break;case"string":result=compareString(a,b);break;default:result=-1*order}break;default:switch(typeof b){case"boolean":case"number":case"string":result=order;break;default:result=!a&&b?-1:a&&!b?1:a||b||a===b?0:void 0===a?-1:1}}result*=order}return result})),this.__dataLength!==this.__filterSortMap.length&&(this.__dataLength=this.__filterSortMap.length,this.__updateSentinels(),"Content"===this.getHeightMode()&&this.__processHeight())}__updateSentinels(){if(!this.__srcData)return;let sentinelTopHeight=0,sentinelBottomHeight=0;void 0!==this.__rowHeight&&(sentinelTopHeight=(this.__scrollInfo.firstIndex-this.__scrollInfo.buffer)*this.__rowHeight,sentinelBottomHeight=(this.__dataLength-(this.__scrollInfo.firstIndex+this.__scrollInfo.rowCount+this.__scrollInfo.buffer))*this.__rowHeight),sentinelTopHeight=sentinelTopHeight>0?sentinelTopHeight:0,sentinelBottomHeight=sentinelBottomHeight>0?sentinelBottomHeight:0,TcHmi.StyleProvider.setSimpleElementStyle(this.__element[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-scroll-sentinel-top"),"height",sentinelTopHeight+"px"),TcHmi.StyleProvider.setSimpleElementStyle(this.__element[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-scroll-sentinel-bottom"),"height",sentinelBottomHeight+"px")}__modifyRadioButton(row,column,rowElement){if(!this.__srcData)return null;let columnDefinition=this.__internalSrcColumn[column],valueOld=this.__srcData[row];if(TcHmiDatagrid.isSimpleColumn(columnDefinition)||(valueOld=this.__readObjectProperty(valueOld,columnDefinition.name)),!0===valueOld)return null;let needSorting=!1;if(!this.__pagingInfo.usePaging)if(TcHmiDatagrid.isSimpleColumn(columnDefinition))for(let i=0;i<this.__srcData.length;i++)this.__srcData[i]=i===row;else for(let i=0;i<this.__srcData.length;i++)void 0!==this.__srcData[i]&&this.__writeObjectProperty(this.__srcData[i],columnDefinition.name,i===row);if(this.__dataSymbol)if(this.__pagingInfo.usePaging){let originalIndex=this.__srcDataIndexToOriginalIndex(row);if(-1===originalIndex)return null;let symbol=this.__dataSymbol.getExpression().getName();if(!symbol)return;TcHmi.Server.readSymbol(symbol,data=>{if(data.error!==TcHmi.Errors.NONE)TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${symbol}%/s%] `+TcHmi.Log.buildMessage(data.details));else if(data.response)if(data.response.error)TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${symbol}%/s%] `+TcHmi.Log.buildMessage(data.response.error));else if(data.response.commands&&0!==data.response.commands.length){if(data.response.commands[0].error)TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${symbol}%/s%] `+TcHmi.Log.buildMessage(data.response.commands[0].error));else if(data.response.commands[0].readValue){let writeValue=data.response.commands[0].readValue;if(!Array.isArray(writeValue))return;if(TcHmiDatagrid.isSimpleColumn(columnDefinition))for(let i=0;i<writeValue.length;i++)writeValue[i]=i===originalIndex;else for(let i=0;i<writeValue.length;i++)void 0!==writeValue[i]&&this.__writeObjectProperty(writeValue[i],columnDefinition.name,i===originalIndex);TcHmi.Server.writeSymbol(symbol,writeValue,data=>{data.error!==TcHmi.Errors.NONE?TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${symbol}%/s%] `+TcHmi.Log.buildMessage(data.details)):data.response?data.response.error?TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${symbol}%/s%] `+TcHmi.Log.buildMessage(data.response.error)):data.response.commands&&0!==data.response.commands.length?data.response.commands[0].error&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${symbol}%/s%] `+TcHmi.Log.buildMessage(data.response.commands[0].error)):TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${symbol}%/s%] `+TcHmi.Log.buildMessage({code:TcHmi.Errors.E_SERVER_COMMANDS_MISSING,message:TcHmi.Errors[TcHmi.Errors.E_SERVER_COMMANDS_MISSING],reason:"Missing commands in response from server with id: '"+data.response.id+"'.",domain:this.__type})):TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${symbol}%/s%] `+TcHmi.Log.buildMessage({code:TcHmi.Errors.E_SERVER_RESPONSE_MISSING,message:TcHmi.Errors[TcHmi.Errors.E_SERVER_RESPONSE_MISSING],reason:"Missing response from server.",domain:this.__type}))})}}else TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${symbol}%/s%] `+TcHmi.Log.buildMessage({code:TcHmi.Errors.E_SERVER_COMMANDS_MISSING,message:TcHmi.Errors[TcHmi.Errors.E_SERVER_COMMANDS_MISSING],reason:"Missing commands in response from server with id: '"+data.response.id+"'.",domain:this.__type}));else TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${symbol}%/s%] `+TcHmi.Log.buildMessage({code:TcHmi.Errors.E_SERVER_RESPONSE_MISSING,message:TcHmi.Errors[TcHmi.Errors.E_SERVER_RESPONSE_MISSING],reason:"Missing response from server.",domain:this.__type}))})}else this.__dataSymbol.write(this.__srcData,data=>{data.error!==TcHmi.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=${this.__dataSymbol.getExpression().toString()}] `+TcHmi.Log.buildMessage(data.details))});this.__setRowClasses(rowElement,row),TcHmi.EventProvider.raise(this.__id+".onDataChanged",{index:row,property:TcHmiDatagrid.isSimpleColumn(columnDefinition)?null:columnDefinition.name,value:!0}),TcHmi.EventProvider.raise(this.__id+".onSelectedItemChanged"),TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedRowValue"}),TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedCellValue"}),this.__dataSymbol||TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SrcData"}),this.__srcDataHasChanged||(this.__srcDataHasChanged=!0,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"srcDataHasChanged"}));for(let i=0,ii=this.__internalSorting.length;i<ii;i++){if(!this.__internalSorting[i].name&&TcHmiDatagrid.isSimpleColumn(columnDefinition)){needSorting=!0;break}if(this.__internalSorting[i].name===columnDefinition.name){needSorting=!0;break}}return{convertedValue:!0,needSorting:needSorting}}__modifySrcData(valueNew,row,column,rowElement){if(!this.__srcData)return null;let columnDefinition=this.__internalSrcColumn[column],valueOld=this.__srcData[row];TcHmiDatagrid.isSimpleColumn(columnDefinition)||(valueOld=this.__readObjectProperty(valueOld,columnDefinition.name));let convertedValue=valueNew;if(null!=valueOld)switch(typeof valueOld){case"string":convertedValue=TcHmi.ValueConverter.toString(valueNew);break;case"number":convertedValue=TcHmi.ValueConverter.toNumber(valueNew);break;case"boolean":convertedValue=TcHmi.ValueConverter.toBoolean(valueNew);break;case"object":convertedValue=TcHmi.ValueConverter.toObject(valueNew)}null===convertedValue&&(convertedValue=valueNew);let needSorting=!1;if(!tchmi_equal(valueOld,convertedValue)){if(TcHmiDatagrid.isSimpleColumn(columnDefinition)?this.__srcData[row]=convertedValue:this.__writeObjectProperty(this.__srcData[row],columnDefinition.name,convertedValue),this.__dataSymbol)if(this.__pagingInfo.usePaging){let originalIndex=this.__srcDataIndexToOriginalIndex(row);if(-1===originalIndex)return null;let writeValue=convertedValue,symbol=this.__dataSymbol.getExpression().getName()+`[${originalIndex}]`;TcHmiDatagrid.isSimpleColumn(columnDefinition)||(symbol+="::"+columnDefinition.name),TcHmi.Server.writeSymbol(symbol,writeValue,data=>{data.error!==TcHmi.Errors.NONE?TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${symbol}%/s%] `+TcHmi.Log.buildMessage(data.details)):data.response?data.response.error?TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${symbol}%/s%] `+TcHmi.Log.buildMessage(data.response.error)):data.response.commands&&0!==data.response.commands.length?data.response.commands[0].error&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${symbol}%/s%] `+TcHmi.Log.buildMessage(data.response.commands[0].error)):TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${symbol}%/s%] `+TcHmi.Log.buildMessage({code:TcHmi.Errors.E_SERVER_COMMANDS_MISSING,message:TcHmi.Errors[TcHmi.Errors.E_SERVER_COMMANDS_MISSING],reason:"Missing commands in response from server with id: '"+data.response.id+"'.",domain:this.__type})):TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=%s%${symbol}%/s%] `+TcHmi.Log.buildMessage({code:TcHmi.Errors.E_SERVER_RESPONSE_MISSING,message:TcHmi.Errors[TcHmi.Errors.E_SERVER_RESPONSE_MISSING],reason:"Missing response from server.",domain:this.__type}))})}else this.__dataSymbol.write(this.__srcData,data=>{data.error!==TcHmi.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=${this.__dataSymbol.getExpression().toString()}] `+TcHmi.Log.buildMessage(data.details))});this.__setRowClasses(rowElement,row),TcHmi.EventProvider.raise(this.__id+".onDataChanged",{index:row,property:TcHmiDatagrid.isSimpleColumn(columnDefinition)?null:columnDefinition.name,value:convertedValue}),TcHmi.EventProvider.raise(this.__id+".onSelectedItemChanged"),TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedRowValue"}),TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedCellValue"}),this.__dataSymbol||TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SrcData"}),this.__srcDataHasChanged||(this.__srcDataHasChanged=!0,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"srcDataHasChanged"}));for(let i=0,ii=this.__internalSorting.length;i<ii;i++){if(!this.__internalSorting[i].name&&TcHmiDatagrid.isSimpleColumn(columnDefinition)){needSorting=!0;break}if(this.__internalSorting[i].name===columnDefinition.name){needSorting=!0;break}}}return{convertedValue:convertedValue,needSorting:needSorting}}__readObjectProperty(obj,path){if(void 0===obj)return;let propertyPath=TcHmi.System.resolveSymbolPathToTokenArray(path),value=obj;for(let i=0,ii=propertyPath.length;i<ii;i++){let token=propertyPath[i],isArrayToken=!1;if(token.match(/\[.*\]/)&&(token=token.slice(1,-1),isArrayToken=!0),Array.isArray(value)&&isArrayToken){let index=parseInt(token,10);value=value[isNaN(index)?token:index]}else{if("object"!=typeof value)return null;value=value[token]}}return value}__writeObjectProperty(obj,path,valueNew){let propertyPath=TcHmi.System.resolveSymbolPathToTokenArray(path),value=obj;for(let i=0,ii=propertyPath.length;i<ii;i++){let token=propertyPath[i],isArrayToken=!1;if(token.match(/\[.*\]/)&&(token=token.slice(1,-1),isArrayToken=!0),Array.isArray(value)&&isArrayToken){let index=parseInt(token,10);i+1===ii?value[isNaN(index)?token:index]=valueNew:value=value[isNaN(index)?token:index]}else{if("object"!=typeof value)return;i+1===ii?value[token]=valueNew:value=value[token]}}}__initStorage(){let stored=window.localStorage.getItem("TCHMI_TCHMIDATAGRID_USERPREFERENCES_"+this.__id);if(stored)try{this.__storage=JSON.parse(stored),"object"!=typeof this.__storage&&(this.__storage={})}catch(ex){this.__storage={}}else this.__storage={};for(let key in this.__storageValidation)this.__storageValidation[key].expectedResult=this[this.__storageValidation[key].function].apply(this);for(let key in this.__storage)tchmi_equal(this.__storageValidation[key].expectedResult,this.__storage[key].validation.expectedResult)||this.__removeStoredValue(key)}__getStoredValue(key){this.__storage||this.__initStorage();let user=TcHmi.Server.getCurrentUser(),storageForKey=this.__storage[key];if(storageForKey)return user?storageForKey.users?storageForKey.users[user]:void 0:storageForKey.anonymousUser}__setStoredValue(key,value){this.__storage||this.__initStorage();let user=TcHmi.Server.getCurrentUser();this.__storage[key]||(this.__storage[key]={validation:{function:this.__storageValidation[key].function,expectedResult:void 0}});let storageForKey=this.__storage[key];storageForKey.validation.expectedResult=this.__storageValidation[key].expectedResult,user?(storageForKey.users||(storageForKey.users={}),storageForKey.users[user]=value):storageForKey.anonymousUser=value;try{window.localStorage.setItem("TCHMI_TCHMIDATAGRID_USERPREFERENCES_"+this.__id,JSON.stringify(this.__storage))}catch(ex){}}__removeStoredValue(key){this.__storage||this.__initStorage();let storageForKey=this.__storage[key];if(storageForKey){let user=TcHmi.Server.getCurrentUser();user?storageForKey.users?(delete storageForKey.users[user],0===Object.keys(storageForKey.users).length&&(void 0===storageForKey.anonymousUser?delete this.__storage[key]:delete storageForKey.users)):void 0===storageForKey.anonymousUser&&delete this.__storage[key]:storageForKey.users?delete storageForKey.anonymousUser:delete this.__storage[key]}if(Object.keys(this.__storage).length>0)try{window.localStorage.setItem("TCHMI_TCHMIDATAGRID_USERPREFERENCES_"+this.__id,JSON.stringify(this.__storage))}catch(ex){}else window.localStorage.removeItem("TCHMI_TCHMIDATAGRID_USERPREFERENCES_"+this.__id)}setSrcColumn(valueNew){if(this.__lockState)return;let convertedValue=TcHmi.ValueConverter.toObject(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("SrcColumn"));let resolverInfo=this.__objectResolvers.get("srcColumn");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue);this.__objectResolvers.set("srcColumn",{resolver:resolver,watchCallback:this.__onResolverForSrcColumnWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForSrcColumnWatchCallback)})}getSrcColumn(){return this.__srcColumn}__processSrcColumn(){var _a;this.__srcData&&this.__srcData.length>0&&"object"!=typeof this.__srcData[0]&&0===this.__internalSrcColumn.length&&(this.__internalSrcColumn=[{label:"",control:"TextBlock",width:70,widthUnit:"px",resize:!0,minWidth:70,minWidthUnit:"px",editable:!0,horizontalAlignment:"Center",verticalAlignment:"Center",cellBackground:null,textColor:null}]);let borderWidth=void 0!==this.__tableBorderWidth?this.__tableBorderWidth:1,requiredMinWidth=Math.max(borderWidth,this.__resizeElementMinWidth),elementWidth=this.__element[0].clientWidth-this.__columnWidths[0].pixelWidth;this.__columnWidths.splice(1),this.__comboboxDropdowns={};for(let i=0,ii=this.__internalSrcColumn.length;i<ii;i++){let column=this.__internalSrcColumn[i],minWidthUnit=column.minWidthUnit;minWidthUnit=minWidthUnit||"px";let convertedReqMinWidth="px"===minWidthUnit?requiredMinWidth:(width=requiredMinWidth,elementWidth>0?width/elementWidth*100:0),minWidth=column.minWidth;if(minWidth=null!=minWidth?minWidth:0,minWidth=minWidth>=convertedReqMinWidth?minWidth:convertedReqMinWidth,this.__columnWidths.push({width:0,widthUnit:column.widthUnit,pixelWidth:0,minWidth:minWidth,minWidthUnit:minWidthUnit,resizable:null!==(_a=column.resize)&&void 0!==_a&&_a}),this.__resizeColumn(i+1,column.width,!0),"ComboBox"===column.control){let divDropdown=document.createElement("div");if(divDropdown.setAttribute("class","TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-dropdown tchmi-datagrid-combobox-template-dropdown tchmi-box"),divDropdown.setAttribute("tabindex","-1"),column.dataDefinitions&&Array.isArray(column.dataDefinitions))for(let j=0,jj=column.dataDefinitions.length;j<jj;j++){let dataDef=column.dataDefinitions[j],text=tchmi_decode_control_characters(dataDef.text),element=document.createElement("div");element.setAttribute("class","TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-dropdown-element tchmi-datagrid-combobox-template-dropdown-element"),element.setAttribute("data-index",j.toString()),element.setAttribute("data-value",dataDef.value.toString()),element.textContent=text,divDropdown.appendChild(element)}this.__comboboxDropdowns[JSON.stringify(column.dataDefinitions)]=divDropdown}}var width;null!==this.__selectedCombobox&&this.__closeCombobox(),this.__buildHeader(),this.__updateTable(1)}__executeFormatFunction(format,value){if(null!=format&&!1!==format.active){const args=[value];let res=null,f=new TcHmi.Function(format),__this=this;if(!f.isProcessedAsync())return f.executeEx(args,(function(data){data.error===TcHmi.Errors.NONE?res=data.result:TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+__this.getId()+"] Execution of function="+format.fn+" failed with error: "+TcHmi.Log.buildMessage(data.details))})),f.destroy(),res;TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+__this.getId()+"] Execution of function="+format.fn+" was aborted because it will be processed asynchronous and a synchronous running function call is required. Either the function is running asynchronous by definition or asynchronous running symbols were added to the list of parameters.")}return null!=value?value+"":""}setSrcData(valueNew){this.__dataSymbol?this.__overriddenSrcData=valueNew:this.__setSrcData(valueNew)}__setSrcData(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("SrcData"));let resolverInfo=this.__objectResolvers.get("srcData");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue);this.__objectResolvers.set("srcData",{resolver:resolver,watchCallback:this.__onResolverForSrcDataWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForSrcDataWatchCallback)})}getSrcData(){return this.__dataSymbol?void 0:this.__srcData}__processSrcData(){var _a;if(!this.__srcData||this.__oldSrcData&&this.__oldSrcData.length===this.__srcData.length||(this.__lockState&&this.__originalIndexToSrcDataIndex(this.__lockState.row)>=this.__srcData.length&&this.__unlock(),null!==this.__selectedCell&&null!==this.__selectedCell.rowIndex&&this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex)>=this.__srcData.length&&(this.__selectedCell=null,TcHmi.EventProvider.raise(this.__id+".onSelectedItemChanged"),TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SelectedRowIndex"}),TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SelectedColumnIndex"}),TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedRowValue"}),TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedCellValue"}))),this.__srcData&&this.__srcData.length>0&&"object"!=typeof this.__srcData[0]&&0===this.__internalSrcColumn.length){this.__internalSrcColumn=[{label:"",control:"TextBlock",width:70,widthUnit:"px",resize:!0,minWidth:70,minWidthUnit:"px",editable:!0,horizontalAlignment:"Center",verticalAlignment:"Center",cellBackground:null,textColor:null}];let borderWidth=void 0!==this.__tableBorderWidth?this.__tableBorderWidth:1,requiredMinWidth=Math.max(borderWidth,this.__resizeElementMinWidth);this.__columnWidths.splice(1);for(let i=0,ii=this.__internalSrcColumn.length;i<ii;i++){let minWidth=this.__internalSrcColumn[i].minWidth;minWidth=null!=minWidth?minWidth:0,minWidth=minWidth>=requiredMinWidth?minWidth:requiredMinWidth;let minWidthUnit=this.__internalSrcColumn[i].minWidthUnit;minWidthUnit=minWidthUnit||"px",this.__columnWidths.push({width:0,widthUnit:this.__internalSrcColumn[i].widthUnit,pixelWidth:0,minWidth:minWidth,minWidthUnit:minWidthUnit,resizable:null!==(_a=this.__internalSrcColumn[i].resize)&&void 0!==_a&&_a}),this.__resizeColumn(i+1,this.__internalSrcColumn[i].width,!0)}this.__buildHeader()}if(this.__filterAndSort(),this.__updateTable(0),this.__oldSrcData&&this.__srcData&&null!==this.__selectedCell&&null!==this.__selectedCell.rowIndex){let index=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);if(-1!==index&&!tchmi_equal(this.__oldSrcData[index],this.__srcData[index])&&(TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedRowValue"}),this.__selectedCell.columnIndex>=0)){let columnDefinition=this.__internalSrcColumn[this.__selectedCell.columnIndex];if(!TcHmiDatagrid.isSimpleColumn(columnDefinition)&&this.__selectedCell){let left=this.__readObjectProperty(this.__oldSrcData[index],columnDefinition.name),right=this.__readObjectProperty(this.__srcData[index],columnDefinition.name);tchmi_equal(left,right)||(TcHmi.EventProvider.raise(this.__id+".onSelectedItemChanged"),TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedCellValue"}))}else TcHmi.EventProvider.raise(this.__id+".onSelectedItemChanged"),TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedCellValue"})}}this.__oldSrcData=this.__srcData}setDataSymbol(valueNew){let newSymbol=valueNew;if(null===newSymbol){let symbolExpression=this.getAttributeDefaultValueInternal("DataSymbol");symbolExpression&&(newSymbol=new TcHmi.Symbol(symbolExpression))}this.__dataSymbol!==newSymbol&&(newSymbol instanceof TcHmi.Symbol?this.__dataSymbol=newSymbol:(this.__dataSymbol,this.__dataSymbol=null),TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"DataSymbol"}),this.__processDataSymbol())}getDataSymbol(){return this.__dataSymbol}__processDataSymbol(unsubscribeOnly=!1){var _a;TCHMI_DESIGNER||(this.__pagingInfo.usePaging?(null!==this.__pagingInfo.subscriptionId&&(TcHmi.Server.unsubscribeEx(this.__pagingInfo.subscriptionId,null,data=>{var _a;data.error!==TcHmi.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=${null===(_a=this.__dataSymbol)||void 0===_a?void 0:_a.getExpression().toString()}] `+TcHmi.Log.buildMessage(data.details))}),this.__pagingInfo.subscriptionId=null),this.__pagingInfo.usePaging=!1):this.__destroyDataSymbolWatch&&(this.__destroyDataSymbolWatch(),this.__destroyDataSymbolWatch=null),this.__isAttached&&!unsubscribeOnly&&(this.__dataSymbol?(this.__overriddenSrcData=null!==(_a=this.__srcData)&&void 0!==_a?_a:null,this.__setSrcData(null),this.__dataSymbol.getExpression().getType()===TcHmi.SymbolType.Server?(this.__pagingInfo.usePaging=!0,this.__updatePaging(!0)):this.__destroyDataSymbolWatch=this.__dataSymbol.watch(this.__onDataSymbolWatch)):void 0!==this.__overriddenSrcData&&(this.__setSrcData(this.__overriddenSrcData),this.__overriddenSrcData=void 0)))}__updatePaging(force=!1){var _a,_b,_c;if(!this.__dataSymbol||!this.__pagingInfo.usePaging||0===this.__scrollInfo.rowCount)return;let offset=this.__scrollInfo.firstIndex-this.__pagingInfo.buffer;if(!force&&null!==this.__pagingInfo.subscriptionId&&Math.abs(this.__pagingInfo.theoraticalOffset-offset)<this.__pagingInfo.buffer/2)return;let average=data=>data.length>0?data.reduce((accumulator,current)=>accumulator+current)/data.length:0,now=Date.now();if(this.__pagingInfo.timing.lastUpdateTime>0){let elapsed=now-this.__pagingInfo.timing.lastUpdateTime,updateAverage=average(this.__pagingInfo.timing.responseLatencies);(0===updateAverage||elapsed<3*updateAverage)&&(this.__pagingInfo.timing.updateTimings.push(elapsed),this.__pagingInfo.timing.updateTimings.length>5&&this.__pagingInfo.timing.updateTimings.shift())}if(this.__pagingInfo.timing.lastUpdateTime=now,null!==this.__pagingInfo.subscriptionId&&(TcHmi.Server.unsubscribeEx(this.__pagingInfo.subscriptionId,null,data=>{var _a;data.error!==TcHmi.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error(`[Source=Control, Module=${this.__type}, Id=${this.getId()}, Property=DataSymbol, Symbol=${null===(_a=this.__dataSymbol)||void 0===_a?void 0:_a.getExpression().toString()}] `+TcHmi.Log.buildMessage(data.details))}),this.__pagingInfo.subscriptionId=null),this.__pagingInfo.timing.isScrolling&&average(this.__pagingInfo.timing.responseLatencies)>average(this.__pagingInfo.timing.updateTimings))return;this.__pagingInfo.theoraticalOffset=offset;let expression=this.__dataSymbol.getExpression(),expressionName=expression.getName();expression.getType()!==TcHmi.SymbolType.Invalid&&expressionName&&(this.__pagingInfo.subscriptionId=TcHmi.Server.subscribeEx([{commandOptions:["SendErrorMessage"],symbol:expressionName,offset:Math.max(offset,0),limit:this.__scrollInfo.rowCount+2*this.__pagingInfo.buffer,orderBy:this.__internalSorting.map(info=>{var _a;return(null!==(_a=info.name)&&void 0!==_a?_a:"{value}")+" "+("Descending"===info.order?"DESC":"ASC")}).join(", "),filter:null!==(_a=this.__filter)&&void 0!==_a?_a:void 0,filterMap:[]}],null!==(_c=null!==(_b=expression.getOptions().Interval)&&void 0!==_b?_b:TcHmi.Config.get().tcHmiServer.websocketIntervalTime)&&void 0!==_c?_c:500,null,this.__onDataSymbolPage),this.__pagingInfo.timing.lastRequestTime=now,this.__pagingInfo.timing.firstResponsePending=!0)}__setDataSymbolTransform(valueNew){valueNew!==this.__dataSymbolTransform&&(this.__dataSymbolTransform=valueNew)}setSorting(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew,this.getAttributeDefaultValueInternal("Sorting")),resolverInfo=this.__objectResolvers.get("sorting");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue);this.__objectResolvers.set("sorting",{resolver:resolver,watchCallback:this.__onResolverForSortingWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForSortingWatchCallback)})}getSorting(){return this.__sorting}__processSorting(){this.__filterAndSort(),this.__pagingInfo.usePaging?this.__updatePaging(!0):this.__updateTable(0);let tableHeaders=this.__elementHeaderTable[0].getElementsByTagName("th");for(let i=0,ii=tableHeaders.length;i<ii;i++){if(tableHeaders[i].classList.contains("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers")||tableHeaders[i].classList.contains("tchmi-datagrid-template-row-numbers"))continue;let sortingElement=tableHeaders[i].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-sort-element-child")[0];sortingElement||(sortingElement=tableHeaders[i].getElementsByClassName("tchmi-datagrid-sort-element-child")[0]),sortingElement.classList.remove("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-sort-asc"),sortingElement.classList.remove("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-sort-desc"),sortingElement.classList.remove("tchmi-datagrid-template-header-sort-asc"),sortingElement.classList.remove("tchmi-datagrid-template-header-sort-desc");let propertyName=void 0;TcHmiDatagrid.isSimpleColumn(this.__internalSrcColumn[0])||(propertyName=tableHeaders[i].dataset.name);for(let j=0,jj=this.__internalSorting.length;j<jj;j++)if(this.__internalSorting[j].name===propertyName){switch(this.__internalSorting[j].order){case"Ascending":sortingElement.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-sort-asc","tchmi-datagrid-template-header-sort-asc");break;case"Descending":sortingElement.classList.add("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-sort-desc","tchmi-datagrid-template-header-sort-desc")}break}}}setFilter(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew,this.getAttributeDefaultValueInternal("Filter")),resolverInfo=this.__objectResolvers.get("filter");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue);this.__objectResolvers.set("filter",{resolver:resolver,watchCallback:this.__onResolverForFilterWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForFilterWatchCallback)})}getFilter(){return this.__filter}__processFilter(){this.__filter?this.__filterInstance=TcHmi.System.Filter.parse(this.__filter):this.__filterInstance=null,this.__filterAndSort(),this.__pagingInfo.usePaging?this.__updatePaging(!0):this.__updateTable(0)}setRowClassesProvider(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("RowClassesProvider")),tchmi_equal(convertedValue,this.__rowClassesProvider)||(this.__rowClassesProvider=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowClassesProvider"}),this.__processRowClassesProvider())}getRowClassesProvider(){return this.__rowClassesProvider}__processRowClassesProvider(){let rows=this.__elementDataTableBody[0].children;for(let i=0,ii=rows.length;i<ii;i++){let row=rows[i],dataIndex=parseInt(row.dataset.row||"",10);isNaN(dataIndex)||this.__setRowClasses(row,dataIndex)}}__executeRowClassesProviderFunction(dataIndex){if(void 0!==this.__srcData&&void 0!==this.__rowClassesProvider&&null!==this.__rowClassesProvider&&!1!==this.__rowClassesProvider.active){let rowValue=this.__srcData[dataIndex];if(void 0===rowValue)return[];let rowNumber=!this.__pagingInfo.usePaging&&this.__filterSortMap?this.__filterSortMap.indexOf(dataIndex):dataIndex;if(-1===rowNumber)return[];let args=[rowValue,dataIndex,rowNumber],res=null,f=new TcHmi.Function(this.__rowClassesProvider);if(!f.isProcessedAsync())return f.executeEx(args,data=>{data.error===TcHmi.Errors.NONE?res=data.result:TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+"] Execution of function="+this.__rowClassesProvider.fn+" failed with error. Details: "+(void 0!==data.details?TcHmi.Log.buildMessage(data.details):TcHmi.Errors[data.error]))}),f.destroy(),res||[];TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiDatagrid, Id="+this.getId()+"] Execution of function="+this.__rowClassesProvider.fn+" was aborted because it will be processed asynchronous and a synchronous running function call is required. Either the function is running asynchronous by definition or asynchronous running symbols were added to the list of parameters.")}return[]}__setRowClasses(row,dataIndex){let hidden=this.__lockState&&this.__lockState.rowElement===row&&row.classList.contains("hidden");if(row.setAttribute("class","TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row tchmi-datagrid-template-row"),this.__selectedCell&&null!==this.__selectedCell.rowIndex){let index=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);-1!==index&&index===dataIndex&&row.classList.add("focused")}hidden&&row.classList.add("hidden");let classes=this.__executeRowClassesProviderFunction(dataIndex);for(let j=0,jj=classes.length;j<jj;j++)row.classList.add(classes[j])}setHeaderHeight(valueNew){let convertedValue=TcHmi.ValueConverter.toNumber(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("HeaderHeight")),convertedValue!==this.__headerHeight&&(this.__headerHeight=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderHeight"}),this.__processHeaderHeight())}getHeaderHeight(){return this.__headerHeight}__processHeaderHeight(){null!==this.__headerHeight&&void 0!==this.__headerHeight&&this.__headerHeightUnit&&(this.__recalcRowCount(),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementHeaderScroll,"height",this.__headerHeight+this.__headerHeightUnit),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementDataScroll,"height","calc(100% - "+this.__headerHeight+(this.__headerHeightUnit||"px")+")"),"Content"===this.getHeightMode()&&this.__processHeight())}setHeaderHeightUnit(valueNew){let convertedValue=TcHmi.ValueConverter.toDimensionUnit(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("HeaderHeightUnit")),convertedValue!==this.__headerHeightUnit&&(this.__headerHeightUnit=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderHeightUnit"}),this.__processHeaderHeightUnit())}getHeaderHeightUnit(){return this.__headerHeightUnit}__processHeaderHeightUnit(){this.__processHeaderHeight()}setHeaderCellPadding(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("HeaderCellPadding"));let resolverInfo=this.__objectResolvers.get("headerCellPadding");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue);this.__objectResolvers.set("headerCellPadding",{resolver:resolver,watchCallback:this.__onResolverForHeaderCellPaddingWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForHeaderCellPaddingWatchCallback)})}getHeaderCellPadding(){return this.__headerCellPadding}__processHeaderCellPadding(){TcHmi.StyleProvider.processContentPadding(this.__elementHeaderTable[0].querySelectorAll("th.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header"),this.__headerCellPadding)}setRowHeight(valueNew){let convertedValue=TcHmi.ValueConverter.toNumber(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("RowHeight")),convertedValue!==this.__rowHeight&&(this.__rowHeight=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowHeight"}),this.__processRowHeight())}getRowHeight(){return this.__rowHeight}__processRowHeight(){void 0!==this.__tableBorderWidth&&void 0!==this.__rowHeight&&(this.__recalcRowCount(),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementDataTableBody[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row"),"height",this.__rowHeight+"px"),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementDataTableBody[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row td"),"height",this.__rowHeight+"px"),this.__setCheckboxRadioButtonSize(),this.__element[0].style.setProperty("--row-height",this.__rowHeight+"px"),"Content"===this.getHeightMode()&&this.__processHeight())}getRowHeightUnit(){return"px"}setTableBorderColor(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("TableBorderColor"));let resolverInfo=this.__objectResolvers.get("tableBorderColor");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue);this.__objectResolvers.set("tableBorderColor",{resolver:resolver,watchCallback:this.__onResolverForTableBorderColorWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForTableBorderColorWatchCallback)})}getTableBorderColor(){return this.__tableBorderColor}__processTableBorderColor(){TcHmi.StyleProvider.processBorderColor(this.__elementHeaderTable[0].getElementsByTagName("th"),this.__tableBorderColor),TcHmi.StyleProvider.processBorderColor(this.__elementDataTableBody[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row td"),this.__tableBorderColor),TcHmi.StyleProvider.processBorderColor(this.__elementHeaderScroll,this.__tableBorderColor)}setTableBorderWidth(valueNew){let convertedValue=TcHmi.ValueConverter.toNumber(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("TableBorderWidth")),convertedValue!==this.__tableBorderWidth&&(this.__tableBorderWidth=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"TableBorderWidth"}),this.__processTableBorderWidth(),this.__processRowHeight())}getTableBorderWidth(){return this.__tableBorderWidth}__processTableBorderWidth(){const headerBorder={right:this.__tableBorderWidth,rightUnit:"px",bottom:0,left:0,top:0},cellBorder={right:this.__tableBorderWidth,rightUnit:"px",bottom:this.__tableBorderWidth,bottomUnit:"px",top:0,left:0},headerDivBorder={bottom:this.__tableBorderWidth,bottomUnit:"px",left:0,top:0,right:0};TcHmi.StyleProvider.processBorderWidth(this.__elementHeaderTable[0].getElementsByTagName("th"),headerBorder),TcHmi.StyleProvider.processBorderWidth(this.__elementDataTableBody[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row td"),cellBorder),TcHmi.StyleProvider.processBorderWidth(this.__elementHeaderScroll,headerDivBorder),this.__setCheckboxRadioButtonSize(),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementHeaderTable[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-resize-element"),{width:this.__tableBorderWidth&&this.__tableBorderWidth>this.__resizeElementMinWidth?this.__tableBorderWidth+"px":null,right:this.__tableBorderWidth&&this.__tableBorderWidth>this.__resizeElementMinWidth?-this.__tableBorderWidth+"px":null});let requiredMinWidth=Math.max(this.__tableBorderWidth||0,this.__resizeElementMinWidth),recalcRequired=!1,elementWidth=this.__element[0].clientWidth-this.__columnWidths[0].pixelWidth;for(let i=0,ii=this.__columnWidths.length;i<ii;i++){let convertedReqMinWidth="px"===this.__columnWidths[i].minWidthUnit?requiredMinWidth:(width=requiredMinWidth,elementWidth>0?width/elementWidth*100:0),newMinWidth=0===i?6:this.__internalSrcColumn[i-1].minWidth;newMinWidth=null!=newMinWidth?newMinWidth:0,newMinWidth=newMinWidth>=convertedReqMinWidth?newMinWidth:convertedReqMinWidth,this.__columnWidths[i].minWidth<newMinWidth&&(recalcRequired=!0),this.__columnWidths[i].minWidth=newMinWidth}var width;recalcRequired&&this.__recalcAllColumnWidths()}setTableBorderWidthUnit(){}getTableBorderWidthUnit(){return"px"}setTableBorderStyle(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("TableBorderStyle"));let resolverInfo=this.__objectResolvers.get("tableBorderStyle");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue);this.__objectResolvers.set("tableBorderStyle",{resolver:resolver,watchCallback:this.__onResolverForTableBorderStyleWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForTableBorderStyleWatchCallback)})}getTableBorderStyle(){return this.__tableBorderStyle}__processTableBorderStyle(){TcHmi.StyleProvider.processBorderStyle(this.__element[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-border, .TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-border th, .TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row td"),this.__tableBorderStyle)}setShowRowNumbers(valueNew){let convertedValue=TcHmi.ValueConverter.toBoolean(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("ShowRowNumbers")),convertedValue!==this.__showRowNumbers&&(this.__showRowNumbers=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ShowRowNumbers"}),this.__processShowRowNumbers())}getShowRowNumbers(){return this.__showRowNumbers}__processShowRowNumbers(){TcHmi.StyleProvider.setSimpleElementStyle(this.__element[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),"display",this.__showRowNumbers?null:"none"),this.__recalcAllColumnWidths()}setRowNumbersResizable(valueNew){let convertedValue=TcHmi.ValueConverter.toBoolean(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("RowNumbersResizable")),convertedValue!==this.__rowNumbersResizable&&(this.__rowNumbersResizable=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersResizable"}),this.__processRowNumbersResizable())}getRowNumbersResizable(){return this.__rowNumbersResizable}__processRowNumbersResizable(){var _a;this.__columnWidths[0].resizable=null!==(_a=this.__rowNumbersResizable)&&void 0!==_a&&_a,this.__elementHeaderTable.find(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers").toggleClass("resizable",this.__rowNumbersResizable)}setRowNumbersStartNumber(valueNew){let convertedValue=TcHmi.ValueConverter.toNumber(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("RowNumbersStartNumber")),convertedValue!==this.__rowNumbersStartNumber&&(this.__rowNumbersStartNumber=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersStartNumber"}),this.__processRowNumbersStartNumber())}getRowNumbersStartNumber(){return this.__rowNumbersStartNumber}__processRowNumbersStartNumber(){this.__updateTable(1)}setRowNumbersWidth(valueNew){let convertedValue=TcHmi.ValueConverter.toNumber(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("RowNumbersWidth")),convertedValue!==this.__rowNumbersWidth&&(this.__rowNumbersWidth=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersWidth"}),this.__processRowNumbersWidth())}getRowNumbersWidth(){return this.__rowNumbersWidth}__processRowNumbersWidth(){void 0!==this.__rowNumbersWidth&&this.__resizeColumn(0,this.__rowNumbersWidth,!0)}setRowNumbersWidthUnit(valueNew){let convertedValue=TcHmi.ValueConverter.toDimensionUnit(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("RowNumbersWidthUnit")),convertedValue!==this.__rowNumbersWidthUnit&&(this.__rowNumbersWidthUnit=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersWidthUnit"}),this.__processRowNumbersWidthUnit())}getRowNumbersWidthUnit(){return this.__rowNumbersWidthUnit}__processRowNumbersWidthUnit(){void 0!==this.__rowNumbersWidthUnit&&(this.__columnWidths[0].widthUnit=this.__rowNumbersWidthUnit,this.__processRowNumbersWidth())}setRowNumbersHorizontalAlignment(valueNew){let convertedValue=TcHmi.ValueConverter.toHorizontalAlignment(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("RowNumbersHorizontalAlignment")),convertedValue!==this.__rowNumbersHorizontalAlignment&&(this.__rowNumbersHorizontalAlignment=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersHorizontalAlignment"}),this.__processRowNumbersHorizontalAlignment())}getRowNumbersHorizontalAlignment(){return this.__rowNumbersHorizontalAlignment}__processRowNumbersHorizontalAlignment(){switch(this.__rowNumbersHorizontalAlignment){case"Left":TcHmi.StyleProvider.setSimpleElementStyle(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),"justify-content","flex-start");break;case"Right":TcHmi.StyleProvider.setSimpleElementStyle(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),"justify-content","flex-end");break;case"Center":default:TcHmi.StyleProvider.setSimpleElementStyle(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),"justify-content","center")}}setRowNumbersVerticalAlignment(valueNew){let convertedValue=TcHmi.ValueConverter.toVerticalAlignment(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("RowNumbersVerticalAlignment")),convertedValue!==this.__rowNumbersVerticalAlignment&&(this.__rowNumbersVerticalAlignment=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersVerticalAlignment"}),this.__processRowNumbersVerticalAlignment())}getRowNumbersVerticalAlignment(){return this.__rowNumbersVerticalAlignment}__processRowNumbersVerticalAlignment(){switch(this.__rowNumbersVerticalAlignment){case"Top":TcHmi.StyleProvider.setSimpleElementStyle(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),"align-items","flex-start");break;case"Bottom":TcHmi.StyleProvider.setSimpleElementStyle(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),"align-items","flex-end");break;case"Center":default:TcHmi.StyleProvider.setSimpleElementStyle(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),"align-items","center")}}setRowNumbersCellPadding(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("RowNumbersCellPadding"));let resolverInfo=this.__objectResolvers.get("rowNumbersCellPadding");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue);this.__objectResolvers.set("rowNumbersCellPadding",{resolver:resolver,watchCallback:this.__onResolverForRowNumbersCellPaddingWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForRowNumbersCellPaddingWatchCallback)})}getRowNumbersCellPadding(){return this.__rowNumbersCellPadding}__processRowNumbersCellPadding(){TcHmi.StyleProvider.processContentPadding(this.__element[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),this.__rowNumbersCellPadding)}setCellContentPadding(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("CellContentPadding"));let resolverInfo=this.__objectResolvers.get("cellContentPadding");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue);this.__objectResolvers.set("cellContentPadding",{resolver:resolver,watchCallback:this.__onResolverForCellContentPaddingWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForCellContentPaddingWatchCallback)})}getCellContentPadding(){return this.__cellContentPadding}__processCellContentPadding(){let textboxes=this.__elementDataTableBody[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-textbox");TcHmi.StyleProvider.processContentPadding(textboxes,this.__cellContentPadding);let comboboxes=this.__elementDataTableBody[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-combobox-template-select");TcHmi.StyleProvider.processContentPadding(comboboxes,this.__cellContentPadding);let numericInputs=this.__elementDataTableBody[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-numeric-input");TcHmi.StyleProvider.processContentPadding(numericInputs,this.__cellContentPadding);let passwordInputs=this.__elementDataTableBody[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-password-input");TcHmi.StyleProvider.processContentPadding(passwordInputs,this.__cellContentPadding);let spinboxInputs=this.__elementDataTableBody[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-spinbox-input input");TcHmi.StyleProvider.processContentPadding(spinboxInputs,this.__cellContentPadding);let dateTimeInputs=this.__elementDataTableBody[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-date-time-input input");TcHmi.StyleProvider.processContentPadding(dateTimeInputs,this.__cellContentPadding);let timespanInputs=this.__elementDataTableBody[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-timespan-input input");TcHmi.StyleProvider.processContentPadding(timespanInputs,this.__cellContentPadding);let buttons=this.__elementDataTableBody[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-simple-button");TcHmi.StyleProvider.processContentPadding(buttons,this.__cellContentPadding);let toggleButtons=this.__elementDataTableBody[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiDatagrid-toggle-button");TcHmi.StyleProvider.processContentPadding(toggleButtons,this.__cellContentPadding);let cells=this.__elementDataTableBody[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell:not(.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell-unpadded-control)");TcHmi.StyleProvider.processContentPadding(cells,this.__cellContentPadding)}setHeaderBackgroundColor(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("HeaderBackgroundColor"));let resolverInfo=this.__objectResolvers.get("headerBackgroundColor");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue);this.__objectResolvers.set("headerBackgroundColor",{resolver:resolver,watchCallback:this.__onResolverForHeaderBackgroundColorWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForHeaderBackgroundColorWatchCallback)})}getHeaderBackgroundColor(){return this.__headerBackgroundColor}__processHeaderBackgroundColor(){TcHmi.StyleProvider.processBackgroundColor(this.__element[0].querySelectorAll(".TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header-border th, .TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-placeholder"),this.__headerBackgroundColor)}setHeaderTextColor(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("HeaderTextColor"));let resolverInfo=this.__objectResolvers.get("headerTextColor");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue);this.__objectResolvers.set("headerTextColor",{resolver:resolver,watchCallback:this.__onResolverForHeaderTextColorWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForHeaderTextColorWatchCallback)})}getHeaderTextColor(){return this.__headerTextColor}__processHeaderTextColor(){TcHmi.StyleProvider.processTextColor(this.__elementHeaderTable[0].querySelectorAll("th.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header:not(.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers)"),this.__headerTextColor)}setRowNumbersTextColor(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("RowNumbersTextColor"));let resolverInfo=this.__objectResolvers.get("rowNumbersTextColor");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue);this.__objectResolvers.set("rowNumbersTextColor",{resolver:resolver,watchCallback:this.__onResolverForRowNumbersTextColorWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForRowNumbersTextColorWatchCallback)})}getRowNumbersTextColor(){return this.__rowNumbersTextColor}__processRowNumbersTextColor(){TcHmi.StyleProvider.processTextColor(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),this.__rowNumbersTextColor)}setRowNumbersBackgroundColor(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("RowNumbersBackgroundColor"));let resolverInfo=this.__objectResolvers.get("rowNumbersBackgroundColor");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue);this.__objectResolvers.set("rowNumbersBackgroundColor",{resolver:resolver,watchCallback:this.__onResolverForRowNumbersBackgroundColorWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForRowNumbersBackgroundColorWatchCallback)})}getRowNumbersBackgroundColor(){return this.__rowNumbersBackgroundColor}__processRowNumbersBackgroundColor(){TcHmi.StyleProvider.processBackgroundColor(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),this.__rowNumbersBackgroundColor)}setHeaderFontFamily(valueNew){let convertedValue=TcHmi.ValueConverter.toFontFamily(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("HeaderFontFamily")),convertedValue!==this.__headerFontFamily&&(this.__headerFontFamily=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderFontFamily"}),this.__processHeaderFontFamily())}getHeaderFontFamily(){return this.__headerFontFamily}__processHeaderFontFamily(){TcHmi.StyleProvider.processFontFamily(this.__elementHeaderTable[0].querySelectorAll("th.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header"),this.__headerFontFamily)}setHeaderFontSize(valueNew){let convertedValue=TcHmi.ValueConverter.toNumber(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("HeaderFontSize")),convertedValue!==this.__headerFontSize&&(this.__headerFontSize=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderFontSize"}),this.__processHeaderFontSize())}getHeaderFontSize(){return this.__headerFontSize}__processHeaderFontSize(){TcHmi.StyleProvider.processFontSize(this.__elementHeaderTable[0].querySelectorAll("th.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header"),this.__headerFontSize,this.__headerFontSizeUnit)}setHeaderFontSizeUnit(valueNew){let convertedValue=TcHmi.ValueConverter.toFontSizeUnit(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("HeaderFontSizeUnit")),convertedValue!==this.__headerFontSizeUnit&&(this.__headerFontSizeUnit=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderFontSizeUnit"}),this.__processHeaderFontSizeUnit())}getHeaderFontSizeUnit(){return this.__headerFontSizeUnit}__processHeaderFontSizeUnit(){this.__processHeaderFontSize()}setHeaderFontStyle(valueNew){let convertedValue=TcHmi.ValueConverter.toFontStyle(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("HeaderFontStyle")),convertedValue!==this.__headerFontStyle&&(this.__headerFontStyle=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderFontStyle"}),this.__processHeaderFontStyle())}getHeaderFontStyle(){return this.__headerFontStyle}__processHeaderFontStyle(){TcHmi.StyleProvider.processFontStyle(this.__elementHeaderTable[0].querySelectorAll("th.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header"),this.__headerFontStyle)}setHeaderFontWeight(valueNew){let convertedValue=TcHmi.ValueConverter.toFontWeight(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("HeaderFontWeight")),convertedValue!==this.__headerFontWeight&&(this.__headerFontWeight=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeaderFontWeight"}),this.__processHeaderFontWeight())}getHeaderFontWeight(){return this.__headerFontWeight}__processHeaderFontWeight(){TcHmi.StyleProvider.processFontWeight(this.__elementHeaderTable[0].querySelectorAll("th.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-header"),this.__headerFontWeight)}setGridFontFamily(valueNew){let convertedValue=TcHmi.ValueConverter.toFontFamily(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("GridFontFamily")),convertedValue!==this.__gridFontFamily&&(this.__gridFontFamily=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"GridFontFamily"}),this.__processGridFontFamily())}getGridFontFamily(){return this.__gridFontFamily}__processGridFontFamily(){TcHmi.StyleProvider.processFontFamily(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell"),this.__gridFontFamily)}setGridFontSize(valueNew){let convertedValue=TcHmi.ValueConverter.toNumber(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("GridFontSize")),convertedValue!==this.__gridFontSize&&(this.__gridFontSize=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"GridFontSize"}),this.__processGridFontSize())}getGridFontSize(){return this.__gridFontSize}__processGridFontSize(){void 0!==this.__gridFontSize&&void 0!==this.__gridFontSizeUnit&&TcHmi.StyleProvider.processFontSize(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell"),this.__gridFontSize,this.__gridFontSizeUnit)}setGridFontSizeUnit(valueNew){let convertedValue=TcHmi.ValueConverter.toFontSizeUnit(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("GridFontSizeUnit")),convertedValue!==this.__gridFontSizeUnit&&(this.__gridFontSizeUnit=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"GridFontSizeUnit"}),this.__processGridFontSizeUnit())}getGridFontSizeUnit(){return this.__gridFontSizeUnit}__processGridFontSizeUnit(){this.__processGridFontSize()}setGridFontStyle(valueNew){let convertedValue=TcHmi.ValueConverter.toFontStyle(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("GridFontStyle")),convertedValue!==this.__gridFontStyle&&(this.__gridFontStyle=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"GridFontStyle"}),this.__processGridFontStyle())}getGridFontStyle(){return this.__gridFontStyle}__processGridFontStyle(){TcHmi.StyleProvider.processFontStyle(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell"),this.__gridFontStyle)}setGridFontWeight(valueNew){let convertedValue=TcHmi.ValueConverter.toFontWeight(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("GridFontWeight")),convertedValue!==this.__gridFontWeight&&(this.__gridFontWeight=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"GridFontWeight"}),this.__processGridFontWeight())}getGridFontWeight(){return this.__gridFontWeight}__processGridFontWeight(){TcHmi.StyleProvider.processFontWeight(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-cell"),this.__gridFontWeight)}setRowNumbersFontFamily(valueNew){let convertedValue=TcHmi.ValueConverter.toFontFamily(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("RowNumbersFontFamily")),convertedValue!==this.__rowNumbersFontFamily&&(this.__rowNumbersFontFamily=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersFontFamily"}),this.__processRowNumbersFontFamily())}getRowNumbersFontFamily(){return this.__rowNumbersFontFamily}__processRowNumbersFontFamily(){TcHmi.StyleProvider.processFontFamily(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),this.__rowNumbersFontFamily)}setRowNumbersFontSize(valueNew){let convertedValue=TcHmi.ValueConverter.toNumber(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("RowNumbersFontSize")),convertedValue!==this.__rowNumbersFontSize&&(this.__rowNumbersFontSize=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersFontSize"}),this.__processRowNumbersFontSize())}getRowNumbersFontSize(){return this.__rowNumbersFontSize}__processRowNumbersFontSize(){void 0!==this.__rowNumbersFontSize&&void 0!==this.__rowNumbersFontSizeUnit&&TcHmi.StyleProvider.processFontSize(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),this.__rowNumbersFontSize,this.__rowNumbersFontSizeUnit)}setRowNumbersFontSizeUnit(valueNew){let convertedValue=TcHmi.ValueConverter.toFontSizeUnit(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("RowNumbersFontSizeUnit")),convertedValue!==this.__rowNumbersFontSizeUnit&&(this.__rowNumbersFontSizeUnit=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersFontSizeUnit"}),this.__processRowNumbersFontSizeUnit())}getRowNumbersFontSizeUnit(){return this.__rowNumbersFontSizeUnit}__processRowNumbersFontSizeUnit(){this.__processRowNumbersFontSize()}setRowNumbersFontStyle(valueNew){let convertedValue=TcHmi.ValueConverter.toFontStyle(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("RowNumbersFontStyle")),convertedValue!==this.__rowNumbersFontStyle&&(this.__rowNumbersFontStyle=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersFontStyle"}),this.__processRowNumbersFontStyle())}getRowNumbersFontStyle(){return this.__rowNumbersFontStyle}__processRowNumbersFontStyle(){TcHmi.StyleProvider.processFontStyle(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),this.__rowNumbersFontStyle)}setRowNumbersFontWeight(valueNew){let convertedValue=TcHmi.ValueConverter.toFontWeight(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("RowNumbersFontWeight")),convertedValue!==this.__rowNumbersFontWeight&&(this.__rowNumbersFontWeight=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowNumbersFontWeight"}),this.__processRowNumbersFontWeight())}getRowNumbersFontWeight(){return this.__rowNumbersFontWeight}__processRowNumbersFontWeight(){TcHmi.StyleProvider.processFontWeight(this.__element[0].querySelectorAll("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers"),this.__rowNumbersFontWeight)}setSelectedRowIndex(valueNew){let convertedValue=TcHmi.ValueConverter.toNumber(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("SelectedRowIndex")),null!==this.__selectedCell&&convertedValue===this.__selectedCell.rowIndex||(null!==convertedValue?null===this.__selectedCell?this.__selectedCell={rowIndex:convertedValue,columnIndex:-1}:this.__selectedCell.rowIndex=convertedValue:null!==this.__selectedCell&&(this.__selectedCell.rowIndex=null),TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SelectedRowIndex"}),TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SelectedColumnIndex"}),TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedRowValue"}),TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedCellValue"}),this.__processSelectedRowIndex())}getSelectedRowIndex(){return null!==this.__selectedCell?this.__selectedCell.rowIndex:null}__processSelectedRowIndex(){if(this.__elementDataTableBody.find("tr.focused, td.focused").removeClass("focused"),null!==this.__selectedCell&&null!==this.__selectedCell.rowIndex){let index=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);if(-1===index)return;let row=this.__elementDataTableBody.find(`tr[data-row=${index}]`).addClass("focused");row.length>0&&(-1===this.__selectedCell.columnIndex?row.find("td.TcHmi_Controls_Beckhoff_TcHmiDatagrid-template-row-numbers").addClass("focused"):row.find(`td[data-column=${this.__selectedCell.columnIndex}]`).addClass("focused"))}}setSelectedColumnIndex(valueNew){let convertedValue=TcHmi.ValueConverter.toNumber(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("SelectedColumnIndex")),null!==this.__selectedCell&&convertedValue===this.__selectedCell.columnIndex||(null!==convertedValue?null===this.__selectedCell?this.__selectedCell={rowIndex:null,columnIndex:convertedValue}:this.__selectedCell.columnIndex=convertedValue:null!==this.__selectedCell&&(this.__selectedCell.columnIndex=-1),TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"SelectedColumnIndex"}),TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"selectedCellValue"}),this.__processSelectedColumnIndex())}getSelectedColumnIndex(){return null!==this.__selectedCell?this.__selectedCell.columnIndex:null}__processSelectedColumnIndex(){this.__processSelectedRowIndex()}getSrcDataHasChanged(){return this.__srcDataHasChanged}getSelectedCellValue(){if(this.__srcData&&null!==this.__selectedCell&&null!==this.__selectedCell.rowIndex&&this.__srcData.length>this.__selectedCell.rowIndex){if(this.__selectedCell.columnIndex>=0){let columnDefinition=this.__internalSrcColumn[this.__selectedCell.columnIndex],index=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);return-1===index?null:TcHmiDatagrid.isSimpleColumn(columnDefinition)?this.__srcData[index]:this.__readObjectProperty(this.__srcData[index],columnDefinition.name)}if(!this.__pagingInfo.usePaging&&this.__filterSortMap){let index=this.__filterSortMap.indexOf(this.__selectedCell.rowIndex);return-1!==index?index+1:null}{let index=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);return-1===index?null:index+1}}return null}getSelectedRowValue(){if(this.__srcData&&null!==this.__selectedCell&&null!==this.__selectedCell.rowIndex){let index=this.__originalIndexToSrcDataIndex(this.__selectedCell.rowIndex);if(-1===index)return null;if(this.__srcData.length>index)return this.__srcData[index]}return null}setWidthMode(valueNew){let convertedValue=TcHmi.ValueConverter.toSizeModeWithContent(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("WidthMode")),convertedValue!==this.__widthMode&&(this.__widthMode=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"WidthMode"}),this.__processWidthMode())}__getContentWidth(){if("Collapsed"===this.__visibility)return null;if("Content"!==this.__widthMode)return super.__getContentWidth();let width=this.__columnWidths.reduce((sum,columnWidth,currentIdx)=>0!==currentIdx||this.__showRowNumbers?sum+Math.max("px"===columnWidth.widthUnit?columnWidth.width:0,"px"===columnWidth.minWidthUnit?columnWidth.minWidth:0):sum,0);if(this.__isAttached){let dataScroll=this.__elementDataScroll[0];width+=dataScroll.offsetWidth-dataScroll.clientWidth}return 0!==width?width:null}__processWidth(){if("Content"===this.getWidthMode()){let contentWidth=this.__getContentWidth();if(contentWidth===this.__contentWidth)return;this.__contentWidth=contentWidth;let newWidthStr="";null!==contentWidth&&(newWidthStr=contentWidth+"px"),TcHmi.StyleProvider.setSimpleElementStyle(this.__element,"width",newWidthStr)}else this.__contentWidth=null;super.__processWidth()}setHeightMode(valueNew){let convertedValue=TcHmi.ValueConverter.toSizeModeWithContent(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("HeightMode")),convertedValue!==this.__heightMode&&(this.__heightMode=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"HeightMode"}),this.__processHeightMode())}__getContentHeight(){if("Collapsed"===this.__visibility)return null;if("Content"!==this.__heightMode)return super.__getContentHeight();let height=("px"===this.__headerHeightUnit&&this.__headerHeight||0)+this.__dataLength*(this.__rowHeight||0);if(this.__isAttached){let dataScroll=this.__elementDataScroll[0];height+=dataScroll.offsetHeight-dataScroll.clientHeight}return 0!==height?height:null}__processHeight(){if("Content"===this.getHeightMode()){let contentHeight=this.__getContentHeight();if(contentHeight===this.__contentHeight)return;this.__contentHeight=contentHeight,this.__intHeight=null!==contentHeight?contentHeight+"px":null}else this.__contentHeight=null;super.__processHeight()}__lock(row,column,rowElement,targetElement){if(this.__lockState&&this.__lockState.row===row&&this.__lockState.column===column&&this.__lockState.rowElement===rowElement)return;this.__lockState={row:row,column:column,propertyName:null,rowElement:rowElement,editStarted:!1,targetElement:targetElement};let internalColumn=this.__internalSrcColumn[column];TcHmiDatagrid.isSimpleColumn(internalColumn)||(this.__lockState.propertyName=internalColumn.name)}__unlock(){if(!this.__srcData||!this.__lockState)return;let start=this.__scrollInfo.firstIndex-this.__scrollInfo.buffer;start=start>0?start:0;let end=this.__scrollInfo.firstIndex+this.__scrollInfo.rowCount+this.__scrollInfo.buffer;end=end<=this.__dataLength?end:this.__dataLength;let lockedRowIndex=!this.__pagingInfo.usePaging&&this.__filterSortMap?this.__filterSortMap.indexOf(this.__originalIndexToSrcDataIndex(this.__lockState.row)):this.__originalIndexToSrcDataIndex(this.__lockState.row),lockedRowElement=this.__lockState.rowElement;this.__lockState=null;let tableBody=this.__elementDataTableBody[0];-1===lockedRowIndex||lockedRowElement.classList.contains("hidden")?tableBody.removeChild(lockedRowElement):lockedRowIndex<start&&tableBody.firstElementChild?tableBody.removeChild(tableBody.firstElementChild):lockedRowIndex>=end&&tableBody.lastElementChild&&tableBody.removeChild(tableBody.lastElementChild)}__srcDataIndexToOriginalIndex(index){return this.__pagingInfo.usePaging&&void 0===(index=this.__pagingInfo.filterMap[index-this.__pagingInfo.actualOffset])?-1:index}__originalIndexToSrcDataIndex(index){return this.__pagingInfo.usePaging&&-1!==(index=this.__pagingInfo.filterMap.indexOf(index))&&(index+=this.__pagingInfo.actualOffset),index}__processIsEnabled(){super.__processIsEnabled(),!this.getIsEnabled()&&this.__selectedCombobox&&this.__closeCombobox()}}Beckhoff.TcHmiDatagrid=TcHmiDatagrid,function(TcHmiDatagrid){TcHmiDatagrid.isSimpleColumn=function(obj){return obj&&void 0===obj.name}}(TcHmiDatagrid=Beckhoff.TcHmiDatagrid||(Beckhoff.TcHmiDatagrid={}))}(Beckhoff=Controls.Beckhoff||(Controls.Beckhoff={}))}(Controls=TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),TcHmi.Controls.registerEx("TcHmiDatagrid","TcHmi.Controls.Beckhoff",TcHmi.Controls.Beckhoff.TcHmiDatagrid);