var TcHmi;!function(TcHmi){let Controls;!function(Controls){let System;!function(System){class TcHmiGrid extends TcHmi.Controls.System.TcHmiContainerControl{constructor(element,pcElement,attrs){super(element,pcElement,attrs),this.__cacheWidthPerColumn=null,this.__cacheHeightPerRow=null,this.__roughLayoutKnown=!1,this.__cacheCellHeightPerRow=null,this.__onControlGridRowIndexChangedDestroyEvent=null,this.__onControlGridColumnIndexChangedDestroyEvent=null,this.__onControlsMovedDestroyEvent=null,this.__onControlsResizedDestroyEvent=null,this.__onControlPositionParameterChangedDestroyEvent=null,this.__onControlSizeParameterChangedDestroyEvent=null,this.__controlStretchedWidth=!1,this.__controlStretchedHeight=!1,this.__wrapCheckNeeded=!1,this.__onGridRowOrColumnIndexChanged=(e,ctrl)=>{if(ctrl.getParent()!==this)return;const ControlGridRowIndex=ctrl.getGridRowIndex(),ControlGridColumnIndex=ctrl.getGridColumnIndex();if(void 0===ControlGridRowIndex||void 0===ControlGridColumnIndex)return;let currentParentRowIndex=-1,currentParentColumnIndex=-1;const columnHolder=ctrl.getElement()[0].parentElement;if(columnHolder&&columnHolder.parentElement&&columnHolder.parentElement.parentElement){let tempIdx=columnHolder.parentElement.parentElement.getAttribute("data-tchmi-row-index");tempIdx&&(currentParentRowIndex=parseInt(tempIdx,10)),tempIdx=columnHolder.parentElement.getAttribute("data-tchmi-column-index"),tempIdx&&(currentParentColumnIndex=parseInt(tempIdx,10))}ControlGridRowIndex===currentParentRowIndex&&ControlGridColumnIndex===currentParentColumnIndex||(this.__correctGridPosition(ctrl),this.__asyncWorkData["System.TcHmiGrid.triggerRebuildAll"]=!0,this.__requestAsyncWork(),this.__roughLayoutKnown=!1)},this.__onControlGeometryChanged=(e,controls)=>{let move="System.onControlPositionParameterChanged"===e.name||"System.onControlsMoved"===e.name,workNeeded=!1;if(!this.__asyncWorkData["System.TcHmiGrid.triggerRebuildAll"]||!this.__asyncWorkData["System.TcHmiGrid.triggerRecheckHeight"])for(let i=0;i<controls.length;i++){let ctrl=controls[i];if(ctrl.getParent()===this){if(this.__cacheWidthPerColumn=null,this.__cacheHeightPerRow=null,this.__cacheCellHeightPerRow=null,workNeeded=!0,this.__asyncWorkData["System.TcHmiGrid.triggerRebuildAll"]=!0,this.__asyncWorkData["System.TcHmiGrid.triggerRecheckHeight"])break}else if(!1===move&&ctrl===this&&(workNeeded=!0,this.__asyncWorkData["System.TcHmiGrid.triggerRecheckHeight"]=!0,this.__asyncWorkData["System.TcHmiGrid.triggerRebuildAll"]))break}workNeeded&&this.__requestAsyncWork()},this.__onResolverForRowOptionsWatchCallback=data=>{!1===this.__isAttached&&this.__suspendObjectResolver("rowOptions"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__rowOptions)||(this.__rowOptions=data.value,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RowOptions"}),this.__recalculateRowCount(),this.__recalculateColumnCount(),this.__processCellOptions(),this.__asyncWorkData["System.TcHmiGrid.triggerRebuildAll"]=!0,this.__requestAsyncWork()):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.System.TcHmiGrid, Id="+this.getId()+", Attribute=RowOptions] Resolving symbols from object failed with error: "+TcHmi.Log.buildMessage(data.details))},this.__onResolverForColumnOptionsWatchCallback=data=>{!1===this.__isAttached&&this.__suspendObjectResolver("columnOptions"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__columnOptions)||(this.__columnOptions=data.value,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ColumnOptions"}),this.__recalculateColumnCount(),this.__processCellOptions(),this.__asyncWorkData["System.TcHmiGrid.triggerRebuildAll"]=!0,this.__requestAsyncWork()):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.System.TcHmiGrid, Id="+this.getId()+", Attribute=ColumnOptions] Resolving symbols from object failed with error: "+TcHmi.Log.buildMessage(data.details))},this.__onResolverForCellOptionsWatchCallback=data=>{!1===this.__isAttached&&this.__suspendObjectResolver("cellOptions"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__cellOptions)||(this.__cellOptions=data.value,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"CellOptions"}),this.__processCellOptions(),this.__asyncWorkData["System.TcHmiGrid.triggerRebuildAll"]=!0,this.__requestAsyncWork()):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.System.TcHmiGrid, Id="+this.getId()+", Attribute=CellOptions] Resolving symbols from object failed with error: "+TcHmi.Log.buildMessage(data.details))},this.__onControlGridRowIndexChangedDestroyEvent=TcHmi.EventProvider.register("System.onControlGridRowIndexChanged",this.__onGridRowOrColumnIndexChanged),this.__onControlGridColumnIndexChangedDestroyEvent=TcHmi.EventProvider.register("System.onControlGridColumnIndexChanged",this.__onGridRowOrColumnIndexChanged),this.__onControlPositionParameterChangedDestroyEvent=TcHmi.EventProvider.register("System.onControlPositionParameterChanged",this.__onControlGeometryChanged),this.__onControlSizeParameterChangedDestroyEvent=TcHmi.EventProvider.register("System.onControlSizeParameterChanged",this.__onControlGeometryChanged),this.__asyncWorkData["System.TcHmiGrid.triggerRebuildAll"]=!1,this.__asyncWorkData["System.TcHmiGrid.triggerRecheckHeight"]=!1,this.__asyncWorkData["System.TcHmiGrid.triggerProcessHeight"]=!1,this.__asyncWorkData["System.TcHmiGrid.triggerProcessWidth"]=!1}__previnit(){if(this.__elementTemplateRoot=this.__element.find(".TcHmi_Controls_System_TcHmiGrid-template"),0===this.__elementTemplateRoot.length&&(this.__elementTemplateRoot=this.__element.find(".tchmi-grid-template")),0===this.__elementTemplateRoot.length)throw new Error("Invalid Template.html");let gridDiv=this.__elementTemplateRoot[0].getElementsByClassName("TcHmi_Controls_System_TcHmiGrid-grid")[0];gridDiv?this.__elementGridcontainer=$(gridDiv):(this.__elementGridcontainer=$(document.createElement("div")),this.__elementGridcontainer[0].setAttribute("class","tchmi-box TcHmi_Controls_System_TcHmiGrid-grid tchmi-grid-grid"),this.__elementTemplateRoot[0].appendChild(this.__elementGridcontainer[0])),super.__previnit()}__init(){super.__init()}__attach(){super.__attach(),this.__onControlsMovedDestroyEvent=TcHmi.EventProvider.register("System.onControlsMoved",this.__onControlGeometryChanged),this.__onControlsResizedDestroyEvent=TcHmi.EventProvider.register("System.onControlsResized",this.__onControlGeometryChanged),this.__wrapCheckNeeded&&this.__rebuildCellHeightPerRowCache()}__detach(){super.__detach(),null!==this.__onControlsMovedDestroyEvent&&(this.__onControlsMovedDestroyEvent(),this.__onControlsMovedDestroyEvent=null),null!==this.__onControlsResizedDestroyEvent&&(this.__onControlsResizedDestroyEvent(),this.__onControlsResizedDestroyEvent=null)}destroy(){this.__keepAlive||(null!==this.__onControlGridRowIndexChangedDestroyEvent&&(this.__onControlGridRowIndexChangedDestroyEvent(),this.__onControlGridRowIndexChangedDestroyEvent=null),null!==this.__onControlGridColumnIndexChangedDestroyEvent&&(this.__onControlGridColumnIndexChangedDestroyEvent(),this.__onControlGridColumnIndexChangedDestroyEvent=null),null!==this.__onControlPositionParameterChangedDestroyEvent&&(this.__onControlPositionParameterChangedDestroyEvent(),this.__onControlPositionParameterChangedDestroyEvent=null),null!==this.__onControlSizeParameterChangedDestroyEvent&&(this.__onControlSizeParameterChangedDestroyEvent(),this.__onControlSizeParameterChangedDestroyEvent=null),super.destroy())}addChild(control,pos){control&&this.__addChild(control,pos)}__addChild(control,pos){super.__addChild(control,pos),this.__correctGridPosition(control,pos),this.__cacheWidthPerColumn=null,this.__cacheHeightPerRow=null,this.__cacheCellHeightPerRow=null,this.__roughLayoutKnown=!1}removeChild(control){control&&this.__removeChild(control)}__removeChild(control){super.__removeChild(control),!0!==this.__isDestroyed&&(this.__cacheWidthPerColumn=null,this.__cacheHeightPerRow=null,this.__cacheCellHeightPerRow=null,this.__asyncWorkData["System.TcHmiGrid.triggerRebuildAll"]=!0,this.__requestAsyncWork(),this.__roughLayoutKnown=!1)}__doAsyncWork(){super.__doAsyncWork(),this.__isDestroyed||(this.__isAttached||!this.__roughLayoutKnown?(this.__asyncWorkData["System.TcHmiGrid.triggerRebuildAll"]&&(this.__processColumnOptions(),this.__processRowOptions(),this.__processWidthAsync(),this.__asyncWorkData["System.TcHmiGrid.triggerProcessWidth"]=!1,this.__asyncWorkData["System.TcHmiGrid.triggerProcessHeight"]=!1),this.__asyncWorkData["System.TcHmiGrid.triggerRecheckHeight"]&&this.__rebuildCellHeightPerRowCache(),this.__asyncWorkData["System.TcHmiGrid.triggerProcessWidth"]&&(this.__processWidthAsync(),this.__asyncWorkData["System.TcHmiGrid.triggerProcessWidth"]=!1,this.__asyncWorkData["System.TcHmiGrid.triggerProcessHeight"]=!1),this.__asyncWorkData["System.TcHmiGrid.triggerProcessHeight"]&&(this.__processHeightAsync(),this.__asyncWorkData["System.TcHmiGrid.triggerProcessHeight"]=!1),this.__asyncWorkData["System.TcHmiGrid.triggerRebuildAll"]=!1,this.__asyncWorkData["System.TcHmiGrid.triggerRecheckHeight"]=!1):this.__wrapCheckNeeded=!0)}__rebuildCellHeightPerRowCache(){if(this.__columnOptions)if(this.__element[0].isConnected){let cellHeightPerRow=1;const allColumnsInFirstRow=this.__elementGridcontainer[0].firstElementChild.children;for(const cell of allColumnsInFirstRow)cell.previousElementSibling&&0!==cell.offsetWidth&&0===cell.offsetLeft&&cellHeightPerRow++;if(this.__wrapCheckNeeded=!1,cellHeightPerRow!==this.__cacheCellHeightPerRow)return this.__cacheCellHeightPerRow=cellHeightPerRow,this.__processHeight(),!0}else this.__cacheCellHeightPerRow=null,this.__wrapCheckNeeded=!0;return!1}getCellWrap(){return this.__cellWrap}setCellWrap(valueNew){let convertedValue=TcHmi.ValueConverter.toBoolean(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("CellWrap")),convertedValue!==this.__cellWrap&&(this.__cellWrap=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"CellWrap"}),this.__processCellWrap())}__processCellWrap(){const allRows=this.__elementGridcontainer[0].children;this.__cellWrap?TcHmi.StyleProvider.setSimpleElementStyle(allRows,"flex-wrap","wrap"):TcHmi.StyleProvider.setSimpleElementStyle(allRows,"flex-wrap",""),this.__processWidth()}
/**
                * Returns if inner widths depends on child controls.
                * @preserve (Part of the public API)
                */innerWidthDependsOnChilds(){if(this.__controlStretchedWidth)return!0;if(this.__columnOptions)for(const columnOption of this.__columnOptions)if("Content"===columnOption.widthMode)return!0;return super.innerWidthDependsOnChilds()}
/**
                * Updates the inner dimension depending on child controls.
                * @preserve (Part of the public API)
                */updateInnerWidthDependingOnChilds(){this.__cacheWidthPerColumn=null,this.__asyncWorkData["System.TcHmiGrid.triggerRebuildAll"]=!0,this.__requestAsyncWork()}__processWidthMode(){this.__cacheWidthPerColumn=null,this.__cacheHeightPerRow=null,this.__cacheCellHeightPerRow=null,super.__processWidthMode()}
/**
                * Returns if inner heights depends on child controls.
                * @preserve (Part of the public API)
                */innerHeightDependsOnChilds(){if(this.__controlStretchedHeight)return!0;if(this.__rowOptions)for(const rowOption of this.__rowOptions)if("Content"===rowOption.heightMode)return!0;return super.innerHeightDependsOnChilds()}
/**
                * Updates the inner dimension depending on child controls.
                * @preserve (Part of the public API)
                */updateInnerHeightDependingOnChilds(){this.__cacheWidthPerColumn=null,this.__asyncWorkData["System.TcHmiGrid.triggerRebuildAll"]=!0,this.__asyncWorkData["System.TcHmiGrid.triggerRecheckHeight"]=!0,this.__requestAsyncWork()}__processHeightMode(){this.__cacheWidthPerColumn=null,this.__cacheHeightPerRow=null,this.__cacheCellHeightPerRow=null,super.__processHeightMode()}__recalculateRowCount(){if(!this.__rowOptions)return;const oldRows=this.__elementGridcontainer[0].children;if(this.__rowOptions.length!==oldRows.length){if(this.__rowOptions.length>oldRows.length)this.__appendRows(this.__rowOptions.length-oldRows.length);else if(this.__rowOptions.length<oldRows.length){const removedControlElems=this.__removeRows(oldRows.length-this.__rowOptions.length).children().children().children();for(let i=0,ii=removedControlElems.length;i<ii;i++){const co=TcHmi.Controls.get(removedControlElems[i].id);void 0!==co&&this.__correctGridPosition(co)}}TcHmi.EventProvider.raise("System.onControlGetRowCountChanged",this)}}__recalculateColumnCount(){if(!this.__columnOptions)return;let addedColumns=[],removedCells=[];const allRows=this.__elementGridcontainer[0].children;for(let i=0,ii=allRows.length;i<ii;i++){const row=allRows[i],liveSubColumns=row.children;if(liveSubColumns.length===this.__columnOptions.length);else if(liveSubColumns.length<this.__columnOptions.length)addedColumns=addedColumns.concat(this.__createColumns(row));else if(liveSubColumns.length>this.__columnOptions.length)for(;liveSubColumns.length>this.__columnOptions.length;){const removedstuff=liveSubColumns[liveSubColumns.length-1];removedstuff.remove(),removedCells.push(removedstuff)}}if(addedColumns.length>0)this.__correctAllGridPositions(),TcHmi.EventProvider.raise("System.onControlGetColumnCountChanged",this);else if(removedCells.length>0){const removedControlElems=[];removedCells.forEach(elem=>{for(let i=0;i<elem.children.length;i++)for(let j=0;j<elem.children[i].children.length;j++)removedControlElems.push(elem.children[i].children[j])});for(let i=0,ii=removedControlElems.length;i<ii;i++){const co=TcHmi.Controls.get(removedControlElems[i].id);void 0!==co&&this.__correctGridPosition(co)}TcHmi.EventProvider.raise("System.onControlGetColumnCountChanged",this)}}getRowOptions(){return this.__rowOptions}setRowOptions(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew);if(null!==convertedValue&&0!==convertedValue.length||(convertedValue=this.getAttributeDefaultValueInternal("RowOptions")),!Array.isArray(convertedValue))return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.System.TcHmiGrid, Id="+this.getId()+", Attribute=RowOptions] Non array value ist not supported."));let resolverInfo=this.__objectResolvers.get("rowOptions");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue);this.__objectResolvers.set("rowOptions",{resolver:resolver,watchCallback:this.__onResolverForRowOptionsWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForRowOptionsWatchCallback)})}__processRowOptions(){return this.__processSequenceOptions(1)}getColumnOptions(){return this.__columnOptions}setColumnOptions(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew);if(null!==convertedValue&&0!==convertedValue.length||(convertedValue=this.getAttributeDefaultValueInternal("ColumnOptions")),!Array.isArray(convertedValue))return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.System.TcHmiGrid, Id="+this.getId()+", Attribute=ColumnOptions] Non array value ist not supported."));let resolverInfo=this.__objectResolvers.get("columnOptions");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue);this.__objectResolvers.set("columnOptions",{resolver:resolver,watchCallback:this.__onResolverForColumnOptionsWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForColumnOptionsWatchCallback)})}__processColumnOptions(){return this.__recalculateColumnCount(),this.__processSequenceOptions(0)}getCellOptions(){return this.__cellOptions}setCellOptions(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew);if(null!==convertedValue&&0!==convertedValue.length||(convertedValue=this.getAttributeDefaultValueInternal("CellOptions")),!Array.isArray(convertedValue))return void(TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.error("[Source=Control, Module=TcHmi.Controls.System.TcHmiGrid, Id="+this.getId()+", Attribute=CellOptions] Non array value ist not supported."));let resolverInfo=this.__objectResolvers.get("cellOptions");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue);this.__objectResolvers.set("cellOptions",{resolver:resolver,watchCallback:this.__onResolverForCellOptionsWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForCellOptionsWatchCallback)})}__processCellOptions(){if(!this.__cellOptions)return;const targetRows=this.__elementGridcontainer[0].children;for(let rowCounter=0;rowCounter<targetRows.length;rowCounter++){const cellsInRow=targetRows[rowCounter].children;for(let columnCounter=0;columnCounter<cellsInRow.length;columnCounter++){const cell=cellsInRow[columnCounter];let borderWidth=null,borderStyle=null,borderColor=null,cellPadding=null,background={color:null,image:null,imageWidth:null,imageWidthUnit:"px",imageHeight:null,imageHeightUnit:"px",imageHorizontalAlignment:"Center",imageVerticalAlignment:"Center",imagePadding:null};for(const oneCellOptions of this.__cellOptions)if(oneCellOptions.columnIndex===columnCounter&&oneCellOptions.rowIndex===rowCounter){oneCellOptions.borderWidth&&(borderWidth=oneCellOptions.borderWidth),oneCellOptions.borderStyle&&(borderStyle=oneCellOptions.borderStyle),oneCellOptions.borderColor&&(borderColor=oneCellOptions.borderColor),oneCellOptions.padding&&(cellPadding=oneCellOptions.padding),oneCellOptions.backgroundColor&&(background.color=oneCellOptions.backgroundColor),oneCellOptions.backgroundImage&&(background.image=oneCellOptions.backgroundImage),oneCellOptions.backgroundImagePadding&&(background.imagePadding=oneCellOptions.backgroundImagePadding),oneCellOptions.backgroundImageWidth&&(background.imageWidth=oneCellOptions.backgroundImageWidth),oneCellOptions.backgroundImageWidthUnit&&(background.imageWidthUnit=oneCellOptions.backgroundImageWidthUnit),oneCellOptions.backgroundImageHeight&&(background.imageHeight=oneCellOptions.backgroundImageHeight),oneCellOptions.backgroundImageHeightUnit&&(background.imageHeightUnit=oneCellOptions.backgroundImageHeightUnit),oneCellOptions.backgroundImageHorizontalAlignment&&(background.imageHorizontalAlignment=oneCellOptions.backgroundImageHorizontalAlignment),oneCellOptions.backgroundImageVerticalAlignment&&(background.imageVerticalAlignment=oneCellOptions.backgroundImageVerticalAlignment);break}TcHmi.StyleProvider.processBackground(cell,background),TcHmi.StyleProvider.processBorderWidth(cell,borderWidth),TcHmi.StyleProvider.processBorderStyle(cell,borderStyle),TcHmi.StyleProvider.processBorderColor(cell,borderColor),TcHmi.StyleProvider.processContentPadding(cell,cellPadding);const cellpaddingmover=cell.firstElementChild;cellPadding&&(cellPadding.right||cellPadding.left||cellPadding.top||cellPadding.bottom)?TcHmi.StyleProvider.setSimpleElementStyle(cellpaddingmover,{height:"calc(100% - ("+(cellPadding.top||0)+(cellPadding.topUnit||"px")+") - ("+(cellPadding.bottom||0)+(cellPadding.bottomUnit||"px")+"))",width:"calc(100% - ("+(cellPadding.left||0)+(cellPadding.leftUnit||"px")+") - ("+(cellPadding.right||0)+(cellPadding.rightUnit||"px")+"))"}):TcHmi.StyleProvider.setSimpleElementStyle(cellpaddingmover,{height:"",width:""})}}}__correctAllGridPositions(){for(const co of this.__children)this.__correctGridPosition(co)}__correctGridPosition(control,pos=null){if(!this.__rowOptions||!this.__columnOptions)return;const ControlGridRowIndex=control.getGridRowIndex(),ControlGridColumnIndex=control.getGridColumnIndex();if(void 0===ControlGridRowIndex||void 0===ControlGridColumnIndex)return;let targetRow;const allRows=this.__elementGridcontainer[0].children;if(targetRow=ControlGridRowIndex>=allRows.length?allRows[0]:allRows[ControlGridRowIndex],!targetRow)throw new Error("TcHmiGrid: Error finding Row "+ControlGridRowIndex+"!");let targetColumn,targetColumns=targetRow.children;if(targetColumn=ControlGridColumnIndex>=targetColumns.length?targetColumns[0]:targetColumns[ControlGridColumnIndex],!targetColumn)throw new Error("TcHmiGrid: Error finding Column "+ControlGridColumnIndex+"!");if(null!==pos&&pos>=0){let localPos=pos;for(let siblingIndex=0;siblingIndex<this.__children.length;siblingIndex++){const sibling=this.__children[siblingIndex];if(sibling===control)break;let siblingRowIndex=sibling.getGridRowIndex(),siblingColumnIndex=sibling.getGridColumnIndex();(void 0===siblingRowIndex||siblingRowIndex>=this.__rowOptions.length)&&(siblingRowIndex=0),(void 0===siblingColumnIndex||siblingColumnIndex>=this.__columnOptions.length)&&(siblingColumnIndex=0),siblingRowIndex>ControlGridRowIndex?localPos--:siblingRowIndex<ControlGridRowIndex||siblingColumnIndex>ControlGridColumnIndex&&localPos--}if(0===localPos)targetColumn.firstElementChild.appendChild(control.getElement()[0]);else{const prevSibl=targetColumn.firstElementChild.children[localPos-1];prevSibl?prevSibl.after(control.getElement()[0]):targetColumn.firstElementChild.appendChild(control.getElement()[0])}}else targetColumn.firstElementChild.appendChild(control.getElement()[0])}__appendRows(num=1){let allNewRows=[];for(let count=1;count<=num;count++){const rowIndex=this.__elementGridcontainer[0].childElementCount,newRow=document.createElement("div");newRow.id=this.__id+"_row"+rowIndex,newRow.setAttribute("data-tchmi-row-index",rowIndex.toString()),newRow.setAttribute("class","tchmi-box TcHmi_Controls_System_TcHmiGrid-gridrow tchmi-grid-gridrow"),this.__elementGridcontainer[0].appendChild(newRow),allNewRows.push(newRow)}return this.__cellWrap?TcHmi.StyleProvider.setSimpleElementStyle(allNewRows,"flex-wrap","wrap"):TcHmi.StyleProvider.setSimpleElementStyle(allNewRows,"flex-wrap",""),allNewRows}__removeRows(num=1){return this.__elementGridcontainer.children().slice(-num).detach()}__createColumns(targetRow){let targetColumns=[];for(;this.__columnOptions&&this.__columnOptions.length>targetRow.childElementCount;)targetColumns.push(this.__createCell(targetRow));return targetColumns}__createCell(targetRow){const columnIndex=targetRow.childElementCount,gridCell=document.createElement("div");gridCell.id=targetRow.id+"_col"+columnIndex,gridCell.setAttribute("data-tchmi-column-index",columnIndex.toString()),gridCell.setAttribute("class","tchmi-box TcHmi_Controls_System_TcHmiGrid-gridcell tchmi-grid-gridcell");const paddingMover=document.createElement("div");return paddingMover.setAttribute("class","TcHmi_Controls_System_TcHmiGrid-cellpaddingmover tchmi-grid-cellpaddingmover"),gridCell.appendChild(paddingMover),targetRow.appendChild(gridCell),gridCell}__processSequenceOptions(direction){if(!this.__rowOptions||!this.__columnOptions)return;let sequenceLength,sequenceSizename="width";1===direction?(sequenceSizename="height",sequenceLength=this.__rowOptions.length):sequenceLength=this.__columnOptions.length;let sequenceContentSizeList=[],sequenceContentSizeListReason=[],sequenceCacheSizeList=[];const allRows=this.__elementGridcontainer[0].children,contentMaxWidth=[],contentMaxWidthReason=[];for(let rowCounter=0;rowCounter<allRows.length;rowCounter++){const cellsInRow=allRows[rowCounter].children,contentMaxHeightInRow=[],contentMaxHeightInRowReason=[];for(let columnCounter=0;columnCounter<cellsInRow.length;columnCounter++){const cell=cellsInRow[columnCounter],allControlsElems=cell.firstElementChild.children;let contentCellHeight=0,contentCellWidth=0,cellPaddingHeight=0,cellPaddingWidth=0;if(1===direction){const cellStyle=TcHmi.StyleProvider.getSimpleElementStyle(cell,["border-top-width","border-width","padding-top","padding","padding-bottom","border-bottom-width"]);cellPaddingHeight+=TcHmiGrid.__getPixelNumberInStyle(cellStyle,"border-top-width","border-width"),cellPaddingHeight+=TcHmiGrid.__getPixelNumberInStyle(cellStyle,"padding-top","padding"),cellPaddingHeight+=TcHmiGrid.__getPixelNumberInStyle(cellStyle,"padding-bottom","padding"),cellPaddingHeight+=TcHmiGrid.__getPixelNumberInStyle(cellStyle,"border-bottom-width","border-width"),contentCellHeight=cellPaddingHeight}else{const cellStyle=TcHmi.StyleProvider.getSimpleElementStyle(cell,["border-left-width","border-width","padding-left","padding","padding-right","border-right-width"]);cellPaddingWidth+=TcHmiGrid.__getPixelNumberInStyle(cellStyle,"border-left-width","border-width"),cellPaddingWidth+=TcHmiGrid.__getPixelNumberInStyle(cellStyle,"padding-left","padding"),cellPaddingWidth+=TcHmiGrid.__getPixelNumberInStyle(cellStyle,"padding-right","padding"),cellPaddingWidth+=TcHmiGrid.__getPixelNumberInStyle(cellStyle,"border-right-width","border-width"),contentCellWidth=cellPaddingWidth}let reasonOfDimension="borderAndPadding";for(let controlInCellCounter=0;controlInCellCounter<allControlsElems.length;controlInCellCounter++){const controlElem=allControlsElems[controlInCellCounter],ctrl=TcHmi.Controls.get(controlElem.id);if(void 0===ctrl)continue;let sizeDefinitionCount=0;if(1===direction){let cellHeightForControl=cellPaddingHeight;const ctrlTopValue=ctrl.getTop();null!=ctrlTopValue&&("px"===ctrl.getTopUnit()&&(cellHeightForControl+=ctrlTopValue),sizeDefinitionCount++);const ctrlContentHeight=ctrl.__getContentHeight();null!==ctrlContentHeight&&(cellHeightForControl+=ctrlContentHeight,sizeDefinitionCount++);const ctrlBottomValue=ctrl.getBottom();null!=ctrlBottomValue&&2!==sizeDefinitionCount&&"px"===ctrl.getBottomUnit()&&(cellHeightForControl+=ctrlBottomValue),cellHeightForControl>contentCellHeight&&(contentCellHeight=cellHeightForControl,reasonOfDimension=ctrl.getId())}else{let cellWidthForControl=cellPaddingWidth;sizeDefinitionCount=0;const ctrlLeftValue=ctrl.getLeft();null!=ctrlLeftValue&&("px"===ctrl.getLeftUnit()&&(cellWidthForControl+=ctrlLeftValue),sizeDefinitionCount++);const ctrlContentWidth=ctrl.__getContentWidth();null!==ctrlContentWidth&&(cellWidthForControl+=ctrlContentWidth,sizeDefinitionCount++);const ctrlRightValue=ctrl.getRight();null!=ctrlRightValue&&2!==sizeDefinitionCount&&"px"===ctrl.getRightUnit()&&(cellWidthForControl+=ctrlRightValue),cellWidthForControl>contentCellWidth&&(contentCellWidth=cellWidthForControl,reasonOfDimension=ctrl.getId())}}1===direction?(contentMaxHeightInRow.push(contentCellHeight),contentMaxHeightInRowReason.push(reasonOfDimension)):(void 0===contentMaxWidth[columnCounter]&&(contentMaxWidth[columnCounter]=[],contentMaxWidthReason[columnCounter]=[]),contentMaxWidth[columnCounter].push(contentCellWidth),contentMaxWidthReason[columnCounter].push(reasonOfDimension))}if(1===direction){const usedRowHeight=Math.max.apply(null,contentMaxHeightInRow);0===usedRowHeight||usedRowHeight===1/0||usedRowHeight===-1/0||isNaN(usedRowHeight)?(sequenceContentSizeList[rowCounter]=null,sequenceContentSizeListReason[rowCounter]="unspecified"):(sequenceContentSizeList[rowCounter]=usedRowHeight,sequenceContentSizeListReason[rowCounter]=contentMaxHeightInRowReason[contentMaxHeightInRow.indexOf(usedRowHeight)])}}if(0===direction)for(let columnCounter=0;columnCounter<this.__columnOptions.length;columnCounter++){let usedColumnWidth=Math.max.apply(null,contentMaxWidth[columnCounter]);0===usedColumnWidth||usedColumnWidth===1/0||usedColumnWidth===-1/0||isNaN(usedColumnWidth)?(sequenceContentSizeList[columnCounter]=null,sequenceContentSizeListReason[columnCounter]="unspecified"):(sequenceContentSizeList[columnCounter]=usedColumnWidth,sequenceContentSizeListReason[columnCounter]=contentMaxWidthReason[columnCounter][contentMaxWidth[columnCounter].indexOf(usedColumnWidth)])}this.__controlStretchedHeight=!1;for(let sequenceCount=0;sequenceCount<sequenceLength;sequenceCount++){let fixedSize=!1;sequenceCacheSizeList[sequenceCount]=null;let targetRow=[];const relevantCells=[],sequenceCountStr=sequenceCount.toString();if(1===direction)for(let i=0;i<allRows.length;i++){const row=allRows[i];if(row.getAttribute("data-tchmi-row-index")===sequenceCountStr){targetRow.push(row);const cells=row.children;for(let j=0;j<cells.length;j++)relevantCells.push(cells[j]);break}}else for(let i=0;i<allRows.length;i++){let cells=allRows[i].children;for(let j=0;j<cells.length;j++){let cell=cells[j];cell.getAttribute("data-tchmi-column-index")===sequenceCountStr&&relevantCells.push(cell)}}let sequenceContentSizeReason="unspecified",newCellCss={},sequenceOption={size:null,sizeUnit:"px",sizeMode:"Value",minSize:null,minSizeUnit:"px",maxSize:null,maxSizeUnit:"px",overflow:!1};1===direction&&sequenceCount<this.__rowOptions.length?(sequenceOption.size=this.__rowOptions[sequenceCount].height,sequenceOption.sizeUnit=this.__rowOptions[sequenceCount].heightUnit,sequenceOption.sizeMode=this.__rowOptions[sequenceCount].heightMode,sequenceOption.minSize=this.__rowOptions[sequenceCount].minHeight,sequenceOption.minSizeUnit=this.__rowOptions[sequenceCount].minHeightUnit,sequenceOption.maxSize=this.__rowOptions[sequenceCount].maxHeight,sequenceOption.maxSizeUnit=this.__rowOptions[sequenceCount].maxHeightUnit,sequenceOption.overflow=this.__rowOptions[sequenceCount].overflow):sequenceCount<this.__columnOptions.length&&(sequenceOption.size=this.__columnOptions[sequenceCount].width,sequenceOption.sizeUnit=this.__columnOptions[sequenceCount].widthUnit,sequenceOption.sizeMode=this.__columnOptions[sequenceCount].widthMode,sequenceOption.minSize=this.__columnOptions[sequenceCount].minWidth,sequenceOption.minSizeUnit=this.__columnOptions[sequenceCount].minWidthUnit,sequenceOption.maxSize=this.__columnOptions[sequenceCount].maxWidth,sequenceOption.maxSizeUnit=this.__columnOptions[sequenceCount].maxWidthUnit,sequenceOption.overflow=this.__columnOptions[sequenceCount].overflow),"Content"===sequenceOption.sizeMode?("number"==typeof sequenceContentSizeList[sequenceCount]?(newCellCss[sequenceSizename]=sequenceContentSizeList[sequenceCount]+"px",sequenceContentSizeReason=sequenceContentSizeListReason[sequenceCount],sequenceCacheSizeList[sequenceCount]=sequenceContentSizeList[sequenceCount]):(newCellCss[sequenceSizename]="0px",sequenceContentSizeReason="zeroPixel",sequenceCacheSizeList[sequenceCount]=0),1===direction&&targetRow.length?TcHmi.StyleProvider.setSimpleElementStyle(targetRow,{height:"","flex-grow":"","-webkit-flex-grow":"","flex-basis":"","-webkit-flex-basis":""}):(newCellCss["flex-grow"]="",newCellCss["-webkit-flex-grow"]="",newCellCss["flex-basis"]="",newCellCss["-webkit-flex-basis"]="")):"number"==typeof sequenceOption.size?"px"===sequenceOption.sizeUnit?(fixedSize=!0,1===direction&&targetRow.length?(newCellCss[sequenceSizename]=sequenceOption.size+sequenceOption.sizeUnit,sequenceContentSizeReason="fixedPixelSize",sequenceCacheSizeList[sequenceCount]=sequenceOption.size,TcHmi.StyleProvider.setSimpleElementStyle(targetRow,{height:"","flex-grow":"","-webkit-flex-grow":"","flex-basis":"","-webkit-flex-basis":""})):(newCellCss[sequenceSizename]=sequenceOption.size+sequenceOption.sizeUnit,sequenceContentSizeReason="fixedPixelSize",sequenceCacheSizeList[sequenceCount]=sequenceOption.size,newCellCss["flex-grow"]="",newCellCss["-webkit-flex-grow"]="",newCellCss["flex-basis"]="",newCellCss["-webkit-flex-basis"]="")):"%"===sequenceOption.sizeUnit?(fixedSize=!0,1===direction&&targetRow.length?(newCellCss[sequenceSizename]="",sequenceContentSizeReason="fixedPercentSize",TcHmi.StyleProvider.setSimpleElementStyle(targetRow,{height:sequenceOption.size+sequenceOption.sizeUnit,"flex-grow":"","-webkit-flex-grow":"","flex-basis":"","-webkit-flex-basis":""})):(newCellCss[sequenceSizename]=sequenceOption.size+sequenceOption.sizeUnit,sequenceContentSizeReason="fixedPercentSize",newCellCss["flex-grow"]="",newCellCss["-webkit-flex-grow"]="",newCellCss["flex-basis"]="",newCellCss["-webkit-flex-basis"]="")):1===direction&&targetRow.length?(newCellCss[sequenceSizename]="",sequenceContentSizeReason="factorSize",TcHmi.StyleProvider.setSimpleElementStyle(targetRow,{height:"","flex-grow":sequenceOption.size.toString(),"-webkit-flex-grow":sequenceOption.size.toString(),"flex-basis":"0","-webkit-flex-basis":"0"})):(newCellCss[sequenceSizename]="",sequenceContentSizeReason="factorSize",newCellCss["flex-grow"]=sequenceOption.size.toString(),newCellCss["-webkit-flex-grow"]=sequenceOption.size.toString(),newCellCss["flex-basis"]="0",newCellCss["-webkit-flex-basis"]="0"):1===direction&&targetRow.length?(newCellCss[sequenceSizename]="",sequenceContentSizeReason="factorSizeAsFallback",TcHmi.StyleProvider.setSimpleElementStyle(targetRow,{height:"","flex-grow":"1","-webkit-flex-grow":"1","flex-basis":"0","-webkit-flex-basis":"0"})):(newCellCss[sequenceSizename]="",sequenceContentSizeReason="factorSizeAsFallback",newCellCss["flex-grow"]="1",newCellCss["-webkit-flex-grow"]="1",newCellCss["flex-basis"]="0",newCellCss["-webkit-flex-basis"]="0");let maxSize=1/0;if("number"==typeof sequenceOption.maxSize?("px"===sequenceOption.maxSizeUnit&&(null===sequenceCacheSizeList[sequenceCount]||sequenceCacheSizeList[sequenceCount]>sequenceOption.maxSize)&&(sequenceCacheSizeList[sequenceCount]=sequenceOption.maxSize,maxSize=sequenceOption.maxSize),1===direction&&targetRow.length?TcHmi.StyleProvider.setSimpleElementStyle(targetRow,"max-height",sequenceOption.maxSize+(sequenceOption.maxSizeUnit||"px")):newCellCss["max-"+sequenceSizename]=sequenceOption.maxSize+(sequenceOption.maxSizeUnit||"px")):1===direction&&targetRow.length?TcHmi.StyleProvider.setSimpleElementStyle(targetRow,"max-height",""):newCellCss["max-"+sequenceSizename]="","number"==typeof sequenceOption.minSize)"px"===sequenceOption.minSizeUnit&&(null===sequenceCacheSizeList[sequenceCount]||sequenceCacheSizeList[sequenceCount]<sequenceOption.minSize)&&(sequenceCacheSizeList[sequenceCount]=sequenceOption.minSize),1===direction&&targetRow.length?TcHmi.StyleProvider.setSimpleElementStyle(targetRow,"min-height",sequenceOption.minSize+(sequenceOption.minSizeUnit||"px")):newCellCss["min-"+sequenceSizename]=sequenceOption.minSize+(sequenceOption.minSizeUnit||"px");else{let minSize="";"number"==typeof sequenceContentSizeList[sequenceCount]&&0!==sequenceContentSizeList[sequenceCount]&&"Content"!==sequenceOption.sizeMode&&!1===fixedSize&&sequenceContentSizeList[sequenceCount]<maxSize?(minSize=sequenceContentSizeList[sequenceCount]+"px",sequenceContentSizeReason+="+influenced-by_"+sequenceContentSizeListReason[sequenceCount],(null===sequenceCacheSizeList[sequenceCount]||sequenceCacheSizeList[sequenceCount]<sequenceContentSizeList[sequenceCount])&&(sequenceCacheSizeList[sequenceCount]=sequenceContentSizeList[sequenceCount]),1===direction?this.__controlStretchedHeight=!0:this.__controlStretchedWidth=!0):minSize="",1===direction&&targetRow.length?TcHmi.StyleProvider.setSimpleElementStyle(targetRow,"min-height",minSize):newCellCss["min-"+sequenceSizename]=minSize}void 0!==sequenceOption.overflow&&null!==sequenceOption.overflow&&!0===sequenceOption.overflow?newCellCss["overflow-"+(1===direction?"y":"x")]="":newCellCss["overflow-"+(1===direction?"y":"x")]="hidden",TcHmi.StyleProvider.setSimpleElementStyle(relevantCells,newCellCss);for(let i=0;i<relevantCells.length;i++)relevantCells[i].setAttribute("data-tchmi-grid-calculation-base-"+sequenceSizename,sequenceContentSizeReason)}1===direction?tchmi_equal(this.__cacheHeightPerRow,sequenceCacheSizeList)||(TcHmi.EventProvider.raise("System.onGridCellResized",this),this.__cacheHeightPerRow=sequenceCacheSizeList):tchmi_equal(this.__cacheWidthPerColumn,sequenceCacheSizeList)||(TcHmi.EventProvider.raise("System.onGridCellResized",this),this.__cacheWidthPerColumn=sequenceCacheSizeList),this.__roughLayoutKnown=!0}__getContentWidth(){if("Collapsed"===this.__visibility)return null;let res=null;if("Content"!==this.getWidthMode())return super.__getContentWidth();if(null===this.__cacheWidthPerColumn&&this.__processColumnOptions(),null===this.__cacheWidthPerColumn)return null;for(const width of this.__cacheWidthPerColumn)null!==width&&(null===res?res=width:res+=width);const computedStyle=window.getComputedStyle(this.__element[0]),leftOffset=parseFloat(computedStyle.borderLeftWidth||"");0===leftOffset||isNaN(leftOffset)||(null===res?res=leftOffset:res+=leftOffset);const rightOffset=parseFloat(computedStyle.borderRightWidth||"");return 0===rightOffset||isNaN(rightOffset)||(null===res?res=rightOffset:res+=rightOffset),res}__getContentHeight(){if("Collapsed"===this.__visibility)return null;let res=null;if("Content"!==this.getHeightMode())return super.__getContentHeight();if(null===this.__cacheHeightPerRow&&this.__processRowOptions(),null===this.__cacheCellHeightPerRow&&this.__rebuildCellHeightPerRowCache(),null===this.__cacheCellHeightPerRow||null===this.__cacheHeightPerRow)return null;for(const height of this.__cacheHeightPerRow)null!==height&&(null===res?res=height*this.__cacheCellHeightPerRow:res+=height*this.__cacheCellHeightPerRow);const computedStyle=window.getComputedStyle(this.__element[0]),topOffset=parseFloat(computedStyle.borderTopWidth||"");0===topOffset||isNaN(topOffset)||(null===res?res=topOffset:res+=topOffset);const bottomOffset=parseFloat(computedStyle.borderBottomWidth||"");return 0===bottomOffset||isNaN(bottomOffset)||(null===res?res=bottomOffset:res+=bottomOffset),res}__processHeight(callerControl){if(!this.__rowOptions)return;let rowHeightMode="Value";if(this.innerHeightDependsOnChilds())rowHeightMode="Content";else for(const rowOption of this.__rowOptions)if("Content"===rowOption.heightMode){rowHeightMode="Content";break}"Content"===rowHeightMode?(callerControl&&(this.__cacheHeightPerRow=null,this.__cacheCellHeightPerRow=null),this.__asyncWorkData["System.TcHmiGrid.triggerProcessHeight"]=!0,this.__requestAsyncWork()):super.__processHeight()}__processHeightAsync(){if(!this.__rowOptions)return;let rowHeightMode="Value";if(this.innerHeightDependsOnChilds())rowHeightMode="Content";else for(const rowOption of this.__rowOptions)if("Content"===rowOption.heightMode){rowHeightMode="Content";break}if("Content"===rowHeightMode){let relativeContent=!1;for(let iter=0;iter<this.__rowOptions.length;iter++){if(!(iter<this.__rowOptions.length)){relativeContent=!0;break}{const rowOption=this.__rowOptions[iter];if("Content"!==rowOption.heightMode&&"px"!==rowOption.heightUnit){relativeContent=!0;break}}}if(this.__intHeight=null,relativeContent&&!this.innerHeightDependsOnChilds())null!==this.__height&&void 0!==this.__height&&void 0!==this.__heightUnit?this.__intHeight=this.__height+this.__heightUnit:this.__intHeight=null;else{const contentPixelSize=this.__getContentHeight();null!==contentPixelSize&&(this.__intHeight=contentPixelSize+"px")}System.TcHmiControl.prototype.__processHeight.call(this)}else super.__processHeight()}__processWidth(callerControl){if(!this.__columnOptions)return;let columnWidthMode="Value";if(this.innerWidthDependsOnChilds())columnWidthMode="Content";else for(const columnOption of this.__columnOptions)if("Content"===columnOption.widthMode){columnWidthMode="Content";break}"Content"===columnWidthMode?(callerControl&&(this.__cacheWidthPerColumn=null),this.__asyncWorkData["System.TcHmiGrid.triggerProcessWidth"]=!0,this.__requestAsyncWork()):super.__processWidth()}__processWidthAsync(){if(!this.__columnOptions)return;let columnWidthMode="Value";if(this.innerWidthDependsOnChilds())columnWidthMode="Content";else for(const columnOption of this.__columnOptions)if("Content"===columnOption.widthMode){columnWidthMode="Content";break}if("Content"===columnWidthMode){let relativeContent=!1;for(let iter=0;iter<this.__columnOptions.length;iter++){if(!(iter<this.__columnOptions.length)){relativeContent=!0;break}{const columnOption=this.__columnOptions[iter];if("Content"!==columnOption.widthMode&&"px"!==columnOption.widthUnit){relativeContent=!0;break}}}let newWidthStr=null;if(relativeContent&&!this.innerWidthDependsOnChilds())newWidthStr=null!==this.__width&&void 0!==this.__width&&void 0!==this.__widthUnit?this.__width+this.__widthUnit:null;else{const contentPixelSize=this.__getContentWidth();null!==contentPixelSize&&(newWidthStr=contentPixelSize+"px")}TcHmi.StyleProvider.setSimpleElementStyle(this.__element,"width",newWidthStr),System.TcHmiControl.prototype.__processWidth.call(this)}else super.__processWidth();this.__processHeightAsync()}static __getPixelNumberInStyle(cellStyle,longhandStylename,shorthandStylename){if(cellStyle[longhandStylename]&&-1!==cellStyle[longhandStylename].indexOf("px"))return parseFloat(cellStyle[longhandStylename]);if(void 0!==shorthandStylename&&cellStyle[shorthandStylename]&&-1!==cellStyle[shorthandStylename].indexOf("px")){const shorthandValueArr=cellStyle[shorthandStylename].split(" ");switch(shorthandValueArr.length){case 1:return parseFloat(shorthandValueArr[0]);case 2:return-1!==longhandStylename.indexOf("top")||-1!==longhandStylename.indexOf("bottom")?parseFloat(shorthandValueArr[0]):parseFloat(shorthandValueArr[1]);case 3:return-1!==longhandStylename.indexOf("top")?parseFloat(shorthandValueArr[0]):-1!==longhandStylename.indexOf("right")||-1!==longhandStylename.indexOf("left")?parseFloat(shorthandValueArr[1]):parseFloat(shorthandValueArr[2]);case 4:return-1!==longhandStylename.indexOf("top")?parseFloat(shorthandValueArr[0]):-1!==longhandStylename.indexOf("right")?parseFloat(shorthandValueArr[1]):-1!==longhandStylename.indexOf("bottom")?parseFloat(shorthandValueArr[2]):parseFloat(shorthandValueArr[3])}}return 0}}System.TcHmiGrid=TcHmiGrid}(System=Controls.System||(Controls.System={}))}(Controls=TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),TcHmi.Controls.registerEx("TcHmiGrid","TcHmi.Controls.System",TcHmi.Controls.System.TcHmiGrid);